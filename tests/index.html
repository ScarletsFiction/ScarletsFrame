<!DOCTYPE html>
<html>
   <head>
      <title>Test Page</title>
      <meta charset="UTF-8">
      <script src='https://cdn.jsdelivr.net/npm/simplebar@latest/dist/simplebar.min.js'></script>
      <script>
        var _bst = window.setTimeout;
        var _bst_ = 0;
        window.setTimeout = function(f,t){
          _bst_++;
          return _bst(f,t);
        }

        var _bsi = window.setInterval;
        var _bsi_ = 0;
        window.setInterval = function(f,t){
          _bsi_++;
          return _bsi(f,t);
        }

        _bst(function(){
          console.log("There are", _bst_, "setTimeout,", _bsi_, "setInterval that was called before");
        }, 5000);

        var tempbst = 0;
        _bst(function(){
          tempbst = _bst_+_bsi_;
          console.log("There are", _bst_, "setTimeout,", _bsi_, "setInterval that was called before");
        }, 20000);

        _bst(function(){
          if(tempbst !== _bst_+_bsi_){
            console.log("There are", _bst_, "setTimeout,", _bsi_, "setInterval that was called before");
            return console.log("Looks like internal framework timer was not effective");
          }
        }, 30000);
      </script>
      <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/simplebar@latest/dist/simplebar.min.css">
      <script src='/dist/scarletsframe.min.js'></script>
      <style type="text/css">
        .sf-dom-queued{
          color: transparent;
          background-color: gainsboro;
          user-select: none;
        }
        span.bold{
         font-weight: bold;
        }
        span.transit{
         transition: background-color 1s ease-in;
         background-color: white;
        }
        span.transit.pink{
         background-color: pink;
        }
        sf-page-view{
         display: none;
        }
        sf-page-view.page-current{
         display: block;
        }
        nested-view{
          background: rgba(0,0,200,0.2);
          display: block;
          height: 16px;
        }
        nested2-view{
          background: rgba(0,200,0,0.2);
          display: block;
          height: 16px;
        }
        custom-view > sf-page-view:first-child{
         display: block;
        }
      </style>
   </head>
   <body class="body">
      <img src="/tests/img.jpg" alt="" style="width: 50px;float: right;">

      <!-- Dynamic Page -->
      <div>
         <b>Dynamic Page Navigation</b><br>
         <i>Note: the url also changed, if you hit refresh you will be redirected to other page. This feature is supposed for Scarlets Framework on PHP.</i><br><br>
         <custom-view>
            View place<br>
            <a href="/test/page1">Go to page 1</a> || Nest->
            <a href="/test/page1/nest1">1-1</a> | 
            <a href="/test/page1/nest2">1-2</a> | 
            <a href="/test/page1/nest1/nest1">1-1-1</a> | 
            <a href="/test/page1/nest1/nest2">1-1-2</a> | 
            <a href="/test/page1/nest2/nest1">1-2-1</a> | 
            <a href="/test/page1/nest2/nest2">1-2-2</a> | <br>
            <a href="/test/page2">Go to page 2</a> || Nest->
            <a href="/test/page2/nest1">2-1</a> | 
            <a href="/test/page2/nest2">2-2</a> | 
            <a href="/test/page2/nest1/nest1">2-1-1</a> | 
            <a href="/test/page2/nest1/nest2">2-1-2</a> | 
            <a href="/test/page2/nest2/nest1">2-2-1</a> | 
            <a href="/test/page2/nest2/nest2">2-2-2</a> | 
         </custom-view>
         <br><br>
         <a href="@/">Refresh whole page</a>
      </div><br><br>

      <!-- Virtual Scroll And Array Binding -->
      <sf-m name="virtual-scroll" id="reinit2">
         <style type="text/css">
            .scroller{
               overflow-x: hidden;
               overflow-y: scroll;
               height: 200px;
            }
         </style>

         <b>Virtual Scroll - Static Height & Scroll on parent</b>
         <div data-simplebar style="height: 200px;">
            <ul class="sf-virtual-list" scroll-parent-index="2">
               <li sf-repeat-this="x in list1" data-id="{{x.id}}">
                  <label>{{ x.id }}</label>

                  {{@if #x === list1[0]:
                     x.first = true;
                     {[<span> - Am I the ({{ one }}) one?</span>]}

                  @elseif x.first && #x !== list1[0]:
                     delete x.first;
                     {[<span> - I'm no longer the {{ one }} one..</span>]}
                  }}
               </li>
            </ul>
         </div><br>

         <b>Virtual Scroll - Dynamic Height</b>
         <i>Automatically scroll to item-11</i>
         <ul class="scroller sf-virtual-list sf-list-dynamic">
            <li sf-repeat-this="x in list2" data-id="{{x.id}}">
               <label>{{x.id}}</label>
            </li>
         </ul>
      </sf-m><br><br>

      <!-- Model and Controller -->
      <sf-m name="model-binding" id="reinit">
         <span :class="transit {{ bold ? 'bold' : '' }} {{ pink ? 'pink' : '' }}">Change variable on keyboard input</span><br>

         <input type="text" sf-bind="inputBinding1" onkeyup="sf(this).onKeyUp(event)"><br>
         <input type="text" sf-bind="inputBinding1"><br>
         <span id="test">Var Content: {{ inputBinding1 }}</span><br><br>

         <span class="bold" style="
            font-weight: {{ bold ? 'bold' : 'unset' }};
            background-color: {{ pink ? 'pink' : '' }};
         ">Another one</span><br>

         <textarea type="text" sf-into="inputBinding2" placeholder="will round a number if called from script"></textarea><br>
         <input type="text" value="It's {{inputBinding2}}" disabled><br>
         <span>Var Content: {{ inputBinding2 }}</span><br><br>

         <input type="checkbox" value="check1" sf-bind="inputBinding3">Check 1
         <input type="checkbox" value="check2" sf-bind="inputBinding3">Check 2<br>
         <input type="radio" name="inputBinding4" value="radio1" sf-bind> Radio 1
         <input type="radio" name="inputBinding4" value="radio2" sf-bind> Radio 2<br>
         <select sf-bind="inputBinding5" multiple typedata="number">
            <option value="1">Select 1</option>
            <option value="2">Select 2</option>
            <option value="3">Select 3</option>
         </select>
         <select sf-bind="inputBinding6" typedata="number">
            <option value="{{x.value}}" sf-repeat-this="x in inputBinding6a">
            {{x.text}} - {{text}}
          </option>
         </select><br><br>
         <input type="file" sf-bind="inputBinding7"><br>

         <b>Conditional HTML</b><br>
         <div>
            {{@if showHTML === true:
               {[<span>This 1st must not be displayed {{ stuff }}</span>]}
            }}
            <span sf-bind-ignore>Ignored bind: {{ stuff }}</span><br>
            {{@if showHTML === false:
               {[<span>This 2th must be displayed {{ stuff }} {{ stuffes }}</span>]}
            }}<br><br>
         </div>

         <b>Execution for the current model scope</b><br>
         <div>
            <div>
            {{@exec
               for(var i = 1; i <= 5; i++){
                  {[<span>{{ prefix }}{{ i }}</span><br>]}
               }

               var calculate = (5+4);
               {[<span>5 + 4 = {{ calculate }}</span><br>]}

               var escapeHTML = "<span>This must be HTML escaped (except the bold)</span>";
               var noEscapeHTML = "<br><span>This shouldn't be HTML escaped (no &lt;span&gt;)</span>";

               {[ <b>{{escapeHTML}}</b> ]}
               @return noEscapeHTML;
            }}
            {{@exec {[ <br><br>expected error{{vuln}} ]} }}
            </div>
            <script>console.log("There are must have 2 total error")</script>
         </div>
      </sf-m>

      <!-- Components -->
      <sf-m name="components" id='components'>
         <a sf-click="clickOK()">test click</a><br>
         <comp-test id="henlos">
            <input type="text" sf-bind="data"/>
            custom {{data}} {{item}} here
            <span sf-repeat-this="num in tries">{{#num}},</span>
         </comp-test>
         <comp-test it="async"></comp-test>
         <comp-test sf-repeat-this="item in items"></comp-test>
      </sf-m>

      <!-- Language -->
      <div id="lang-test">
        <script>
          sf(function(){
            sf.lang.default = 'en';
            sf.lang.add('en', {
              hello:{
                other:{
                  side:"Hello from the other side"
                }
              },
              "i'm":{
                here:"I'm on here!"
              }
            });
            sf.lang.serverURL = '/test/lang';
            sf.lang(document.querySelector('#lang-test'));

            var obj = {};
            sf.lang.assign(obj, {
              chicken:'stuff.chicken',
              game:'stuff.game'
            }, function(){
              console.warn('lang stuff', obj);
            });

            sf.lang.get(['stuff.game', 'another.day'], function(values){
              console.warn('lang multiple', values);
            });

            sf.lang.get('another.friend', function(values){
              console.warn('lang single', values);
            });
          })
        </script>

         <p sf-lang="hello.other.side"></p>
         <input type="text" sf-lang="i'm.here"/>

         <p sf-lang="my.test"></p>
         <p sf-lang="second"></p>
      </div>

      <script type="text/javascript" src="/tests/script.js"></script>
   </body>
</html>