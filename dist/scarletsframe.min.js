/*
  ScarletsFrame
  A frontend library for Scarlets Framework that support
  lazy page load and element binding that can help
  simplify your code

  https://github.com/ScarletsFiction/ScarletsFrame
*/
!function(global,factory){if(void 0===window.customElements)return console.error("This browser was not supported"),window.onOldBrowser?window.onOldBrowser():(console.error("Please make an callback in 'window.onOldBrowser' to create a custom fallback"),alert("This browser was not supported"));function routerEval(code){eval(code)}"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(global,routerEval):global.sf=factory(global,routerEval)}("undefined"!=typeof window?window:this,function(window,routerEval){"use strict";void 0===typeof document&&(document=window.document);var internal={},sf=function(e){return e.constructor===Function?sf.loader.onFinish.apply(null,arguments):void 0!==e.tagName?sf.model.root[sf.controller.modelName(e)]:void 0};sf.internal={},sf.regex={getQuotes:/(['"])(?:\1|[\s\S]*?[^\\]\1)/g,validFunctionCall:/[_a-zA-Z0-9 \]\$\)]/,strictVar:"(?=\\b[^.]|^|\\n| +|\\t|\\W )",escapeHTML:/(?!&#.*?;)[\u00A0-\u9999<>\&]/gm,uniqueDataParser:/{{((@|#[\w])[\s\S]*?)}}/g,dataParser:/{{([^@%][\s\S]*?)}}/g,arrayItemsObserve:/\b_model_\.([_a-zA-Z0-9.['\]]+)(?:$|[^'\]])/g};var allowedFunctionEval={for:!0,if:!0,while:!0,"_content_.take":!0,"console.log":!0};function avoidQuotes(e,t,n){var r=[],i="<%$@>";if(void 0===n){e=t(e=e.replace(sf.regex.getQuotes,function(e){return r.push(e),i+(r.length-1)+i}));for(var o=0;o<r.length;o++)e=e.replace(i+o+i,r[o]);return e}t(e.replace(sf.regex.getQuotes,"<%$@>"))}function isEmptyObject(e){for(var t in e)return!1;return!0}function compareObject(e,t){if(!e||!t)return!1;for(var n in e)if("object"!=typeof e[n]&&e[n]!==t[n])return!1;return!0}function hiddenProperty(e,t,n){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,value:n})}function deepProperty(e,t){for(var n=0;n<t.length;n++)if(void 0===(e=e[t[n]]))return e;return e}function capitalizeLetters(e){for(var t=0;t<e.length;t++)e[t]=e[t][0].toUpperCase()+e[t].slice(1);return e.join("")}function DOMList(e){if(null===e)return this.length=0,this;if(void 0===e.length)return this[0]=e,this.length=1,this;for(var t=0;t<e.length;t+=1)this[t]=e[t];return this.length=e.length,this}sf.dom=function(e,t){if(!e){if(void 0===e){var n=function(e){return n.find(e)};return Object.defineProperty(n,"length",{writable:!0,enumerable:!1,value:0}),Object.assign(n,DOMList.prototype)}return new DOMList([])}return e.constructor===Function?sf(e):"<"===e[0]||">"===e[e.length-1]?new DOMList(sf.dom.parseElement(e)):t?new DOMList(t.querySelectorAll(e)):e.constructor===String?new DOMList(document.querySelectorAll(e)):new DOMList(e)};var $=sf.dom;!function(){var e=sf.dom,t=/\-[a-z0-9]/,n=function(e,t){return t.toUpperCase()};e.fn=DOMList.prototype={push:function(e){this[this.length++]=e},indexOf:function(e){for(var t=Object.keys(this),n=0;n<t.length;n++)if(this[t[n]]===e)return n;return-1},splice:function(e){for(var t=this.length-1;e<t;e++)delete this[e],this[e]=this[e+1];this.length--},add:function(e){return this[this.length++]=e,this},find:function(e){if(1===this.length)return new DOMList(this[0].querySelectorAll(e));for(var t=[],n=0;n<this.length;n++)t.push.apply(t,this[n].querySelectorAll(e));return new DOMList(t)},parent:function(t){if(1===this.length)return new DOMList(t?e.parent(this[0],t):this[0].parentElement);for(var n=[],r=0;r<this.length;r++)n.push.apply(n,e.parent(this[r],t));return new DOMList(n)},prevAll:function(t){for(var n=[],r=0;r<this.length;r++)n.push.apply(n,e.prevAll(this[r],t));return new DOMList(n)},nextAll:function(t){for(var n=[],r=0;r<this.length;r++)n.push.apply(n,e.nextAll(this[r],t,!0));return new DOMList(n)},children:function(e){for(var t=[],n=0;n<this.length;n++)t.push.apply(t,this[n].children);return new DOMList(t)},remove:function(){for(var e=0;e<this.length;e++)this[e].remove();return this},empty:function(){for(var e=0;e<this.length;e++)this[e].textContent="";return this},addClass:function(e){for(var t=0;t<this.length;t++)DOMTokenList.prototype.add.apply(this[t].classList,e.split(" "));return this},removeClass:function(e){for(var t=0;t<this.length;t++)DOMTokenList.prototype.remove.apply(this[t].classList,e.split(" "));return this},toggleClass:function(e){for(var t=0;t<this.length;t++)DOMTokenList.prototype.toggle.apply(this[t].classList,e.split(" "));return this},hasClass:function(e){for(var t=0;t<this.length;t++)if(this[t].classList.contains(e))return!0;return!1},prop:function(e,t){if(void 0===t)return this[0][e];for(var n=0;n<this.length;n++)this[n][e]=t;return this},attr:function(e,t){if(void 0===t)return this[0].getAttribute(e);for(var n=0;n<this.length;n++)this[n].setAttribute(e,t);return this},removeAttr:function(e){for(var t=0;t<this.length;t++)this[t].removeAttribute(e);return this},css:function(e,r){if(void 0===r&&e.constructor===String)return this[0].style[e];if(e.constructor===Object){for(var i=Object.keys(e),o=0;o<i.length;o++)!0===/\-/.test(i[o])&&(e[i[o].replace(t,n)]=e[i[o]],delete e[i[o]]);for(o=0;o<this.length;o++)Object.assign(this[o].style,e);return this}e=e.replace(t,n);for(o=0;o<this.length;o++)this[o].style[e]=r;return this},on:function(t,n,r){for(var i=0;i<this.length;i++)e.on(this[i],t,n,r);return this},off:function(t,n,r){for(var i=0;i<this.length;i++)e.off(this[i],t,n,r);return this},once:function(t,n,r){for(var i=0;i<this.length;i++)e.on(this[i],t,n,r,!0);return this},trigger:function(e,t,n){e=e.split(" ");for(var r=0;r<e.length;r++)for(var i=e[r],o=0;o<this.length;o++)if(!0!==n){var l;try{l=new window.CustomEvent(i,{detail:t,bubbles:!0,cancelable:!0})}catch(e){(l=document.createEvent("Event")).initEvent(i,!0,!0),l.detail=t}this[o].dispatchEvent(l)}else this[o][i]();return this},animateKey:function(t,n,r){for(var i=0;i<this.length;i++)e.animateKey(this[i],t,n,r);return this},each:function(e){for(var t=0;t<this.length;t++)e(this[t],t,this);return this},data:function(e,t){if(void 0===t)return this[0].$data?this[0].$data[e]:void 0;for(var n=0;n<this.length;n++)void 0===this[n].$data&&(this[n].$data={}),this[n].$data[e]=t;return this},removeData:function(e){for(var t=0;t<this.length;t++)void 0!==this[t].$data&&delete this[t].$data[e];return this},append:function(e){if(e.constructor===Array||e.constructor===Object)for(var t=0;t<e.length;t++)this[0].append(e[t]);else e.constructor===String?this[0].insertAdjacentHTML("beforeEnd",e):this[0].append(e);return this},prepend:function(e){if(e.constructor===Array||e.constructor===Object)for(var t=0;t<e.length;t++)this[0].prepend(e[t]);else e.constructor===String?this[0].insertAdjacentHTML("afterBegin",e):this[0].prepend(e);return this},eq:function(e){return new DOMList(this[e])},insertAfter:function(e){var t=e.parentElement;t.insertBefore(this[0],e.nextSibling);for(var n=1;n<this.length;n++)t.insertBefore(this[n],this[n-1]);return this},insertBefore:function(e){for(var t=e.parentElement,n=0;n<this.length;n++)t.insertBefore(this[n],e);return this},text:function(e){if(void 0===e)return this[0].innerText;for(var t=0;t<this.length;t++)this[t].innerText=e;return this},html:function(e){if(void 0===e)return this[0].innerHTML;for(var t=0;t<this.length;t++)this[t].innerHTML=e;return this},val:function(e){if(void 0===e)return this[0].value;for(var t=0;t<this.length;t++)this[t].text=e;return this}},Object.assign(e.fn,{click:function(e){return this.trigger("click",e,!0)},blur:function(e){return this.trigger("blur",e,!0)},focus:function(e){return this.trigger("focus",e,!0)},focusin:function(e){return this.trigger("focusin",e)},focusout:function(e){return this.trigger("focusout",e)},keyup:function(e){return this.trigger("keyup",e)},keydown:function(e){return this.trigger("keydown",e)},keypress:function(e){return this.trigger("keypress",e)},submit:function(e){return this.trigger("submit",e)},change:function(e){return this.trigger("change",e)},mousedown:function(e){return this.trigger("mousedown",e)},mousemove:function(e){return this.trigger("mousemove",e)},mouseup:function(e){return this.trigger("mouseup",e)},mouseenter:function(e){return this.trigger("mouseenter",e)},mouseleave:function(e){return this.trigger("mouseleave",e)},mouseout:function(e){return this.trigger("mouseout",e)},mouseover:function(e){return this.trigger("mouseover",e)},touchstart:function(e){return this.trigger("touchstart",e)},touchend:function(e){return this.trigger("touchend",e)},touchmove:function(e){return this.trigger("touchmove",e)},resize:function(e){return this.trigger("resize",e,!0)},scroll:function(e){return this.trigger("scroll",e,!0)}}),e.findOne=function(e,t){return void 0!==t?t.querySelector(e):document.querySelector(e)},e.isChildOf=function(e,t){for(var n=e.parentNode;null!==n;){if(n===t)return!0;n=n.parentNode}return!1},e.parentHasProperty=function(e,t){do{if(void 0!==e[t])return e;e=e.parentElement}while(null!==e);return null},e.parent=function(e,t){if(e.closest)return e.closest(t);do{if(!0===e.matches(t))return e;e=e.parentElement}while(null!==e);return null},e.prevAll=function(e,t,n){var r=[],i=!t||t.constructor!==String;for(e=n?e.nextSibling:e.previousSibling;null!==e;){if(!1===i)!0===e.matches(t)&&r.push(e);else{if(e===t)break;r.push(e)}e=n?e.nextSibling:e.previousSibling}return r},e.nextAll=function(t,n){return e.prevAll(t,n,!0)},e.on=function(t,n,r,i,o){if("string"==typeof t&&(t=document,i=r,r=n,n=t),"function"==typeof r&&(i=r,r=null),r){var l=i;(i=function(t){var n=e.parent(t.target,r);null!==n&&l.apply(n,[t])}).callback=l}i.selector=r,i.once=o,t.addEventListener(n,i,{capture:!0,once:!0===o}),o||(void 0===t.sf$eventListener&&(t.sf$eventListener={}),void 0===t.sf$eventListener[n]&&(t.sf$eventListener[n]=[]),t.sf$eventListener[n].push(i))},e.once=function(t,n,r,i){e.on(t,n,r,i,!0)},e.off=function(t,n,r,i){if(void 0!==n){if(1===(a=n.split(" ")).length)if(void 0!==r&&r.constructor===Function&&(i=r,r=void 0),void 0!==t.sf$eventListener)if(i){if(t.removeEventListener(n,i,{capture:!0}),void 0===(o=t.sf$eventListener[n]))return;-1!==(l=o.indexOf(i))&&o.splice(l,1)}else{var o;if(void 0!==(o=t.sf$eventListener)&&void 0!==o[n])for(l=o[n].length-1;l>=0;l--)r&&o[n][l].selector!==r||t.removeEventListener(n,o[n].splice(l,1),{capture:!0})}else void 0!==i&&t.removeEventListener(n,i,{capture:!0});else for(var l=0;l<a.length;l++)e.off(t,a[l])}else{if(void 0===t.sf$eventListener)return;for(var a=t.sf$eventListener[n],l=0;l<a.length;l++)e.off(t,a[l])}},e.animateKey=function(t,n,r,i){if(void 0!==t){r&&r.constructor===Function&&(i=r,r=void 0);var o=null;void 0!==t.style.animation&&(o="animationend"),void 0!==t.style.WebkitAnimation&&(o="webkitAnimationEnd");var l=t.style,a=n;if(void 0!==r&&r.constructor!==Number||(r={duration:r&&r.constructor===Number?r:.6,ease:"ease",fill:"both"}),void 0!==r.duration&&(a+=" "+r.duration+"s"),void 0!==r.ease&&(a+=" "+r.ease),void 0!==r.delay){if(a+=" "+r.delay+"s","animationend"===o)var s="animationstart";else s="webkitAnimationStart";!1===r.visible&&(t.classList.add("anim-pending"),l.visibility="hidden"),e.once(t,s,function(){t.isConnected&&(r.whenBegin&&r.whenBegin(),t.classList.remove("anim-pending"),l.visibility="visible")})}else l.visibility="visible";void 0!==r.iteration&&(a+=" "+r.iteration),void 0!==r.direction&&(a+=" "+r.direction),void 0!==r.fill&&(a+=" "+r.fill),l.webkitAnimation=l.animation=a,setTimeout(function(){if(t.isConnected){if(t.classList.add("anim-element"),null!==t.parentElement){var n=t.offsetLeft+t.offsetWidth/2+"px"+(t.offsetTop+t.offsetHeight/2)+"px",r=t.parentElement.style;t.parentElement.classList.add("anim-parent"),r.webkitPerspectiveOrigin=r.perspectiveOrigin=n}e.once(t,o,function(){setTimeout(function(){if(null!==t.parentElement){l.visibility="",t.classList.remove("anim-element"),l.webkitAnimation=l.animation="";var e=t.parentElement.style;e.webkitPerspectiveOrigin=e.perspectiveOrigin=""}}),void 0!==i&&i()})}else void 0!==i&&i()})}};var r={div:document.createElement("div"),ul:document.createElement("ul"),tbody:document.createElement("tbody"),tr:document.createElement("tr"),table:document.createElement("table"),select:document.createElement("select")};e.parseElement=function(e,t){var n=[],i=r.div;0===e.indexOf("<li")&&(i=r.ul),0===e.indexOf("<tr")&&(i=r.tbody),0!==e.indexOf("<td")&&0!==e.indexOf("<th")||(i=r.tr),0===e.indexOf("<tbody")&&(i=r.table),0===e.indexOf("<option")&&(i=r.select),i.textContent="",i.insertAdjacentHTML("afterBegin",e);for(var o=i[t?"childNodes":"children"],l=0;l<o.length;l++)n.push(o.item(l));return n},e.escapeText=function(e){var t=r.div;return t.textContent=e,t.innerHTML},e.remove=function(e){if(void 0!==e.remove)return e.remove();for(var t=0;t<e.length;t++)e[t].remove()};var i=null;setTimeout(function(){sf.loader.domReady(function(){i=document.body.parentElement})});var o=/[~`!@#$%^&*()+={}|[\]\\:";'<>?,.\/ ]/;e.getSelector=function(e,t,n){var r=[];void 0===n&&(n=i);for(var l=t?"previousSibling":"previousElementSibling";null!==e.parentNode;){if(e.id&&!o.test(e.id)){r.unshift("#"+e.id);break}if(e===n)void 0===t?r.unshift(e.tagName):r.unshift(0);else{for(var a=e,s=t?0:1;a[l];)a=a[l],s++;t?r.unshift(s):r.unshift(":nth-child("+s+")")}if(null===(e=e.parentNode))break}return t?r:r.join(" > ")},e.childIndexes=function(e,t){var n=t||i,r=1;if(e[0].constructor===String&&n.id!==e[0].substr(1))n=n.querySelector(e[0]);else if(1===e.length)return n;for(r=r;r<e.length;r++)if(null===(n=n.childNodes.item(e[r])))return null;return n}}(),sf.loader=new function(){var e=this;e.loadedContent=0,e.totalContent=0,e.DOMWasLoaded=!1,e.DOMReady=!1,e.turnedOff=!0;var t=[],n=[],r=[];e.onFinish=function(t){if(e.DOMWasLoaded)return t();-1===n.indexOf(t)&&n.push(t)},e.domReady=function(n){if(e.DOMReady)return n();-1===t.indexOf(n)&&t.push(n)},e.onProgress=function(t){if(e.DOMWasLoaded)return t(e.loadedContent,e.totalContent);-1===r.indexOf(t)&&r.push(t)},e.f=function(t){e.loadedContent++;for(var n=0;n<r.length;n++)r[n](e.loadedContent,e.totalContent)},e.css=function(t){if(e.DOMWasLoaded){for(var n=t.length-1;n>=0;n--)0!==$('link[href*="'+t[n]+'"]').length&&t.splice(n,1);if(0===t.length)return}e.turnedOff=!1,e.totalContent=e.totalContent+t.length;for(n=0;n<t.length;n++){var r=document.createElement("link");r.rel="stylesheet",r.href=t[n],r.addEventListener("load",sf.loader.f,{once:!0}),r.addEventListener("error",sf.loader.f,{once:!0}),document.head.appendChild(r)}},e.js=function(t){if(e.DOMWasLoaded){for(var n=t.length-1;n>=0;n--)0!==$('script[src*="'+t[n]+'"]').length&&t.splice(n,1);if(0===t.length)return}e.turnedOff=!1,e.totalContent=e.totalContent+t.length;for(n=0;n<t.length;n++){var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src=t[n],r.addEventListener("load",sf.loader.f,{once:!0}),r.addEventListener("error",sf.loader.f,{once:!0}),document.head.appendChild(r)}};document.addEventListener("load",function e(t){document.body&&document.removeEventListener("load",e,!0)},!0),document.addEventListener("readystatechange",function n(){if("interactive"===document.readyState||"complete"===document.readyState){if(!1===e.DOMReady){e.DOMReady=!0;for(var r=0;r<t.length;r++)try{t[r]()}catch(e){console.error(e)}}i=setInterval(o,100),document.removeEventListener("readystatechange",n,!0)}},!0);var i=-1;function o(){if(!(!1===e.turnedOff&&e.loadedContent<e.totalContent)){clearInterval(i);for(var o=sf.dom("script, link, img"),l=0;l<o.length;l++)o[l].removeEventListener("error",sf.loader.f),o[l].removeEventListener("load",sf.loader.f);e.DOMWasLoaded=!0,e.turnedOff=!0;var a=Object.keys(internal.modelPending);for(l=0;l<a.length;l++){var s=internal.modelPending[a[l]];if(void 0===sf.model.root[a[l]])var u=sf.model.root[a[l]]={};else u=sf.model.root[a[l]];for(var c=0;c<s.length;c++)s[c](u,root_);delete internal.modelPending[a[l]]}for(l=internal.controller.pending.length-1;l>=0;l--){void 0!==(u=sf.controller.pending[internal.controller.pending[l]])&&(u(root_(internal.controller.pending[l]),root_),internal.controller.pending.splice(l,1))}for(l=0;l<n.length;l++)try{n[l]()}catch(e){console.error(e)}r.splice(0),t.splice(0),n.splice(0),t=n=null}}},sf.prototype.constructor=sf.loader.onFinish,sf.component=new function(){var self=this,scope=internal.component={list:{}},waitingHTML={};self.registered={},self.available={},self.for=function(e,t,n){void 0===self.registered[e]&&(self.registered[e]=[t,sf.controller.pending[e],0,!1,n]),internal.component[e.toUpperCase()]=!0,self.registered[e][0]=t,delete sf.controller.pending[e],defineComponent(e)},self.html=function(e,t){void 0===self.registered[e]&&(self.registered[e]=[!1,!1,0,!1]);var n=$.parseElement(t);if(1===n.length)self.registered[e][3]=n[0];else{var r=document.createElement("div");r.tempDOM=!0;for(var i=0;i<n.length;i++)r.appendChild(n[i]);self.registered[e][3]=r}if(void 0!==waitingHTML[e]){var o=waitingHTML[e];delete waitingHTML[e];for(i=o.length-1;i>=0;i--){var l=o[i].el;self.new(e,l,o[i].item),delete l.sf$initTriggered,l.model.init&&l.model.init()}}};var tempDOM=document.createElement("div");function componentInit(e,t,n){e.sf$controlled=t,e.sf$componentFrom=n}self.new=function(e,t,n){if(!internal.component.skip)if(t.hasAttribute("sf-repeat-this"))t.sf$componentIgnore=!0;else{if(0===t.childElementCount&&!1===self.registered[e][3])return void 0===waitingHTML[e]&&(waitingHTML[e]=[]),void waitingHTML[e].push({el:t,item:n});if(!0!==t.sf$componentIgnore){var r=/(^|:)(sf-|class|style)/,i=t.attributes;0!==i.length&&void 0===n&&(n={});for(var o=0;o<i.length;o++)r.test(i[o].nodeName)||(n[i[o].nodeName]=i[o].value);if(void 0===t){if(!1===self.registered[e][3])return void console.error("HTML content for '"+e+"' was not defined");t=self.registered[e][3].cloneNode(!0)}var l=e+"@"+self.registered[e][2]++;void 0===self.available[e]&&(self.available[e]=[]),self.available[e].push(l);var a=sf.model.root[l]={$el:$()};if(a.$el.push(t),self.registered[e][0](a,sf.model,n),self.registered[e][1]&&self.registered[e][1](a,sf.model,n),0===t.childElementCount){var s=self.registered[e][3],u=s.tempDOM;s.constructor!==Object&&(s=sf.model.extractPreprocess(s,null,a),self.registered[e][3]=s,s.tempDOM=u);var c=Object.assign({},s);if(0!==c.parse.length){var d=null;c.parse=c.parse.slice(0);for(o=0;o<c.parse.length;o++){c.parse[o]=Object.assign({},c.parse[o]);var f=c.parse[o].data=c.parse[o].data.slice(0);null===d&&4===f.length&&((d=Object.assign({},f[3]))._modelScope=a),f[2]=a,f[3]=d}}var h=internal.model.templateParser(c,a);if(t.sf$elementReferences=h.sf$elementReferences,sf.model.bindElement(t,l,c),!0===u){o=0;for(var p=(h=h.childNodes).length;o<p;o++)t.appendChild(h[0])}else t.appendChild(h)}else{var v={repeat:[],input:[]};sf.model.parsePreprocess(sf.model.queuePreprocess(t,!0,v),l),internal.model.bindInput(v.input,a),internal.model.repeatedListBinding(v.repeat,a)}return t.model=a,componentInit(t,l,e),t.sf$initTriggered=!0,t.destroy=function(){null===this.parentElement?internal.model.removeModelBinding(a):this.remove()},t}}};var HTMLElement=window.HTMLElement,customElements=window.customElements,HTMLElement_wrap=function(e){function t(){return Reflect.construct(e,arguments,Object.getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(t,e)}(HTMLElement);function defineComponent(name){if(!customElements.get(name)){name=name.replace(/[^\w-]+/g,"");var tagName=name;if(name=name.split("-"),1===name.length)return console.error("Please use '-' when defining component tags");name=capitalizeLetters(name);var func=eval("function "+name+"($item){var he = HTMLElement_wrap.call(this);self.new(tagName, he, $item);return he}"+name);func.prototype=Object.create(HTMLElement.prototype),func.prototype.constructor=func,func.__proto__=HTMLElement,func.prototype.connectedCallback=function(){if(this.model)return void 0!==this.sf$destroying?(clearTimeout(this.sf$destroying),void(this.sf$destroying=void 0)):this.sf$initTriggered?(delete this.sf$initTriggered,void(this.model.init&&this.model.init())):void(this.model.reinit&&this.model.reinit())},func.prototype.disconnectedCallback=function(){if(!this.sf$componentIgnore){var e=sf.component.available[tagName];e.splice(e.indexOf(this.sf$controller),1);var t=this;this.sf$destroying=setTimeout(function(){if(!t.model)return console.log(t);delete sf.model.root[t.sf$controlled],t.model.destroy&&t.model.destroy()},500)}};try{customElements.define(tagName,func)}catch(e){console.error(e)}window["$"+name]=func}}},sf.model=function(e){if(void 0!==sf.component.registered[e])return root_(e);sf.model.root[e]||(sf.model.root[e]={},internal.controller.pending.push(e));var t=internal.modelPending[e];if(t){for(var n=sf.model.root[e],r=0;r<t.length;r++)t[r](n,sf.model);t=internal.modelPending[e]=!1}for(r=internal.controller.pending.length-1;r>=0;r--){void 0!==(n=sf.controller.pending[internal.controller.pending[r]])&&(n(root_(internal.controller.pending[r]),root_),internal.controller.pending.splice(r,1))}return sf.controller.pending[e]&&sf.controller.run(e),sf.model.root[e]},function(){var e=sf.model;e.root={},internal.modelPending={},e.index=function(t){!1===t.hasAttribute("sf-bind-list")&&(t=sf.dom.parent(t,"[sf-bind-list]"));for(var n=-1,r=t.tagName,i=t;null!==t;)t.tagName===r&&n++,t=t.previousElementSibling;var o=i.getAttribute("sf-bind-list");if(!o)return n;var l=e.root[sf.controller.modelName(i)][o];return l.$virtual?n+l.$virtual.DOMCursor-1:n},e.for=function(t,n){if(!sf.loader.DOMWasLoaded)return void 0===internal.modelPending[t]&&(internal.modelPending[t]=[]),!1===internal.modelPending[t]?n(e(t),e):internal.modelPending[t].push(n);n(e(t),e)},e.modelKeys=function(e){for(var t=Object.keys(e),n=t.length-1;n>=0;n--)-1!==t[n].indexOf("$")&&t.splice(n,1);return t}}();class SFModel extends HTMLElement{constructor(){super(),this.sf$firstInit=!0}connectedCallback(){if(void 0!==this.sf$destroying&&clearTimeout(this.sf$destroying),void 0!==this.sf$firstInit){var e=this;delete this.sf$firstInit,setTimeout(function(){if(sf.loader.DOMWasLoaded)return sf.model.init(e,e.getAttribute("name"));sf.loader.onFinish(function(){sf.model.init(e,e.getAttribute("name"))})})}}disconnectedCallback(){var e=this;this.sf$destroying=setTimeout(function(){if(e.model.$el){var t=e.model.$el.indexOf(e);-1!==t&&e.model.$el.splice(t)}internal.model.removeModelBinding(e.model)},1e3)}}customElements.define("sf-m",SFModel),function(){var self=sf.model;function escapeEscapedQuote(e){return e.split('\\"').join("\\$%*").split("\\'").join("\\%$*")}function unescapeEscapedQuote(e){return e.split("\\$%*").join('\\"').split("\\%$*").join("\\'")}self.init=function(e,t){if(void 0===e.sf$controlled){e.sf$controlled=t;var n=e.model=sf.model.root[t]||sf.model(t);void 0===n.$el&&(n.$el=$()),n.$el.push(e),void 0!==sf.controller.pending[t]&&sf.controller.run(t);var r={repeat:[],input:[]};sf.model.parsePreprocess(sf.model.queuePreprocess(e,void 0,r),t),bindInput(r.input,n),repeatedListBinding(r.repeat,n),void 0!==n.init&&n.init(e)}};var processingElement=null,bindingEnabled=!1,scope=internal.model={};function trimIndentation(e){var t=e.split("\n",3);return void 0===(t=" "!==t[0][0]||"\t"!==t[0][0]?t[1]:t[0])?e:0===(t=t.length-t.trim().length)?e:e.replace(RegExp("^([\\t ]{"+t+"})","gm"),"")}var bracketMatch=/([\w\n.]*?[\S\s])\(/g,chackValidFunctionCall=sf.regex.validFunctionCall,localEval=function(script,_model_,_modelScope,_content_){var _result_="";try{if(!0===/@return /.test(script)){var _evaled_=eval("(function(){"+script.split("@return ").join("return ")+"})()");return void 0===_evaled_?_result_+"undefined":null===_evaled_?_result_+"null":void 0!==_evaled_.onclick?_evaled_:_result_+_evaled_}var _evaled_=eval(script)}catch(e){return console.groupCollapsed("%c<-- Expand the template error","color: yellow"),console.log(trimIndentation(processingElement.outerHTML).trim()),console.log("%c"+trimIndentation(script).trim(),"color: yellow"),console.groupEnd(),console.error(e),"#TemplateError"}return""!==_result_?_result_:_evaled_};function modelToViewBinding(e,t,n,r,i){var o;if(void 0===e.sf$bindedKey&&initBindingInformation(e),void 0!==e.sf$bindedKey[t])return-1===(o=e.sf$bindedKey[t]).indexOf(n)&&o.push(n),void(void 0!==r&&(void 0===o.input?(o.input=[r],o.input.type=i):o.input.push(r)));(e.sf$bindedKey[t]=[n],void 0!==r)&&((o=e.sf$bindedKey[t]).input=[r],o.input.type=i);if(void 0===Object.getOwnPropertyDescriptor(e,t).set){var l=e[t];Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(e){return l},set:function(n){if(l!==n){var r=void 0;if(!1===inputBoundRunning){var i=e["on$"+t],o=e["out$"+t];try{void 0!==i&&(r=i(l,n)),void 0!==o&&(r=o(l,n))}catch(e){console.error(e)}}var a=e["m2v$"+t];void 0!==a?void 0!==(r=a(l,n))?(l=r,a=n):(a=void 0,l=n):l=void 0!==r?r:n;for(var s=e.sf$bindedKey[t],u=0;u<s.length;u++)inputBoundRun!==s[u]?syntheticTemplate(s[u].element,s[u].template,void 0,e):s[u](l,s.input);void 0!==a&&(l=a)}return inputBoundRunning=!1,l}})}}function eventHandler(that,data,_modelScope){var modelKeys=sf.model.modelKeys(_modelScope).join("|"),direct=!1,script=data.value;script=avoidQuotes(script,function(e){return!1===/[ =(+-]/.test(e)&&(direct=!0),e.replace(RegExp(sf.regex.strictVar+"("+modelKeys+")\\b","g"),function(e,t){return"_modelScope."+t}).replace(/,this|\[this/g,function(e){return"sf_that"})}),direct&&(script=eval(script));var containSingleChar=!1,keys=data.name.slice(1).split("."),eventName=keys.shift();"unfocus"===eventName&&(eventName="blur");for(var i=keys.length-1;i>=0;i--)if(1===keys[i].length){containSingleChar=!0;break}keys=new Set(keys);var options={};if(keys.has("once")&&(options.once=!0,keys.delete("once")),keys.has("passive")&&(keys.has("prevent")&&console.error("Can't preventDefault when using passive listener",that),options.passive=!0,keys.delete("passive")),keys.has("capture")&&(options.capture=!0,keys.delete("capture")),0===eventName.indexOf("mouse")&&(eventName="pointer"+eventName.slice(5),keys.has("right")&&that.addEventListener("contextmenu",function(e){e.preventDefault()},options)),specialEvent[eventName])specialEvent[eventName](that,keys,script,_modelScope);else{if(direct&&0===keys.size)var callback=script;else var callback=function(ev){if((keys.has("bot")||!1!==ev.isTrusted)&&(keys.has("stop")&&ev.stopPropagation(),void 0===ev.ctrlKey||ev.ctrlKey===keys.has("ctrl")&&ev.altKey===keys.has("alt")&&ev.shiftKey===keys.has("shift")&&ev.metaKey===keys.has("meta"))){if(ev.constructor===KeyboardEvent){if(containSingleChar&&!keys.has(ev.key))return;ev.preventDefault()}else if(ev.constructor===PointerEvent){if(!(1&ev.buttons)&&keys.has("left")||!(2&ev.buttons)&&keys.has("right")||!(4&ev.buttons)&&keys.has("middle")||!(8&ev.buttons)&&keys.has("4th")||!(16&ev.buttons)&&keys.has("5th"))return;ev.preventDefault()}else if(ev.constructor===TouchEvent){if(containSingleChar&&!keys.has(ev.touches.length))return;ev.preventDefault()}else keys.has("prevent")&&ev.preventDefault();if(direct)return script.call(this,ev);eval(script)}};that.addEventListener(eventName,callback,options),that.sf$eventDestroy=function(){that.removeEventListener(eventName,callback,options)}}}internal.model.removeModelBinding=function(e){if(void 0!==e){var t=e.sf$bindedKey,n=null;for(var r in t)if(null!==t[r]){for(var i=t[r].length-1;i>=0;i--)t[r][i].element.isConnected||t[r].splice(i,1);if(void 0!==t[r].input)for(i=t[r].input.length-1;i>=0;i--)t[r].input[i].isConnected||t[r].input.splice(i,1);if(e[r].constructor===String||e[r].constructor===Number||e[r].constructor===Boolean);else{if(e[r].constructor!==Array)continue;e[r].$virtual&&(e[r].$virtual.destroy(),e[r].$virtual=void 0),n=e[r].splice("obtain"),delete e[r],e[r]=n}if(0===t[r].length){if(delete t[r],void 0===Object.getOwnPropertyDescriptor(e,r))continue;n=e[r];delete e[r],e[r]=n}}}},self.bindElement=function(e,t,n){var r=self.root[t];void 0===n&&(n=self.extractPreprocess(e,null,r),templateParser(n,r,!0),delete n.addresses,e.parentNode.replaceChild(n.html,e),e=n.html);for(var i=n.modelRef_array,o=0;o<i.length;o++){var l=i[o][0];void 0===r[l]&&(r[l]=""),modelToViewBinding(r,l,{element:e,template:n})}};var specialEvent={taphold:function(that,keys,script,_modelScope){var set=new Set,evStart=null;function callback(){if(that.removeEventListener("pointerup",callbackEnd,{once:!0}),that.removeEventListener("pointercancel",callbackEnd,{once:!0}),document.removeEventListener("pointermove",callbackMove),set.delete(evStart.pointerId),script.constructor===Function)return script.call(that,evStart);eval(script)}function callbackMove(e){(Math.abs(evStart.clientX-e.clientX)>1||Math.abs(evStart.clientY-e.clientY)>1)&&(clearTimeout(timer),set.delete(e.pointerId),that.removeEventListener("pointerup",callbackEnd,{once:!0}),that.removeEventListener("pointercancel",callbackEnd,{once:!0}),document.removeEventListener("pointermove",callbackMove),evStart=null)}var timer=0;function callbackStart(e){if(clearTimeout(timer),set.add(e.pointerId),set.size>1)return that.removeEventListener("pointerup",callbackEnd,{once:!0}),that.removeEventListener("pointercancel",callbackEnd,{once:!0}),void document.removeEventListener("pointermove",callbackMove);evStart=e,timer=setTimeout(callback,700),that.addEventListener("pointerup",callbackEnd,{once:!0}),that.addEventListener("pointercancel",callbackEnd,{once:!0}),document.addEventListener("pointermove",callbackMove)}function callbackEnd(e){document.removeEventListener("pointermove",callbackMove),evStart=null,set.delete(e.pointerId),clearTimeout(timer)}that.addEventListener("pointerdown",callbackStart)},gesture:function(that,keys,script,_modelScope){touchGesture(that,function callback(data){if(script.constructor===Function)return script.call(that,data);eval(script)})},dragmove:function(that,keys,script,_modelScope){var length=0,actionBackup="";function callbackMove(ev){if(ev.stopPropagation(),ev.preventDefault(),script.constructor===Function)return script.call(that,ev);eval(script)}var callbackStart=function(e){if(e.preventDefault(),1!=++length)return document.removeEventListener("pointermove",callbackMove),document.removeEventListener("pointerup",callbackEnd,{once:!0}),void document.removeEventListener("pointercancel",callbackEnd,{once:!0});actionBackup=that.style.touchAction,that.style.touchAction="none",document.addEventListener("pointermove",callbackMove),document.addEventListener("pointerup",callbackEnd,{once:!0}),document.addEventListener("pointercancel",callbackEnd,{once:!0})},callbackEnd=function(e){if(e.preventDefault(),1==--length)return document.addEventListener("pointermove",callbackMove),document.addEventListener("pointerup",callbackEnd,{once:!0}),void document.addEventListener("pointercancel",callbackEnd,{once:!0});that.style.touchAction=actionBackup,document.removeEventListener("pointermove",callbackMove),that.addEventListener("pointerdown",callbackStart,{once:!0})};that.addEventListener("pointerdown",callbackStart,{once:!0})}};function touchGesture(e,t){var n=0,r=0,i=0,o=0,l="",a=!1,s=[];function u(e,t){for(var n=0;n<s.length;n++)if(s[n].pointerId===t.pointerId)return void(2===e?s.splice(n,1):1===e&&s.splice(n,1,t));0===e&&s.push(t)}var c=function(e){e.preventDefault(),e.stopPropagation(),u(1,e);var l=s[1].clientX-s[0].clientX,a=s[1].clientY-s[0].clientY,c=.01*Math.sqrt(l**2+a**2),d=180*Math.atan2(a,l)/Math.PI;t({scale:c-i,angle:d-o,totalScale:c-n,totalAngle:d-r}),i=c,o=d},d=function(t){t.preventDefault(),u(2,t),s.length<=1?(0===s.length&&(document.removeEventListener("pointerup",d),document.removeEventListener("pointercancel",d)),e.style.touchAction=l,document.removeEventListener("pointermove",c)):(document.addEventListener("pointerup",d),document.addEventListener("pointercancel",d),2===s.length&&document.removeEventListener("pointermove",c))};e.addEventListener("pointerdown",function(t){if(t.preventDefault(),u(0,t),1===s.length&&(a&&s.unshift({pointerId:"custom",clientX:e.offsetLeft+e.offsetWidth/2,clientY:e.offsetTop+e.offsetHeight/2}),l=e.style.touchAction,e.style.touchAction="none",document.addEventListener("pointerup",d),document.addEventListener("pointercancel",d)),2===s.length){t.stopPropagation();var f=s[1].clientX-s[0].clientX,h=s[1].clientY-s[0].clientY;i=n=.01*Math.sqrt(f**2+h**2),o=r=180*Math.atan2(h,f)/Math.PI,document.addEventListener("pointermove",c)}else document.removeEventListener("pointermove",c)});var f=function(e){a&&!e.ctrlKey&&(a=!1,s.length=0,document.removeEventListener("pointermove",c),document.removeEventListener("keyup",f))};document.addEventListener("keydown",function(e){e.ctrlKey&&(a=!0,document.addEventListener("keyup",f))})}var callInputListener=function(e,t,n){var r=e["on$"+t],i=e["v2m$"+t],o=void 0,l=void 0;if(void 0!==r||void 0!==i){var a=e[t];null!=a&&a.constructor===Array&&(a=a.slice(0));try{void 0!==i&&(o=i(a,n)),void 0!==r&&(l=r(a,n))}catch(e){console.error(e)}}return void 0!==l?l:o},inputBoundRunning=!1,inputTextBound=function(e){if(!0!==e.fromSFFramework){var t=inputBoundRunning=e.target;t.viewInputted=!0;var n=t.typeData===Number?Number(t.value):t.value,r=callInputListener(t.sfModel,t.sfBounded,n);t.sfModel[t.sfBounded]=void 0!==r?r:n}},inputFilesBound=function(e){if(!0!==e.fromSFFramework){var t=e.target;callInputListener(t.sfModel,t.sfBounded,t.files),t.sfModel[t.sfBounded]=t.files}},inputCheckBoxBound=function(e){if(!0!==e.fromSFFramework){var t=inputBoundRunning=e.target;t.viewInputted=!0;var n=t.typeData===Number?Number(t.value):t.value,r=callInputListener(t.sfModel,t.sfBounded,n);void 0!==r&&(n=r);var i=t.sfModel,o=i[t.sfBounded].constructor;if(o===Array){var l=i[t.sfBounded].indexOf(n);-1===l&&!0===t.checked?i[t.sfBounded].push(n):-1!==l&&!1===t.checked&&i[t.sfBounded].splice(l,1)}else o===Boolean||t.typeData===Boolean?i[t.sfBounded]=t.checked:i[t.sfBounded]=n}},inputSelectBound=function(e){if(!0!==e.fromSFFramework){var t=inputBoundRunning=e.target;t.viewInputted=!0;var n=t.typeData;if(!0===t.multiple)for(var r=t.selectedOptions,i=[],o=0;o<r.length;o++)i.push(n===Number?Number(r[o].value):r[o].value);else i=n===Number?Number(t.selectedOptions[0].value):t.selectedOptions[0].value;var l=callInputListener(t.sfModel,t.sfBounded,i);t.sfModel[t.sfBounded]=void 0!==l?l:i}},assignElementData={select:function(e,t){for(var n=t.options,r=t.typeData,i=e.constructor===Array&&e,o=0,l=n.length;o<l;o++)!1===i?r===String?n[o].selected=n[o].value===e:n[o].selected=n[o].value==e:n[o].selected=-1!==i.indexOf(r===Number?Number(n[o].value):n[o].value)},checkbox:function(e,t){e.constructor===Array?t.checked=-1!==e.indexOf(t.typeData===Number?Number(t.value):t.value):e.constructor===Boolean?t.checked=Boolean(e):t.typeData===String?t.checked=t.value===e:t.checked=t.value==e}},inputBoundRun=function(e,t){if(0===e||e)for(var n=0;n<t.length;n++)if(inputBoundRunning!==t[n]){var r=new Event("change");r.fromSFFramework=!0,1===t.type?t[n].value=e:2===t.type?assignElementData.select(e,t[n]):3===t.type?t[n].checked=e==t[n].value:4===t.type&&assignElementData.checkbox(e,t[n]),t[n].dispatchEvent(r)}},triggerInputEvent=function(e){!0!==e.fromSFFramework&&(!0!==e.target.viewInputted?e.target.dispatchEvent(new Event("input")):e.target.viewInputted=!1)},elementBoundChanges=function(e,t,n,r){void 0===e.sf$bindedKey&&initBindingInformation(e);var i=e[t],o=0,l=null;if(null!=i&&(l=i.constructor),"number"===(n.getAttribute("typedata")||"").toLowerCase()&&(l=Number),n.typeData=l,$.on(n,"change",triggerInputEvent),"TEXTAREA"===n.tagName)$.on(n,"input",inputTextBound),n.value=i,o=1;else if(void 0!==n.selectedOptions)$.on(n,"input",inputSelectBound),o=2,assignElementData.select(i,n);else{if("radio"===(o=n.type.toLowerCase()))$.on(n,"input",inputTextBound),o=3,n.checked=i==n.value;else if("checkbox"===o)$.on(n,"input",inputCheckBoxBound),o=4,assignElementData.checkbox(i,n);else{if("file"===o)return void $.on(n,"input",inputFilesBound);$.on(n,"input",inputTextBound),n.value=i,o=1}}!0!==r&&modelToViewBinding(e,t,inputBoundRun,n,o)},bindInput=internal.model.bindInput=function(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=!1,o=r.getAttribute("sf-bind");if(null===o&&(o=r.getAttribute("sf-into"),i=!0),""===o&&(o=r.getAttribute("name")),null!==o){if(void 0===t[o])return void console.error("Can't get property \""+o+'" on model',t);r.sfBounded=o,r.sfModel=t,!1===i?(r.setAttribute("sf-bound",""),r.removeAttribute("sf-bind")):(r.setAttribute("sf-bound",""),r.removeAttribute("sf-into")),elementBoundChanges(t,o,r,i)}else console.error("Property key to be bound wasn't be found",r)}},dataParser=function(e,t,n,r,i,o){i||(i="");var l=self.modelKeys(r).join("|");if(0===l.length)throw"The model was not found";var a=RegExp(sf.regex.strictVar+"("+l+")\\b","g");if(n)var s=RegExp(sf.regex.strictVar+n+"\\.\\b","g");if(bindingEnabled=!0,"#noEval"===i)var u=[],c=o.length;var d=e.replace(sf.regex.dataParser,function(e,l){if(l=avoidQuotes(l,function(e){return e=e.split("&amp;").join("&").split("&lt;").join("<").split("&gt;").join(">"),n&&(e=e.replace(s,function(e){return"_model_."+e[0].slice(1)})),e.replace(a,function(e,t){return"_modelScope."+t})}).split("_model_._modelScope.").join("_model_."),"#noEval"===i){l=l.trim();var d=u.indexOf(l);return-1===d?(u.push(l),o.push({type:REF_DIRECT,data:[l,t,r]}),"{{%="+(u.length+c-1)):"{{%="+(d+c)}return(l=""+localEval.apply(self.root,[i+l,t,r])).replace(sf.regex.escapeHTML,function(e){return"&#"+e.charCodeAt(0)+";"})});return"#noEval"===i&&(r=u=t=n=i=a=s=e=null,setTimeout(function(){d=null})),d},uniqueDataParser=function(e,t,n,r,i){var o={length:0,_modelScope:r,take:function(e,r){if(null===e)return dataParser(this[r],t,n,this._modelScope);var i='"use strict";var ',o=!0;for(var l in e){if("string"==typeof e[l])e[l]='"'+e[l].split('"').join('\\"')+'"';else{if("_model_"===l){t=e[l];continue}"object"==typeof e[l]&&(e[l]=JSON.stringify(e[l]))}o||(i+=","),i+=l+" = "+e[l],o=!1}return!0===o&&(i=i.replace("var ","")),i=i.split("(").join("&#40;").split(")").join("&#41;"),dataParser(this[r],t,n,this._modelScope,i+";")}};e=e.replace(/{\[([\s\S]*?)\]}/g,function(e,t){return!1===/{{.*?}}/.test(t)?"_result_ += '"+t.split("'").join("\\'")+"'":(o[o.length]=t,o.length++,"_result_ += _content_.take(&VarPass&, "+(o.length-1)+");")});var l=self.modelKeys(r).join("|");if(0===l.length)throw"The model was not found";var a=RegExp(sf.regex.strictVar+"("+l+")\\b","g");if(n)var s=RegExp(sf.regex.strictVar+n+"\\.\\b","g");if("#noEval"===i)var u=[];var c=e.replace(sf.regex.uniqueDataParser,function(e,l){l=avoidQuotes(l,function(e){return e=e.split("&amp;").join("&").split("&lt;").join("<").split("&gt;").join(">"),n&&(e=e.replace(s,function(e){return"_model_."+e[0].slice(1)})),e.replace(a,function(e,t){return"_modelScope."+t})}).split("_model_._modelScope.").join("_model_.");for(var c=!1,d=/(var|let)([\w,\s]+)(?=\s(?==|in|of))/g,f=[],h=null;null!==(h=d.exec(l));)f.push(h[2]);if(null===t&&"#noEval"===i&&f.push("_model_"),0!==f.length){for(var p=[],v=0;v<f.length;v++)f[v].replace(/([\n\t\r]|  )+/g,"").split(",").forEach(function(e){p.push(e)});f=p;for(v=0;v<f.length;v++)f[v]+=":typeof "+f[v]+'!=="undefined"?'+f[v]+":void 0";f=0===f.length?"null":"{"+f.join(",")+"}",l=l.split("&VarPass&").join(f)}else l=l.split("&VarPass&").join("null");if(1!==(c=l.split("@if ")).length){c=c[1].split(":");var m=function(e){var t=null;2===(t=(e=(e=e.join(":")).split("@elseif "))[e.length-1].split("@else")).length?(e[e.length-1]=t[0],t=(t=t.pop()).substr(t.indexOf(":")+1)):t=null;for(var n={if:e.shift(),elseIf:[],elseValue:t},r=0;r<e.length;r++){var i=e[r].split(":");n.elseIf.push([i.shift(),i.join(":")])}return n};if("#noEval"===i){var g=c.shift(),b=m(c);b.type=REF_IF,b.data=[null,t,r,o],b.if=[g.trim(),b.if.trim()],null!==b.elseValue&&(b.elseValue=b.elseValue.trim());for(v=0;v<b.elseIf.length;v++)b.elseIf[v][0]=b.elseIf[v][0].trim(),b.elseIf[v][1]=b.elseIf[v][1].trim();return u.push(b),"{{%%="+(u.length-1)}var y=[c[0],t,r,o];return localEval.apply(self.root,y)?(c.shift(),y[0]=c.join(":"),localEval.apply(self.root,y)):(c.shift(),elseIfHandle(m(c),y))}if(1!==(c=l.split("@exec")).length){y=[c[1],t,r,o];return"#noEval"===i?(u.push({type:REF_EXEC,data:y}),"{{%%="+(u.length-1)):l=localEval.apply(self.root,y)}return""});return"#noEval"===i?(r=i=a=s=e=null,setTimeout(function(){c=null}),[c,u,o]):c};self.extractPreprocess=function(e,t,n){for(var r=e.querySelectorAll("[sf-repeat-this]"),i=0;i<r.length;i++){(u=r[i]).insertAdjacentHTML("afterEnd","<sfrepeat-this></sfrepeat-this>"),u.remove()}var o=e.outerHTML;null!==t&&(o=o.split("#"+t).join("_model_"));var l=(o=uniqueDataParser(o,null,t,n,"#noEval"))[1],a=o[2];o=dataParser(o[0],null,t,n,"#noEval",l),internal.component.skip=!0,o=$.parseElement(o)[0],internal.component.skip=!1;var s=o.querySelectorAll("sfrepeat-this");for(i=0;i<s.length;i++){var u;(u=s[i]).parentNode.replaceChild(r[i],u)}var c={repeat:[],input:[]},d=self.queuePreprocess(o,!0,c).reverse(),f=[];function h(e){for(var t=e.attributes,n=[],r=0,i=0;i<t.length;i++){var o=t[i].value.split("{{%=");if("@"!==t[i].name[0]){if(1!==o.length){if(":"===t[i].name[0]){var l={name:t[i].name.slice(1),value:t[i].value};e.removeAttribute(t[i].name),e.setAttribute(l.name,"")}else l={name:t[i].name,value:t[i].value};r=[],""===(o=l.value.replace(/{{%=([0-9]+)/g,function(e,t){return r.push(Number(t)),""}))&&1===r.length?l.direct=r[0]:l.parse_index=r,n.push(l)}}else{if(1!==o.length){console.error("To avoid vulnerability, template can't be used inside event callback",e);continue}n.push({name:t[i].name,value:t[i].value,event:!0}),e.removeAttribute(t[i].name)}}return n}var p=h(o);0!==p.length&&f.push({nodeType:1,address:[0],attributes:p});for(i=0;i<d.length;i++){var v={nodeType:d[i].nodeType};if(1===v.nodeType)v.attributes=h(d[i]),v.address=$.getSelector(d[i],!0);else if(3===v.nodeType){var m=d[i].textContent,g=[];if(m.replace(/{{%%=([0-9]+)/gm,function(e,t){g.push(Number(t))}),0!==g.length){m=m.split(/{{%%=[0-9]+/gm);for(var b=0;b<m.length;b++)m[b]=trimIndentation(m[b]).trim();d[i].textContent=m.shift();var y=d[i].parentNode,E=d[i].nextSibling,C=null;0!==g.length&&0!==d[i].textContent.length?C=$.getSelector(d[i],!0):null!==d[i].previousSibling&&(C=$.getSelector(d[i].previousSibling,!0));var O=[];for(b=0;b<g.length;b++){var w=document.createComment("");if(y.insertBefore(w,E),O.push({nodeType:-1,parse_index:g[b],startFlag:C,address:$.getSelector(w,!0)}),m[b]){var L=document.createTextNode(m[b]);y.insertBefore(L,E),b+1<g.length&&(C=$.getSelector(L,!0))}else null!==C&&b+1<g.length&&(C=C.slice())[C.length-1]++}if(Array.prototype.push.apply(f,O),""===d[i].textContent){d[i].remove();for(b=0;b<O.length;b++){var M=O[b].address;M[M.length-1]--}continue}if(-1===d[i].textContent.search(/{{%=[0-9]+/))continue}g=[],""===(m=d[i].textContent.replace(/{{%=([0-9]+)/gm,function(e,t){return g.push(Number(t)),""}))&&1===g.length?v.direct=g[0]:(v.value=d[i].textContent,v.parse_index=g),v.address=$.getSelector(d[i],!0)}f.push(v)}var k=function(){if(null===t)var e=RegExp("(?:{{.*?\\b|_modelScope\\.)("+self.modelKeys(n).sort(function(e,t){return t.length-e.length}).join("|")+")(\\b.*?}}|)","g");else e=sf.regex.arrayItemsObserve;for(var r={},i=0;i<l.length;i++){var o=l[i];if(0!==o.type){if(1===o.type){var s=o.if.join(";");null!==o.elseValue&&(s+=";"+o.elseValue);for(var u=0;u<o.elseIf.length;u++)s+=o.elseIf[u].join(";")}else 2===o.type&&(s=o.data[0]);(s=s.replace(/_result_ \+= _content_\.take\(.*?, ([0-9]+)\);/g,function(e,t){return a[t]})).split('"').join("'").replace(e,function(e,t){t=t.replace(/\['(.*?)'\]/g,function(e,t){return"."+t}),void 0===r[t]?r[t]=[i]:-1===r[t].indexOf(i)&&r[t].push(i)})}else o.data[0].split('"').join("'").replace(e,function(e,t){t=t.replace(/\['(.*?)'\]/g,function(e,t){return"."+t}),void 0===r[t]?r[t]=[i]:-1===r[t].indexOf(i)&&r[t].push(i)})}return r}(),x=Object.keys(k),S=[];for(i=0;i<x.length;i++)S.push([x[i],x[i].split(".")]);var T=c.input;for(i=0;i<T.length;i++)T[i]=$.getSelector(T[i],!0);var D=c.repeat;for(i=0;i<D.length;i++)D[i]=$.getSelector(D[i],!0);return{html:o,parse:l,addresses:f,modelReference:k,modelRef_array:S,specialElement:c}};var enclosedHTMLParse=!1,excludes={HTML:1,HEAD:1,STYLE:1,LINK:1,META:1,SCRIPT:1,OBJECT:1,IFRAME:1};function initBindingInformation(e){void 0===e.sf$bindedKey&&Object.defineProperty(e,"sf$bindedKey",{configurable:!0,enumerable:!1,writable:!0,value:{}})}self.queuePreprocess=function(e,t,n,r){var i=e.childNodes,o=!1;if(void 0===r){r=new Set,o=!0;for(var l=e.attributes,a=0;a<l.length;a++)if("@"===l[a].name[0]||-1!==l[a].value.indexOf("{{")){r.add(e);break}}for(var s=i.length-1;s>=0;s--){var u=i[s];if(void 0===excludes[u.nodeName])if(1===u.nodeType){if(!0===enclosedHTMLParse)continue;if("SF-M"===u.tagName||u.sf$controlled)continue;if(void 0!==(l=u.attributes)["sf-bind-list"])continue;if(void 0!==l["sf-repeat-this"]){n.repeat.push(u);continue}if(void 0===l["sf-into"]&&void 0===l["sf-bind"]||n.input.push(u),void 0!==internal.component[u.tagName])continue;for(a=0;a<l.length;a++)if("@"===l[a].name[0]||-1!==l[a].value.indexOf("{{")){r.add(u);break}self.queuePreprocess(u,t,n,r)}else if(3===u.nodeType){if(0===u.textContent.length){u.remove();continue}var c=u.textContent.indexOf("{[");if(-1!==c)enclosedHTMLParse=!1;else if(!0===enclosedHTMLParse)continue;var d=u.textContent.indexOf("]}");if(-1!==d&&(-1===c||c>d)){enclosedHTMLParse=!0;continue}if(-1!==u.nodeValue.indexOf("{{")){if(void 0===t){r.has(u.parentNode)||r.add(u.parentNode);break}r.has(u)||r.add(u)}}}if(o)return Array.from(r)},self.parsePreprocess=function(e,t){for(var n=[],r=0;r<e.length;r++){var i=processingElement=e[r];(internal.modelPending[t]||void 0===self.root[t])&&self(t);var o=self.root[t];if(3!==i.nodeType||-1!==n.indexOf(i.parentElement)){if(-1!==i.innerHTML.indexOf("sf-bind-list")&&"SF-M"!==i.tagName)return console.error("Can't parse element that already bound"),void console.log(i);if(!1===i.hasAttribute("sf-bind-ignore"))self.bindElement(i,t);else{var l=uniqueDataParser(i.innerHTML,o,!1,t);i.innerHTML=dataParser(l,o,!1,t);for(var a=i.attributes,s=0;s<a.length;s++)if(-1!==a[s].value.indexOf("{{")){var u=a[s];u.value=dataParser(u.value,o,!1,t)}}}else self.bindElement(i.parentElement,t),n.push(i.parentElement)}};var repeatedListBinding=internal.model.repeatedListBinding=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.hasAttribute("sf-repeat-this")){var i=r.getAttribute("sf-repeat-this");r.removeAttribute("sf-repeat-this");var o=i.split(" in ");if(2!==o.length)return console.error("'",i,"' must match the pattern like `item in items`");void 0===t[o[1]]&&(t[o[1]]=[]),void 0===t.sf$bindedKey&&initBindingInformation(t),void 0===t.sf$bindedKey[o[1]]&&(t.sf$bindedKey[o[1]]=null),function(){var e=new RepeatedElement(t,r,o,r.parentElement);window.asd=e,Object.defineProperty(t,o[1],{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){return 0===t.length?e.splice(0):e.replace(t,!0)}})}()}}},_double_zero=[0,0];class RepeatedElement extends Array{constructor(e,t,n,r){if(e.constructor===Number)return Array(e);var i=e[n[1]];if(super(i.length),0!==i.length)for(var o=0;o<i.length;o++)this[o]=i[o];i=null;var l=r.children.length<=1||0===r.textContent.trim().length,a=e["on$"+n[1]]||{};Object.defineProperty(e,"on$"+n[1],{enumerable:!0,configurable:!0,get:function(){return a},set:function(e){Object.assign(a,e)}});var s,u=void 0!==internal.component[t.tagName]&&window["$"+capitalizeLetters(t.tagName.toLowerCase().split("-"))];u||(t.setAttribute("sf-bind-list",n[1]),processingElement=t,s=self.extractPreprocess(t,n[0],e)),hiddenProperty(this,"$EM",new ElementManipulator),this.$EM.template=u||s,this.$EM.list=this,this.$EM.parentNode=r,this.$EM.modelRef=e,this.$EM.refName=n,this.$EM.callback=a;var c=this;function d(e,t){for(var n=0;n<c.length;n++){if(u)var r=new u(c[n]);else syntheticCache(r=templateParser(s,c[n]),s,c[n]);void 0===t?e.appendChild(r):(c.$EM.elements.push(r),e.insertBefore(r,t))}}if(r.classList.contains("sf-virtual-list")){var f=document.createElement(t.tagName);f.classList.add("virtual-spacer");var h=f.cloneNode(!0);f.classList.add("ceiling"),r.insertBefore(f,r.firstElementChild),h.classList.add("floor"),r.appendChild(h),hiddenProperty(this,"$virtual",{}),l||console.warn("Virtual list was initialized when the container has another child that was not sf-repeated element.",r);var p=document.createElement("div");d(p),this.$virtual.dom=p,this.$virtual.callback=a,r.replaceChild(s.html,r.children[1]),internal.virtual_scroll.handle(this,r),s.html.remove()}else l?(d(r),this.$EM.parentChilds=r.children):(this.$EM.bound_end=document.createComment(""),this.$EM.bound_start=document.createComment(""),r.insertBefore(this.$EM.bound_start,t),r.insertBefore(this.$EM.bound_end,t),this.$EM.elements=Array(this.length),d(r,this.$EM.bound_end));t.remove(),setTimeout(function(){var e=internal.findScrollerElement(r);if(null!==e){var t=getComputedStyle(e);"hidden"!==t.backfaceVisibility&&-1===t.overflow.indexOf("hidden")&&(e.classList.add("sf-scroll-element"),internal.addScrollerStyle())}},1e3)}pop(){this.$EM.remove(this.length),Array.prototype.pop.apply(this,arguments)}push(){var e=this.length;this.length+=arguments.length;for(var t=0,n=e;n<this.length;n++)this[n]=arguments[t++];if(1===arguments.length)this.$EM.append(e);else for(n=0;n<arguments.length;n++)this.$EM.append(e+n)}splice(){if(0===arguments[0]&&void 0===arguments[1])return this.$EM.clear(0),void(this.length=0);var e=this.length;Array.prototype.splice.apply(this,arguments);var t=arguments[0];t<0&&(t=e+t);var n=arguments[1];n||0===n||(n=this.length);for(var r=n-1;r>=0;r--)this.$EM.remove(t+r);if(this.$virtual&&this.$virtual.DOMCursor>=t&&(this.$virtual.DOMCursor=t-n),arguments.length>=3){n=arguments.length-2,t>=this.length&&(t=this.length-1);for(r=0;r<n;r++)this.$EM.insertAfter(t+r);this.$virtual&&this.$virtual.DOMCursor>=t&&(this.$virtual.DOMCursor+=n)}}shift(){Array.prototype.shift.apply(this,arguments),this.$EM.remove(0),this.$virtual&&this.$virtual.DOMCursor>0&&(this.$virtual.DOMCursor--,this.$virtual.reinitCursor())}unshift(){if(Array.prototype.unshift.apply(this,arguments),1===arguments.length)this.$EM.prepend(0);else for(var e=arguments.length-1;e>=0;e--)this.$EM.prepend(e);this.$virtual&&0!==this.$virtual.DOMCursor&&(this.$virtual.DOMCursor+=arguments.length,this.$virtual.reinitCursor())}replace(e,t){var n=this.length;if(this.$virtual&&this.$virtual.resetViewport(),e.length>=n&&0!==n){for(var r=n,i=0;i<n&&e[i]===this[i];i++)r--;if(0===r){if(e.length===n)return;return(o=e.slice(n)).unshift(n,0),void this.splice.apply(this,o)}if(r!==n){if(!0===t)(o=e.slice(i)).unshift(i,n-i),Array.prototype.splice.apply(this,o),this.refresh(i,n);return}}if(0===n)return Array.prototype.push.apply(this,arguments[0]),void this.$EM.hardRefresh(0);var o=[0,n];return Array.prototype.push.apply(o,arguments[0]),Array.prototype.splice.apply(this,o),!0!==arguments[1]?(this.$EM.clear(0),this.$EM.hardRefresh(0)):(this.length<n&&this.$EM.removeRange(this.length,n),this.refresh(0,this.length),this.$virtual&&this.$virtual.refreshVirtualSpacer&&this.$virtual.refreshVirtualSpacer(this.$virtual.DOMCursor)),this.$virtual&&this.$virtual.reset(),this}swap(e,t){if(e!==t){this.$EM.swap(e,t);var n=this[e];this[e]=this[t],this[t]=n}}move(e,t,n){if(e!==t){void 0===n&&(n=1),this.$EM.move(e,t,n);var r=Array.prototype.splice.apply(this,[e,n]);r.unshift(t,0),Array.prototype.splice.apply(this,r),this.$virtual&&this.$virtual.reinitCursor()}}getElement(e){if(this.$virtual){var t=this.$virtual.dom.children;if(e>=this.$virtual.DOMCursor){e-=this.$virtual.DOMCursor;var n=this.$EM.parentNode.childElementCount-2;return e<n?this.$EM.parentNode.children[e+1]:t[e-n+this.$virtual.DOMCursor]}return t[e]}return this.$EM.elements?this.$EM.elements[e]:this.$EM.parentChilds[e]}refresh(e,t,n){void 0===e||e.constructor===String?(n=e,e=0,t=this.length):void 0===t?t=e+1:t.constructor===String?(n=t,t=e+1):t<0?t=this.length+t:t+=e;var r=this.length-t;r<0&&(t+=r);for(var i=e;i<t;i++){var o=this.getElement(i);if(void 0===o){this.$EM.hardRefresh(i||0),this.$virtual&&(this.$virtual.DOMCursor=i||0);break}!1!==syntheticTemplate(o,this.$EM.template,n,this[i])&&(o.model!==this[i]&&(o.model=this[i]),this.$EM.callback.update&&this.$EM.callback.update(o,"replace"))}}hardRefresh(e,t){this.$EM.update(e,t),this.$virtual&&this.$virtual.DOMCursor&&this.$virtual.reinitCursor()}}class ElementManipulator{createElement(e){var t=this.list[e];if(void 0!==t){var n=this.template;if(n.constructor===Function)return new n(t);var r=templateParser(n,t);return syntheticCache(r,n,t),r}}virtualRefresh(){var e=this;return clearTimeout(this.refreshTimer),this.refreshTimer=setTimeout(function(){e.list.$virtual&&e.list.$virtual.reinitScroll()},100),this.list.$virtual.elements()}hardRefresh(e){var t=this.list,n=this.template.constructor===Function;if(t.$virtual)var r=t.$virtual.DOMCursor+t.$virtual.preparedLength;for(var i=this.parentChilds||this.elements||this.virtualRefresh(),o=e;o<i.length;o++)i[o].remove();if(t.$virtual)var l=t.$virtual.vCursor;for(o=e;o<t.length;o++){if(n)var a=new this.template(t[o]);else syntheticCache(a=templateParser(this.template,t[o]),this.template,t[o]);this.list.$virtual?null===l.floor&&o<r?this.parentNode.insertBefore(a,this.parentNode.lastElementChild):t.$virtual.dom.appendChild(a):this.parentNode.appendChild(a)}t.$virtual&&t.$virtual.refreshVirtualSpacer&&t.$virtual.refreshVirtualSpacer(t.$virtual.DOMCursor)}move(e,t,n){if(this.list.$virtual)var r=this.list.$virtual.DOMCursor+this.list.$virtual.preparedLength;var i=this.parentChilds||this.elements||this.virtualRefresh(),o=this.list.length-e-n;o<0&&(n+=o);for(var l=document.createElement("div"),a=0;a<n;a++)l.appendChild(i[e+a]);var s=i[t]||null,u=s&&s.parentNode;!1===u&&(u=this.list.$virtual&&this.list.length>=r?this.list.$virtual.dom:parentNode);for(a=0;a<n;a++)u.insertBefore(l.firstElementChild,s),this.callback.update&&this.callback.update(i[e+a],"move")}swap(e,t){var n=this.parentChilds||this.elements||this.virtualRefresh();if(e>t){var r=n[t];t=n[e],e=r}else e=n[e],t=n[t];var i=t.nextSibling,o=t.parentNode;e.parentNode.insertBefore(t,e.nextSibling),o.insertBefore(e,i),this.callback.update&&(this.callback.update(n[t],"swap"),this.callback.update(n[e],"swap"))}remove(e){var t=this.parentChilds||this.elements||this.virtualRefresh();if(t[e]){var n=t[e];if(this.callback.remove){var r=!1,i=function(){r||(r=!0,n.remove())};this.callback.remove(n,i)||i()}else n.remove()}}update(e,t){var n=this.parentChilds||this.elements||this.virtualRefresh(),r=this.list,i=this.template,o=i.constructor===Function;void 0===e?(e=0,t=r.length):void 0===t?t=e+1:t<0?t=r.length+t:t+=e;var l=r.length-t;l<0&&(t+=l);for(var a=e;a<t;a++){var s=n[a];if(void 0===s||void 0===r[a])break;if(o)var u=new i(r[a]);else syntheticCache(u=templateParser(i,r[a]),i,r[a]);this.list.$virtual?s.parentNode.replaceChild(u,s):(this.parentNode.replaceChild(u,s),this.callback.update&&this.callback.update(u,"replace"))}}removeRange(e,t){for(var n=this.parentChilds||this.elements||this.virtualRefresh(),r=e;r<t;r++)n[r].remove()}clear(){var e=this.parentNode;if(this.list.$virtual)var t=[e.firstElementChild,e.lastElementChild];e.textContent="",this.list.$virtual&&(e.appendChild(t[0]),e.appendChild(t[1]),this.list.$virtual.dom.textContent="",t[1].style.height=t[0].style.height=0,this.list.$virtual.reset(!0))}insertAfter(e){var t=this.parentChilds||this.elements||this.virtualRefresh(),n=this.createElement(e);if(0===t.length)this.parentNode.insertBefore(n,this.parentNode.lastElementChild);else{var r=t[e-1];r.parentNode.insertBefore(n,r.nextSibling)}this.callback.create&&this.callback.create(n)}prepend(e){var t=this.parentChilds||this.elements||this.virtualRefresh(),n=this.createElement(e),r=t[0];void 0!==r?(r.parentNode.insertBefore(n,r),this.callback.create&&this.callback.create(n)):this.parentNode.insertBefore(n,this.parentNode.lastElementChild)}append(e){var t=this.list;if(t.$virtual)var n=t.$virtual.DOMCursor+t.$virtual.preparedLength;var r=this.parentChilds||this.elements||this.virtualRefresh(),i=this.createElement(e);if(t.$virtual)return 0===e?this.parentNode.insertBefore(i,this.parentNode.lastElementChild):e>=n?(null===t.$virtual.vCursor.floor&&(t.$virtual.vCursor.floor=i),t.$virtual.dom.appendChild(i)):r[e-1].insertAdjacentElement("afterEnd",i),void(this.callback.create&&this.callback.create(i));this.parentNode.appendChild(i),this.callback.create&&this.callback.create(i)}replace(e){var t=this.list,n=t.getElement(e).sf$elementReferences,r=template.modelReference[key];if(void 0!==r){for(var i=0;i<n.length;i++)if(void 0!==n[i].textContent&&void 0!==n[i].ref.direct&&-1!==r.indexOf(n[i].ref.direct)){var o=n[i].textContent,l=$.escapeText(t[e][key]).replace(needle,func);if(t[e][key]===l)continue;for(o.textContent="",o.sf$haveChilds=!0,l=$.parseElement(l,!0);o.previousSibling&&o.previousSibling.sf$childRoot===o;)o.previousSibling.remove();var a=o.parentNode;for(i=0;i<l.length;i++)l[i].sf$childRoot=o,a.insertBefore(l[i],o)}}else console.error("Can't found binding for '"+key+"'")}}function elseIfHandle(e,t){for(var n=e.elseIf,r=0;r<n.length;r++)if(t[0]=n[r][0],localEval.apply(self.root,t))return t[0]=n[r][1],localEval.apply(self.root,t);return null===e.elseValue?"":(t[0]=e.elseValue,localEval.apply(self.root,t))}var templateParser_regex=/{{%=([0-9]+)/gm,REF_DIRECT=0,REF_IF=1,REF_EXEC=2,templateExec=function(e,t,n){for(var r={},i=null,o=0;o<e.length;o++)if(void 0===n||-1!==n.indexOf(o)){var l=e[o];if(l.data[1]=t,l.type!==REF_DIRECT)if(l.type!==REF_EXEC){if(l.type===REF_IF){var a=l.data;if(r[o]={type:l.type,data:""},a[0]=l.if[0],!localEval.apply(self.root,a)){r[o].data=elseIfHandle(l,a);continue}a[0]=l.if[1],r[o].data=localEval.apply(self.root,a)}}else r[o]={type:l.type,data:localEval.apply(self.root,l.data)};else void 0===(i=localEval.apply(self.root,l.data))?i="":(i.constructor===Object&&(i=JSON.stringify(i)),i.constructor!==String&&(i=String(i))),r[o]={type:l.type,data:i}}return r},templateParser=internal.model.templateParser=function(e,t,n){processingElement=e.html;for(var r=!0===n?e.html:e.html.cloneNode(!0),i=e.addresses,o=templateExec(e.parse,t),l=[],a=[],s=0;s<i.length;s++){var u=i[s],c=$.childIndexes(u.address,r);if(1!==u.nodeType){if(3===u.nodeType){f=c;if(l.push({textContent:f,ref:u}),void 0!==u.direct){f.textContent=o[u.direct].data;continue}f.textContent=f.textContent.replace(templateParser_regex,function(e,t){return o[t].data})}if(-1===u.nodeType){var d={dynamicFlag:c,direct:u.parse_index,parentNode:c.parentNode,startFlag:u.startFlag&&$.childIndexes(u.startFlag,r)};l.push(d),a.push(d)}}else for(var f=u.attributes,h=0;h<f.length;h++){var p=f[h];if(p.event)eventHandler(c,p,t);else{var v="value"===p.name&&("TEXTAREA"===c.tagName||"INPUT"===c.tagName&&!1===/checkbox|radio|hidden/.test(c.type));if(l.push({attribute:!0===v?c:c.attributes[p.name],ref:p}),void 0===p.direct)if("value"===p.name&&!0===v){var m=c.value;c.removeAttribute("value"),c.value=m,c.value=c.value.replace(templateParser_regex,function(e,t){return o[t].data})}else c.setAttribute(p.name,(p.value||c.value).replace(templateParser_regex,function(e,t){return o[t].data}));else{if("value"===p.name&&!0===v){c.value=o[p.direct].data,c.removeAttribute("value");continue}c.setAttribute(p.name,o[p.direct].data)}}}}r.model=t,r.sf$elementReferences=l;for(s=0;s<a.length;s++){u=a[s];var g=o[u.direct].data;if(void 0===g.onclick){g=$.parseElement(o[u.direct].data,!0);for(h=0;h<g.length;h++)u.parentNode.insertBefore(g[h],u.dynamicFlag)}else u.parentNode.insertBefore(g,u.dynamicFlag)}if(0!==e.specialElement.input.length){var b=e.specialElement.input,y=[];for(s=0;s<b.length;s++)y.push($.childIndexes(b[s],r));bindInput(y,t)}if(0!==e.specialElement.repeat.length){var E=e.specialElement.repeat,C=[];for(s=0;s<E.length;s++)C.push($.childIndexes(E[s],r));repeatedListBinding(C,t)}return r};function syntheticCache(e,t,n){void 0===e.sf$cache&&(e.sf$cache={});for(var r=e.sf$cache,i=t.modelRef_array,o=0;o<i.length;o++){var l=i[o];r[l[0]]=deepProperty(n,l[1])}}function syntheticTemplate(e,t,n,r){var i=e.sf$cache,o=t.modelRef_array;if(void 0!==n){if(void 0===(s=t.modelReference[n])||0===s.length)return console.log(e,t,n,r),console.error("Failed to run syntheticTemplate because property '"+n+"' is not observed"),!1;if(i)for(var l=0;l<o.length;l++){if((u=o[l])[0]===n){var a=deepProperty(r,u[1]);i[u[0]]!==a&&(i[u[0]]=a)}}}else{var s=[];for(l=0;l<o.length;l++){var u=o[l];if(void 0!==i){a=deepProperty(r,u[1]);i[u[0]]!==a&&(Array.prototype.push.apply(s,t.modelReference[u[0]]),i[u[0]]=a)}else Array.prototype.push.apply(s,t.modelReference[u[0]])}if(0===s.length)return!1}var c=templateExec(t.parse,r,s);function d(e){for(var n=!1,i=0;i<e.length;i++)if(-1!==s.indexOf(e[i])){n=!0;break}if(!1===n)return!1;var o=[];for(i=0;i<e.length;i++)void 0===c[e[i]]&&o.push(e[i]);return Object.assign(c,templateExec(t.parse,r,o)),!0}var f=e.sf$elementReferences,h=!1;for(l=0;l<f.length;l++){var p=f[l];if(void 0===p.dynamicFlag)if(void 0===p.textContent){if(void 0!==p.attribute){if(void 0!==p.ref.parse_index){if(!0===d(p.ref.parse_index)){v=p.ref.value.replace(templateParser_regex,function(e,t){return c[t].data});if(p.attribute.value===v)continue;p.attribute.value=v,h=!0}continue}if(c[p.ref.direct]){m=c[p.ref.direct].data;if(p.attribute.value==m)continue;p.attribute.value=m,h=!0}}}else{if(void 0!==p.ref.parse_index){if(!0===d(p.ref.parse_index)){var v=p.ref.value.replace(templateParser_regex,function(e,t){return c[t].data});if(p.textContent.textContent===v)continue;p.textContent.textContent=v,h=!0}continue}if(c[p.ref.direct]){var m=c[p.ref.direct].data;if(p.textContent.textContent===m)continue;var g=p.textContent;if(!0===g.sf$haveChilds)for(;g.previousSibling&&g.previousSibling.sf$childRoot===g;)g.previousSibling.remove();g.textContent=m}}else if(void 0!==c[p.direct]){for(var b=$.parseElement(c[p.direct].data,!0).reverse(),y=$.prevAll(p.dynamicFlag,p.startFlag),E=!1,C=0;C<b.length;C++){if(void 0===y[C]){E=!0;break}!1===y[C].isEqualNode(b[C])&&p.parentNode.replaceChild(b[C],y[C])}if(E)for(C=b.length-1;C>=0;C--)p.parentNode.insertBefore(b[C],p.dynamicFlag);else for(C=b.length;C<y.length;C++)y[C].remove();h=!0}}return h}}(),sf.API=function(e,t,n,r,i,o,l){var a=typeof n;"object"!==a&&"function"!==a&&(n={});var s={url:t,dataType:"json",method:"POST",success:function(e){!sf.API.onSuccess(e)&&r&&r(e,t),i&&i(200)},error:function(e,t){try{e=JSON.parse(e.response)}catch(e){}sf.API.onError(t,e),i&&i(t,e)}};return n.constructor!==FormData&&(s.contentType="application/json"),n.constructor===Function&&(i=r,r=n,n={}),n._method=e.toUpperCase(),o?s.beforeSend=function(e){e.setRequestHeader("X-Authorization","Bearer "+o),l&&l(e)}:void 0!==l&&(s.beforeSend=l),s.data=n,sf.ajax(s)},sf.API.onError=function(e,t){},sf.API.onSuccess=function(e){};var extendsAPI={get:function(e,t,n,r){return sf.API("get",this.url+e,t,n,r,this.accessToken)},post:function(e,t,n,r){return sf.API("post",this.url+e,t,n,r,this.accessToken)},delete:function(e,t,n,r){return sf.API("delete",this.url+e,t,n,r,this.accessToken)},put:function(e,t,n,r){return sf.API("put",this.url+e,t,n,r,this.accessToken)},upload:function(e,t,n,r,i){if(t.constructor!==FormData)return console.error("Parameter 2 must be a FormData");var o=void 0;return void 0!==i&&(o=function(e){e.upload.onprogress=function(e){e.lengthComputable&&i(e.loaded,e.total)}}),sf.API("post",this.url+e,t,n,r,this.accessToken,o)}};sf.API.instance=function(e){this.url=e,this.accessToken=!1,Object.assign(this,extendsAPI)},sf.controller=new function(){var e=this;e.pending={},e.active={},internal.controller={pending:[]},e.for=function(t,n){if(!sf.component.registered[t])return e.active[t]?n():void(e.pending[t]=n);sf.component.registered[t][1]=n},e.modelScope=function(e,t){var n=sf.controller.modelName(e);if(!n)throw"model or controller was not found";var r=e.getAttribute("sf-bind-list");if(r)var i=e;else null!==(i=$.parent(e,"[sf-bind-list]"))&&(r=i.getAttribute("sf-bind-list"));if(!r)return t?t(sf.model.root[n],-1):sf.model.root[n];var o=0;return r&&(o=$.prevAll(i,"[sf-bind-list]").length),t?t(sf.model.root[n][r],o):sf.model.root[n][r][o]},e.modelElement=function(e){return 1===e.nodeType&&void 0!==e.sf$controlled?e:$.parentHasProperty(e,"sf$controlled")},e.modelName=function(t){var n=e.modelElement(t);if(null!==n)return void 0===(n=n.sf$controlled)||e.active[n]||e.run(n),n;console.error("Can't find any controller for",t)},e.run=function(t,n){if(sf.component.registered[t])return console.error("'"+t+"' is registered as a component");if(e.pending[t]){sf.model.root[t]||(sf.model.root[t]={}),e.pending[t](sf.model.root[t],root_),e.active[t]=!0,delete e.pending[t];var r=internal.controller.pending.indexOf(t);-1!==r&&internal.controller.pending.splice(r,1)}void 0===sf.model.root[t]&&(sf.model.root[t]={}),n&&n(sf.model.root[t],root_)},e.init=function(t){if(!sf.loader.DOMWasLoaded)return sf(function(){e.init(t)});for(var n=$("[sf-controller]",t||document.body),r=0;r<n.length;r++)e.run(n[r].sf$controlled)}};var root_=function(e){if(sf.component.registered[e]){var t=[],n=sf.component.available[e];if(void 0!==n)for(var r=0;r<n.length;r++)t.push(sf.model.root[n[r]]);return t}if(!sf.model.root[e]){var i=sf.model.root[e]={};if(void 0!==internal.modelPending[e]){for(var o=internal.modelPending[e],l=0;l<o.length;l++)o[l](i,root_);delete internal.modelPending[e]}}return sf.model.root[e]},globals={},jsonpRequests=0;function Request(e){var t=Object.assign({},globals);"beforeCreate beforeOpen beforeSend error complete success statusCode".split(" ").forEach(function(e){delete t[e]});var n=Object.assign({url:window.location.toString(),method:"GET",data:!1,async:!0,cache:!0,user:"",password:"",headers:{},xhrFields:{},statusCode:{},processData:!0,dataType:"text",contentType:"application/x-www-form-urlencoded",timeout:0},t),r=Object.assign({},n,e);function i(e){for(var t,n,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];return globals[e]&&(t=globals[e].apply(globals,i)),r[e]&&(n=r[e].apply(r,i)),"boolean"!=typeof t&&(t=!0),"boolean"!=typeof n&&(n=!0),t&&n}if(!1!==i("beforeCreate",r)){r.type&&(r.method=r.type);var o=r.url.indexOf("?")>=0?"&":"?",l=r.method.toUpperCase();if(("GET"===l||"HEAD"===l||"OPTIONS"===l||"DELETE"===l)&&r.data){var a=void 0;(a="string"==typeof r.data?r.data.indexOf("?")>=0?r.data.split("?")[1]:r.data:serializeQuery(r.data)).length&&(r.url+=o+a,"?"===o&&(o="&"))}if("json"===r.dataType&&r.url.indexOf("callback=")>=0){var s,u="jsonp_"+(Date.now()+(jsonpRequests+=1)),c=r.url.split("callback="),d=c[0]+"callback="+u;if(c[1].indexOf("&")>=0){var f=c[1].split("&").filter(function(e){return e.indexOf("=")>0}).join("&");f.length>0&&(d+="&"+f)}var h=document.createElement("script");return h.type="text/javascript",h.onerror=function(){clearTimeout(s),i("error",null,"scripterror"),i("complete",null,"scripterror")},h.src=d,window[u]=function(e){clearTimeout(s),i("success",e),h.parentNode.removeChild(h),h=null,delete window[u]},document.head.appendChild(h),void(r.timeout>0&&(s=setTimeout(function(){h.parentNode.removeChild(h),h=null,i("error",null,"timeout")},r.timeout)))}"GET"!==l&&"HEAD"!==l&&"OPTIONS"!==l&&"DELETE"!==l||!1===r.cache&&(r.url+=o+"_nocache"+Date.now());var p=new XMLHttpRequest;if(p.requestUrl=r.url,p.requestParameters=r,!1===i("beforeOpen",p,r))return p;p.open(l,r.url,r.async,r.user,r.password);var v,m=null;if(("POST"===l||"PUT"===l||"PATCH"===l)&&r.data)if(r.processData)if([ArrayBuffer,Blob,Document,FormData].indexOf(r.data.constructor)>=0)m=r.data;else{var g="---------------------------"+Date.now().toString(16);"multipart/form-data"===r.contentType?p.setRequestHeader("Content-Type","multipart/form-data; boundary="+g):p.setRequestHeader("Content-Type",r.contentType),m="";var b=serializeQuery(r.data);if("multipart/form-data"===r.contentType){b=b.split("&");for(var y=[],E=0;E<b.length;E+=1)y.push('Content-Disposition: form-data; name="'+b[E].split("=")[0]+'"\r\n\r\n'+b[E].split("=")[1]+"\r\n");m="--"+g+"\r\n"+y.join("--"+g+"\r\n")+"--"+g+"--\r\n"}else m="application/json"===r.contentType?JSON.stringify(r.data):b}else m=r.data,p.setRequestHeader("Content-Type",r.contentType);return r.headers&&Object.keys(r.headers).forEach(function(e){p.setRequestHeader(e,r.headers[e])}),"void 0"==typeof r.crossDomain&&(r.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(r.url)&&RegExp.$2!==window.location.host),r.crossDomain||p.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.xhrFields&&Object.assign(p,r.xhrFields),p.onload=function(){if(v&&clearTimeout(v),p.status>=200&&p.status<300||0===p.status){var e=void 0;if("json"===r.dataType){var t=void 0;try{e=JSON.parse(p.responseText)}catch(e){t=!0}t?i("error",p,"parseerror"):i("success",e,p.status,p)}else i("success",e="text"===p.responseType||""===p.responseType?p.responseText:p.response,p.status,p)}else i("error",p,p.status);r.statusCode&&(globals.statusCode&&globals.statusCode[p.status]&&globals.statusCode[p.status](p),r.statusCode[p.status]&&r.statusCode[p.status](p)),i("complete",p,p.status)},p.onerror=function(){v&&clearTimeout(v),i("error",p,p.status),i("complete",p,"error")},r.timeout>0&&(p.onabort=function(){v&&clearTimeout(v)},v=setTimeout(function(){p.abort(),i("error",p,"timeout"),i("complete",p,"timeout")},r.timeout)),!1===i("beforeSend",p,r)?p:(p.send(m),p)}}function RequestShortcut(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[],i=r[0],o=r[1],l=r[2],a=r[3],s=r[4];"function"==typeof t[1]?(i=t[0],l=t[1],a=t[2],s=t[3]):(i=t[0],o=t[1],l=t[2],a=t[3],s=t[4]),[l,a].forEach(function(e){"string"==typeof e&&(s=e,e===l?l=void 0:a=void 0)});var u={url:i,method:"post"===e||"postJSON"===e?"POST":"GET",data:o,success:l,error:a,dataType:s=s||("json"===e||"postJSON"===e?"json":void 0)};return"postJSON"===e&&Object.assign(u,{contentType:"application/json",processData:!1,crossDomain:!0,data:"string"==typeof o?o:JSON.stringify(o)}),Request(u)}function serializeQuery(e,t){for(var n=Object.keys(e),r=0;r<n.length;r++){var i=e[n[r]];e.constructor===Array?n[r]+=t+"[]":e.constructor===Object&&(n[r]=t?t+"["+n[r]+"]":n[r]),n[r]="object"==typeof i?serializeQuery(i,n[r]):n[r]+"="+encodeURIComponent(i)}return n.join("&")}return Object.assign(Request,{get:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["get"].concat(e))},post:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["post"].concat(e))},json:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["json"].concat(e))},getJSON:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["json"].concat(e))},postJSON:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["postJSON"].concat(e))}}),Request.setup=function(e){e.type&&!e.method&&Object.assign(e,{method:e.type}),Object.assign(globals,e)},$.ajax=sf.ajax=Request,sf.events=function(){var e={},t={};function n(r,i){if(r.constructor!==Array){if(void 0===n[r]){var o=void 0;if(void 0!==i&&i.constructor===Boolean&&(o=i),void 0!==o)Object.defineProperty(n,r,{enumerable:!1,configurable:!0,get:function(){return o},set:function(e){if(o!==e){var i=t[r];if(void 0!==i){for(var l=0;l<i.length;l++)try{i[l].apply(null,arguments)}catch(e){console.error(e)}delete t[r]}Object.defineProperty(n,r,{enumerable:!1,configurable:!0,writable:!0,value:e})}}});else{n[r]=function(){for(var e=0;e<l.length;e++)try{l[e].apply(null,arguments),!0===l[e].once&&l.splice(e--,1)}catch(e){console.error(e)}},void 0===e[r]&&(e[r]=[]);var l=e[r]}}i&&i.constructor===Function&&(i(n[r]),i=null)}else for(var a=0;a<r.length;a++)n(r[a],i)}return self.warningWhen=10,n.when=function(e,r){if(!0===n[e])return r();void 0===t[e]&&(t[e]=[]),t[e].push(r)},n.once=function(t,n){n.once=!0,e[t].push(n)},n.on=function(t,n){void 0===e[t]&&(e[t]=[]),e[t].length>=self.warningWhen&&console.warn("Events",t,"have more than",self.warningWhen,"callback, there may possible memory leak."),e[t].push(n)},n.off=function(t,n){if(void 0===e[t])return e[t].length=0;var r=e[t].indexOf(n);-1!==r&&e[t].splice(r,1)},n}(),function(){var e=sf.lang=function(e){sf.lang.init(e)};e.list={},e.default="en",e.serverURL=!1,e.interpolate={},e.add=function(t,n){void 0===e.list[t]&&(e.list[t]={}),function e(t,n){var r=Object.keys(n);for(var i=0;i<r.length;i++){var o=r[i];void 0===t[o]?t[o]=n[o]:n[o].constructor===Object&&e(t[o],n[o])}}(e.list[t],n)};var t=/{(.*?)}/;function n(n,r){return n.replace(t,function(t,n){return void 0!==r[n]?r[n].constructor===Function?r[n]():r[n]:void 0!==e.interpolate[n]?e.interpolate[n].constructor===Function?e.interpolate[n]():e.interpolate[n]:t})}var r=!1,i=[];function o(){!1!==a&&(clearTimeout(r),r=setTimeout(function(){!1!==u&&u.abort(),u=sf.ajax({url:e.serverURL,data:{lang:e.default,paths:JSON.stringify(a)},dataType:"json",method:"POST",success:function(t){a=!1,e.add(e.default,t);for(var n=e.list[e.default],r=0;r<i.length;r++)void 0===i[r].callbackOnly?i[r](c(n,i[r].path)):i[r]();i.length=0},error:e.onError})},500))}function l(t,r,l){for(var s=e.list[e.default],u={},d=[],f=0;f<t.length;f++){var h=c(s,t[f]);h?u[t[f]]=h:d.push(t[f])}if(0===d.length)return r&&(u=n(u,r)),l?l(u):u;!1===a&&(a={});for(f=0;f<d.length;f++)c(a,d[f],1);var p=function(){for(var e=0;e<d.length;e++){var t=c(s,d[e]);t&&(u[d[e]]=t)}return l(u)};p.callbackOnly=!0,i.push(p),o()}e.get=function(t,r,s){return void 0!==r&&r.constructor===Function&&(s=r,r=void 0),t.constructor===String?function(t,r,l){var s=c(e.list[e.default],t);if(void 0!==s)return r&&(s=n(s,r)),l?l(s):s;!1===a&&(a={});c(a,t,1),l&&(l.path=t,i.push(l));return o(),t}(t,r,s):l(t,r,s)},e.assign=function(e,t,n,r){var i=Object.keys(t),o=Object.values(t);void 0!==n&&n.constructor===Function&&(r=n,n=void 0),l(o,n,function(t){for(var n=0;n<i.length;n++)e[i[n]]=t[o[n]];r&&r()})};var a=!1,s=[],u=!1;function c(e,t,n){for(var r=t.split("."),i=0,o=r.length-1;i<=o;i++){var l=r[i];if(void 0===n){if(void 0===e[l])return;e=e[l]}else{if(i===o)return void(e[l]=n);e=void 0===e[l]?e[l]={}:e[l]}}return e}function d(t,n){for(var r=e.list[e.default],i=t.length-1;i>=0;i--)if(t[i].sf_lang!==e.default||!0!==n){var o=t[i],l=o.getAttribute("sf-lang"),u=c(r,l);void 0!==u?(!0===n&&t.splice(i,1),"INPUT"===o.tagName?o.placeholder=u:o.textContent=u,o.sf_lang=e.default):!0!==n&&(!1===a&&(a={}),c(a,l,1),s.push(o))}else t.splice(i,1)}e.onError=!1,e.init=function(t){var n=t.querySelectorAll("[sf-lang]");if(void 0===e.list[e.default]&&(e.list[e.default]={}),d(n),!1!==a&&!1!==e.serverURL){var r=function(){a=!1,d(s,!0)};r.callbackOnly=!0,i.push(r),o()}!1!==a&&!1===e.serverURL&&console.warn("Some language was not found, and the serverURL was set to false")}}(),function(){var e=sf.url=function(){var n="";for(var r in t)"/"!==t[r]&&(n+="#"+r+t[r]);var i="|"+e.data.join("|");return e.paths+n+(1!==i.length?i:"")},t=e.hashes={};e.data={},e.paths="/",e.push=function(){window.history.pushState((window.history.state||0)+1,"",e())},e.replace=function(){window.history.replaceState(window.history.state,"",e())},e.get=function(n,r){return e.parse(),n.constructor===Number?e.paths.split("/")[n+1]:void 0!==t[n]?t[n].split("/")[r+1]:void 0},e.parse=function(n){if(void 0!==n){var r={hashes:{}};r.data=n.split("|");for(var i=r.data.shift().split("#"),o=1;o<i.length;o++){var l=i[o].split("/");r.hashes[l.shift()]="/"+l.join("/")}return r.paths=n.split("#")[0],r}e.data=window.location.hash.split("|");for(i=e.data.shift().split("#"),o=1;o<i.length;o++){l=i[o].split("/");t[l.shift()]="/"+l.join("/")}return e.paths=window.location.pathname,e},e.parse()}(),function(){var e=routerEval;routerEval=void 0;var t=/<html/,n=sf.url.hashes,r=!1,i=1,o=window.history.state||1,l=!1;window.addEventListener("popstate",function(e){if(r)return r=!1,void(o-=i);l=!0,i=window.history.state>=o?1:-1,o+=i,s.goto(),l=!1},!1),sf(function(){$.on(document.body,"click","a[href]",function(e){e.preventDefault();var t=e.target,n=t.getAttribute("href");if(null===n&&(n=(t=$.parent(t,"a[href]")).getAttribute("href")),"@"!==n[0]){-1===t.href.replace(window.location.origin,"").indexOf("//")&&s.goto(n)}else{var r=t.getAttribute("target");r?window.open(n.slice(1),r):window.location=n.slice(1)}})});var a={};internal.router={},internal.router.parseRoutes=function(e,t){var n=[],r=/\/:([^\/]+)/g,i=/^(path|url|templateURL|html|on|routes|beforeRoute|defaultData|cache)$/;return function e(o,l,a,s){""!==a&&(a+=" ");for(var u=0;u<o.length;u++){var c=o[u],d=l+c.path;void 0!==c.routes&&e(c.routes,d,a,s),d=d.split("//").join("/");var f=[],h=d.replace(r,function(e,t){return f.push(t),"/([^/]+)"}),p=RegExp("^"+h+"$");if(void 0!==c.url)p.url=c.url;else if(void 0!==c.templateURL)p.templateURL=c.templateURL;else if(void 0!==c.html){var v=p.html=document.createElement("sf-page-view");c.html.constructor===String?v.innerHTML=c.html:v.appendChild(c.html),v.classList.add("page-prepare")}p.keys=f,p.beforeRoute=c.beforeRoute,p.defaultData=c.defaultData||{},""!==a&&(p.selector=t.indexOf(a),-1===p.selector&&(p.selector=t.length,t.push(a.trim()))),void 0!==s&&(p.parent=s),void 0!==c.on&&(p.on=c.on),c.cache&&(p.cache=!0);for(var m=[],g=(f=Object.keys(c),0);g<f.length;g++)if(!i.test(f[g])){m.push(f[g]),e(c[f[g]],d,f[g],p);break}0!==m.length&&(p.hasChild=m,p.forChild=RegExp(h)),n.push(p)}}(e,"",""),n},internal.router.findRoute=function(e){for(var t=0;t<this.length;t++){var n=e.match(this[t]);if(null!==n){var r=this[t].keys;if(void 0!==r){var i=this[t].data={};n.shift();for(var o=0;o<r.length;o++)i[r[o]]=n[o]}return this[t]}}return!1};var s=sf.views=function(o,s){void 0===s&&(s="/");var u=this;s&&(void 0===sf.views.list[s]&&(sf.views.list[s]=[]),sf.views.list[s].push(u));var c=!1;"/"===s?u.currentPath=sf.url.paths:!1===s?u.currentPath="":(u.currentPath="",c=!0);var d=!1,f=!1;u.lastPath="/",u.currentDOM=null,u.lastDOM=null,u.relatedDOM=[],u.data={},u.maxCache=3;var h={};u.selector=function(e,t,n){d=!0;var r=(t||(h.isConnected?h:document)).querySelector(e||o);if(!r)return!1;if(r.sf$viewInitialized)return!1;if(null===b&&(b=r.getElementsByTagName("sf-page-view")),r){e&&(o=e);var i=null;if(0!==r.childNodes.length)if(1===r.childNodes.length&&"#text"===r.firstChild.nodeName&&""===r.firstChild.textContent.trim())r.firstChild.remove();else{i=document.createElement("sf-page-view"),r.insertBefore(i,r.firstChild);for(var l=1,a=r.childNodes.length;l<a;l++)i.appendChild(r.childNodes[1]);i.routePath=n||u.currentPath,i.routeCached=v.findRoute(i.routePath),i.classList.add("page-current"),r.defaultViewContent=i}return r.sf$viewInitialized=!0,t?r:(u.currentDOM=i,h=r,!0)}return!1};var p=[o],v=[];v.findRoute=internal.router.findRoute,internal.router.enabled=!0;var m={routeStart:[],routeFinish:[],routeCached:[],routeError:[]};u.on=function(e,t){if(void 0===m[e])return console.error("Event '"+e+"' was not exist");-1===m[e].indexOf(t)&&m[e].push(t)},u.addRoute=function(e){v.push.apply(v,internal.router.parseRoutes(e,p)),d||u.selector(),!f&&s&&sf(function(){f||("/"!==s||h.childElementCount||(u.currentPath="",f=u.goto(sf.url.paths)),c&&(f=void 0!==n[s]?u.goto(n[s]):u.goto("/"))&&(c=!1))})};var g=!1,b=null;function y(e,t){if(!e.aborted){r=!0,g=!1;for(var n=0;n<m.routeError.length;n++)m.routeError[n](e.status,t);window.history.go(-1*i)}}var E="SF-PAGE-VIEW";function C(e,t,n,r){for(var i=[e],o=e.parentElement;o!==h&&null!==o;)o.nodeName===E&&i.unshift(o),o=o.parentElement;for(var l=void 0,a=void 0,s=0;s<u.relatedDOM.length;s++)-1===i.indexOf(u.relatedDOM[s])&&(void 0===l&&(a=(l=u.relatedDOM[s]).parentElement),u.relatedDOM[s].classList.remove("page-current"));var c=void 0;for(s=0;s<i.length;s++)void 0===c&&i[s].parentElement===a&&(c=i[s]),i[s].classList.add("page-current");u.showedSibling=c,u.lastSibling=l,e.classList.add("page-current"),u.relatedDOM=i}return u.goto=function(i,c,d,f){if(u.currentPath!==i){var E=v.findRoute(i);if(E&&(void 0===E.beforeRoute||!E.beforeRoute(E.data))){if("/"===s?sf.url.paths=i:s&&(n[s]=i),l||f||sf.url.push(),!h.isConnected)return void 0!==h.nodeType&&(h={}),u.selector(),console.error(s,"can't route to",i,"because element with selector '"+o+"' was not found");if(g&&g.abort(),function(e){var t=!1;function n(n){if(null===n)return!1;if(t=function(e){for(var t=b.length-1;t>=0;t--)if(e===b[t].routePath)return b[t];return!1}(e))return!0;for(var r=n.children,i=0;i<r.length;i++)if(r[i].routePath===e)return t=r[i],!0;return!1}if(!1===n(h))for(var r=0;r<p.length&&!n(h.querySelector(p[r]));r++);if(!1===t)return!1;void 0!==u.currentDOM.routeCached.on&&u.currentDOM.routeCached.on.leaving&&u.currentDOM.routeCached.on.leaving();u.currentDOM=t,u.data=t.routerData,void 0!==u.currentDOM.routeCached.on&&u.currentDOM.routeCached.on.coming&&u.currentDOM.routeCached.on.coming();C(t);for(var i=m.routeCached,r=0;r<i.length;r++)i[r](u.currentPath,u.lastPath);return u.lastPath=u.currentPath,u.currentPath=u.currentDOM.routePath,!0}(i))return!0;for(var $=0;$<m.routeStart.length;$++)if(m.routeStart[$](u.currentPath,i))return;var O=function(e){if(E.selector||E.hasChild){var t=e.sf$viewSelector;void 0===t&&(t=e.sf$viewSelector={})}if(E.hasChild){for(var n=[],r=0;r<E.hasChild.length;r++){t[E.hasChild[r]]=u.selector(E.hasChild[r],e,i);var o=t[E.hasChild[r]].firstElementChild;o&&n.unshift(o)}0===n.length&&(n=void 0)}else n=void 0;if(void 0===E.selector)var l=h;else{var a=p[E.selector],s=(l=null,function(e){for(var t=[],n=0;n<b.length;n++)0===e.indexOf(b[n].routePath)&&t.push(b[n]);return t}(i));for(r=0;r<s.length;r++){var c=s[r].sf$viewSelector;void 0!==c&&void 0!==c[a]&&(l=c[a])}if(!l||!l.isConnected){if(void 0===E.parent)return e.remove(),y({status:0});var v=i.match(E.parent.forChild)[0];return u.goto(v,!1,d,function(t){if(w(l=t.sf$viewSelector[a],e,t),f)return f(e);var n=e.parentElement.defaultViewContent;n.routePath!==i&&n.classList.remove("page-current")})}}w(l,e,!1,n),f&&f(e)};return void 0!==E.templateURL&&void 0!==a[E.templateURL]?(O(a[E.templateURL].cloneNode(!0)),!0):E.html?(O(E.html.cloneNode(!0)),!0):(g=sf.ajax({url:window.location.origin+(E.templateURL||E.url||i),method:d||"GET",data:Object.assign(c||E.defaultData,{_sf_view:void 0===E.selector?o:p[E.selector].split(" ").pop()}),success:function(e){if(t.test(e))return console.error("Views request was received <html> while it was disalowed. Please check http response from Network Tab."),y(1);var n=document.createElement("sf-page-view");if(n.innerHTML=e,n.classList.add("page-prepare"),void 0!==E.templateURL){internal.component.skip=!0;var r=document.createElement("sf-page-view");r.innerHTML=e,r.classList.add("page-prepare"),a[E.templateURL]=r,internal.component.skip=!1}O(n)},error:y}),!0)}}function w(t,n,o,l){if(o&&(n.parentPageElement=o),n.routerData={},"#comment"===n.firstChild.nodeName&&0===n.firstChild.textContent.indexOf(" SF-View-Data")&&(n.routerData=JSON.parse(n.firstChild.textContent.slice(14)),n.firstChild.remove()),t.insertAdjacentElement("beforeend",n),Object.assign(n.routerData,E.data),u.data=n.routerData,!1!==u.dynamicScript)for(var a=n.getElementsByTagName("script"),s=0;s<a.length;s++)e(a[s].text);setTimeout(function(){void 0!==E.on&&E.on.coming&&E.on.coming(u.data),E.cache&&(n.routeNoRemove=!0);var e=u.currentDOM;u.currentDOM=n,C(n);for(var t=m.routeFinish,o=0;o<t.length;o++)if(t[o](u.currentPath,i))return;void 0!==l&&u.relatedDOM.push.apply(u.relatedDOM,l),null!==e&&(u.lastPath=u.currentPath,e.routeCached&&void 0!==e.routeCached.on&&e.routeCached.on.leaving&&e.routeCached.on.leaving(i,E),u.lastDOM=e),u.currentPath=i,n.routeCached=E,n.routePath=i,n.classList.remove("page-prepare"),r=!1;var a=u.currentDOM.parentNode;for(o=a.childElementCount-u.maxCache-1;o>=0;o--)a.defaultViewContent!==a.firstElementChild&&a.firstElementChild.routeNoRemove?a.firstElementChild.remove():a.childElementCount>1&&a.firstElementChild.nextElementSibling.remove()})}},u};s.list={},s.goto=function(e){var t=sf.url.parse(e);sf.url.data=t.data;var n=s.list;if(void 0!==n["/"])for(var r=n["/"],i=0;i<r.length;i++)r[i].currentPath!==t.paths&&r[i].goto(t.paths);for(var o=Object.keys(t.hashes),l=0;l<o.length;l++){if(void 0!==(r=n[o[l]]))for(i=0;i<r.length;i++)r[i].currentPath!==t.hashes[o[l]]&&r[i].goto(t.hashes[o[l]])}}}(),internal.virtual_scroll=new function(){var e=this,t=!1;function n(t,n,r,i){var o=Math.floor(e.prepareCount/2);if(t<e.prepareCount)return n.ceiling=-1,n.floor=i.children[2*e.prepareCount+1],void 0!==n.floor?n.floor=n.floor.offsetTop:n.floor=i.lastElementChild.offsetTop+1e3,void(n.floor-=n.initial);if(void 0!==i.children[o+1]&&(n.ceiling=i.children[o+1].offsetTop),void 0!==r.$virtual.preparedLength&&t>=r.length-r.$virtual.preparedLength)n.floor=r.$virtual.dCursor.floor.offsetTop+2*r.$virtual.scrollHeight;else{if(i.childElementCount<=e.prepareCount+3)return;n.floor=i.children[e.prepareCount+3].offsetTop,i.sf$scroll_reduce_floor&&(n.floor-=i.sf$scroll_reduce_floor,n.ceiling-=i.sf$scroll_reduce_floor)}n.ceiling-=n.initial,n.floor-=n.initial}function r(e,r,i,o,l){var a=r.$virtual,s=0,u=e;if(e>=r.length-a.preparedLength&&(s-=i,e=r.length-a.preparedLength),!(e-a.DOMCursor==0||e>=r.length)){if(t=!0,0===a.DOMCursor&&e<i+i/2||a.DOMCursor+i/2>e&&a.DOMCursor+i<e)l.scrollTop=r.getElement(u).offsetTop;else{for(var c=null,d=a.dCursor.ceiling,f=a.dCursor.floor,h=a.vCursor,p=o.childElementCount-2,v=0;v<p;v++)c=d.nextElementSibling,null===h.floor?(a.dom.insertAdjacentElement("beforeEnd",c),v===p-1&&(h.floor=c)):h.floor.insertAdjacentElement("beforeBegin",c);e>=i?e<r.length-a.preparedLength&&(e-=i):(s=i-e,a.DOMCursor=e=0);var m=a.preparedLength<=r.length?a.preparedLength:r.length;for(v=0;v<m&&void 0!==(c=a.dom.children[e]);v++)f.insertAdjacentElement("beforeBegin",c);a.DOMCursor=e,h.floor=a.dom.children[e]||null,h.ceiling=h.floor?h.floor.previousElementSibling:null,r.$virtual.refreshVirtualSpacer&&r.$virtual.refreshVirtualSpacer(e),n(e,a.bounding,r,o),void 0!==(c=o.children[i-s+1])&&(l.scrollTop=c.offsetTop-l.offsetTop)}t=!1}}function i(e){e.style.overflow="hidden",setTimeout(function(){e.style.overflow=""},50)}function o(e){var t=window.getComputedStyle(e),n=parseInt(t.marginTop)+parseInt(t.marginBottom);return e.offsetHeight+n||0}function l(e,t,i,o,l,a,s){var u=t.$virtual.DOMCursor,c=0;if(e){var d=-1,f=t.$virtual.preparedLength;do{d++}while(d<f&&o.children[d].offsetTop<l.scrollTop);(u+=d)>0&&(u-=1),c=l.scrollTop-o.children[d].offsetTop}if(e||o.childElementCount-2>t.$virtual.preparedLength){t.$virtual.DOMCursor=t.length;var h=u;e||(h=u<=i?u:u+i),r(h,t,i,o,l),l.scrollTop+=c}s&&s(u),a&&a(),n(u,t.$virtual.bounding,t,o)}e.prepareCount=4,e.handle=function(u,c){var d=u.$virtual;d.reset=function(e){d.DOMCursor=0,d.bounding.ceiling=-1,d.bounding.floor=0,d.vCursor.ceiling=null,d.vCursor.floor=d.dom.firstElementChild,d.bounding.initial=d.dCursor.ceiling.offsetTop,n(0,d.bounding,u,c)},d.reinitCursor=function(){d.vCursor.ceiling=d.dom.children[d.DOMCursor-1]||null,d.vCursor.floor=d.dom.children[d.DOMCursor]||null},d.reinitScroll=function(){n(d.DOMCursor,d.bounding,u,c)},d.elements=function(){return function(e,t){for(var n=[],r=void 0,i=e.$virtual.DOMCursor,o=0;o<i&&void 0!==(r=e.$virtual.dom.children[o]);o++)n.push(r);i=t.childElementCount-2;for(var o=1;o<=i&&void 0!==(r=t.children[o]);o++)n.push(r);var l=e.$virtual.dom.childElementCount+i;i=l-i-e.$virtual.DOMCursor;for(var o=0;o<i&&void 0!==(r=e.$virtual.dom.children[e.$virtual.DOMCursor+o]);o++)n.push(r);return n}(u,c)},d.dCursor={ceiling:c.querySelector(".virtual-spacer.ceiling"),floor:c.querySelector(".virtual-spacer.floor")},d.bounding={},d.vCursor={},d.reset(),d.targetNode=c,d.scrollHeight=d.dCursor.ceiling.nextElementSibling.offsetHeight;var f=c;d.destroy=function(){$.off(f,"scroll"),$.off(c,"mousedown mouseup"),d.dom.innerHTML="",function(e){for(var t=a.length-1;t>=0;t--)a[t].element===e&&a.splice(t,1)}(c),u.$virtual=void 0},d.resetViewport=function(){d.visibleLength=Math.floor(f.clientHeight/d.scrollHeight),d.preparedLength=d.visibleLength+2*e.prepareCount,d.preparedLength<18&&(d.preparedLength=18)},setTimeout(function(){u.$virtual&&c.isConnected&&(null===(f=internal.findScrollerElement(c))?(f=c,console.warn("Virtual List need scrollable container",c)):f.classList.add("sf-scroll-element"),internal.addScrollerStyle(),d.resetViewport(),c.hasAttribute("scroll-reduce-floor")&&(c.sf$scroll_reduce_floor=c.getAttribute("scroll-reduce-floor"),c.removeAttribute("scroll-reduce-floor")),c.classList.contains("sf-list-dynamic")?(!0,function(i,u,c){var d=i.$virtual,f=d.dCursor.ceiling,h=d.dCursor.floor,p=d.vCursor;p.floor=d.dom.firstElementChild,d.scrollTo=function(t){r(t,i,e.prepareCount,u,c),g=0,b=0,f.style.height=g+"px",h.style.height=b+"px"},d.refresh=function(t){l(t,i,e.prepareCount,u,c),y()},y(),d.visibleLength=u.childElementCount-2,d.preparedLength=d.visibleLength+2*e.prepareCount,d.preparedLength<18&&(d.preparedLength=18);for(var v=0;v<e.prepareCount;v++){var m=p.floor;if(null===m)break;p.floor=m.nextElementSibling,h.insertAdjacentElement("beforeBegin",m)}d.DOMCursor=0;var g=0,b=0;function y(){for(var e=d.preparedLength-(u.childElementCount-2),t=0;t<e&&null!==(m=null===p.ceiling?d.dom.firstElementChild:p.ceiling.nextElementSibling);t++)p.floor=m.nextElementSibling,h.insertAdjacentElement("beforeBegin",m)}var E=d.bounding;n(0,E,i,u);var C=!1;c.addEventListener("scroll",function(){if(C||t)return;C=!0,c.scrollTop<E.ceiling?(!function(){for(var t=null,n=!1,r=0;r<e.prepareCount&&null!==(t=null===p.floor?d.dom.lastElementChild:p.floor.previousElementSibling);r++)p.ceiling=t.previousElementSibling,d.DOMCursor--,f.insertAdjacentElement("afterEnd",t),g>0&&(g-=o(t)),d.DOMCursor<e.prepareCount&&!n&&(r=0,n=!0,t=null);(g<0||null===t)&&(g=0);for(var l=u.childElementCount-2-i.$virtual.preparedLength,r=0;r<l;r++)t=h.previousElementSibling,b+=o(t),null===p.floor?d.dom.insertAdjacentElement("beforeEnd",t):p.floor.insertAdjacentElement("beforeBegin",t),p.floor=t;null===p.floor?p.ceiling=d.dom.lastElementChild:p.ceiling=p.floor.previousElementSibling;f.style.height=g+"px",h.style.height=b+"px"}(),n(d.DOMCursor,E,i,u)):c.scrollTop>E.floor&&(!function(){var t=null;if(y(),null!==p.floor){null===p.ceiling&&(p.ceiling=p.floor.previousElementSibling);for(var n=0;n<e.prepareCount&&null!==(t=p.floor);n++)p.floor=t.nextElementSibling,h.insertAdjacentElement("beforeBegin",t),b>0&&(b-=o(t))}(b<0||null===t)&&(b=0);for(var r=u.childElementCount-2-i.$virtual.preparedLength,n=0;n<r;n++)t=f.nextElementSibling,g+=o(t),d.DOMCursor++,null===p.ceiling?d.dom.insertAdjacentElement("afterBegin",t):p.ceiling.insertAdjacentElement("afterEnd",t),p.ceiling=t;null===p.ceiling?p.floor=d.dom.firstElementChild:p.floor=p.ceiling.nextElementSibling;f.style.height=g+"px",h.style.height=b+"px"}(),n(d.DOMCursor,E,i,u));0!==i.length&&(d.callback.hitFloor&&null===d.vCursor.floor&&c.scrollTop+c.clientHeight===c.scrollHeight?d.callback.hitFloor(d.DOMCursor):d.callback.hitCeiling&&null===d.vCursor.ceiling&&0===c.scrollTop&&d.callback.hitCeiling(d.DOMCursor));C=!1,0===c.scrollTop&&f.offsetHeight>10&&d.scrollTo(0)},{capture:!0,passive:!0}),function(e,t){-1===s&&(s=setInterval(function(){for(var e=null,t=a.length-1;t>=0;t--)(e=a[t]).element.isConnected?e.element.scrollHeight!==e.height&&e.element.scrollWidth!==e.width&&e.callback():a.splice(t,1);0===a.length&&(clearInterval(s),s=-1)},1e3));a.push({element:e,callback:t,height:e.scrollHeight,width:e.scrollWidth})}(u,function(){n(d.DOMCursor,E,i,u)})}(u,c,f)):function(o,a,s){for(var u=o.$virtual,c=u.dCursor.ceiling,d=u.dCursor.floor,f=u.preparedLength<=o.length?u.preparedLength:o.length,h=0;h<f&&null!==u.dom.firstElementChild;h++)d.insertAdjacentElement("beforeBegin",u.dom.firstElementChild);function p(t){if(t>=e.prepareCount)c.style.height=(t-e.prepareCount)*u.scrollHeight+"px",d.style.height=(o.length-u.preparedLength-t)*u.scrollHeight+"px";else{c.style.height=t*u.scrollHeight+"px";var n=o.length-u.preparedLength;d.style.height=(n||0)*u.scrollHeight+"px"}}u.refreshVirtualSpacer=p;var v=u.bounding;p(0),n(e.prepareCount,v,o,a),v.ceiling=-1,u.offsetTo=function(e){return e*u.scrollHeight+c.offsetTop},u.vCursor.floor=u.dom.firstElementChild,u.scrollTo=function(t){r(t,o,e.prepareCount,a,s)},u.refresh=function(t){l(t,o,e.prepareCount,a,s,y,p)};var m=!1,g=!0,b=!1;function y(){if(m||t||s.scrollTop>=v.ceiling&&s.scrollTop<=v.floor)b&&(0!==s.scrollTop&&s.scrollTop!==s.scrollHeight-s.clientHeight||(i(s),b=!1));else{var r=Math.floor(s.scrollTop/u.scrollHeight);r+u.preparedLength>o.length&&(r=o.length-u.preparedLength),g&&(r<2*e.prepareCount&&(r-=e.prepareCount),b&&(i(s),b=!1),g=!1),r<e.prepareCount&&(r=0,g=!0),m=!0;var l=r-u.DOMCursor;r+l>=o.length&&(l=r+l-o.length),0!==l?(u.DOMCursor=r,function(e,t){var n=t.$virtual.dom,r=t.$virtual.vCursor,i=t.$virtual.dCursor;if(e>0){for(var o=0,l=0;l<e&&null!==(o=null===r.ceiling?n.firstElementChild:r.ceiling.nextElementSibling);l++)i.floor.insertAdjacentElement("beforeBegin",o);for(var l=e;l>0;l--)null===r.ceiling?(r.ceiling=i.ceiling.nextElementSibling,n.insertAdjacentElement("afterBegin",r.ceiling)):(o=i.ceiling.nextElementSibling,r.ceiling.insertAdjacentElement("afterEnd",o),r.ceiling=o);r.floor=r.ceiling.nextElementSibling}else if(e<0){var o=0;e=-e;for(var l=0;l<e&&null!==(o=null===r.floor?n.lastElementChild:r.floor.previousElementSibling);l++)i.ceiling.insertAdjacentElement("afterEnd",o);for(var l=0;l<e;l++)null===r.floor?(r.floor=i.floor.previousElementSibling,n.insertAdjacentElement("beforeEnd",r.floor)):(o=i.floor.previousElementSibling,r.floor.insertAdjacentElement("beforeBegin",o),r.floor=o);r.ceiling=r.floor.previousElementSibling}}(l,o),p(r),n(r,v,o,a),0!==o.length&&(u.callback.hitFloor&&null===u.vCursor.floor?u.callback.hitFloor(r):u.callback.hitCeiling&&null===u.vCursor.ceiling&&u.callback.hitCeiling(r)),m=!1):m=!1}}s.addEventListener("scroll",y,{capture:!0,passive:!0}),s===a&&-1!==navigator.userAgent.indexOf("Chrom")&&($.on(a,"mousedown",function(){b=!0}),$.on(a,"mouseup",function(){b=!1}))}(u,c,f))},500)};var a=[],s=-1;var u=!1;internal.addScrollerStyle=function(){if(!u){var e=document.getElementById("sf-styles");e||((e=document.createElement("style")).id="sf-styles",document.head.appendChild(e)),e.sheet.insertRule(".sf-virtual-list .virtual-spacer{visibility: hidden !important;position: relative !important;transform-origin: 0 0 !important;width: 0 !important;margin: 0 !important;padding: 0 !important;background: none !important;border: none !important;box-shadow: none !important;transition: none !important;}",e.sheet.cssRules.length),e.sheet.insertRule(".sf-scroll-element {backface-visibility: hidden;}",e.sheet.cssRules.length),u=!0}};var c=/auto|scroll|overlay|hidden/;internal.findScrollerElement=function(e){for(;null!==e&&!1===c.test(getComputedStyle(e).overflow);)if((e=e.parentElement)===document.body)return null;return e}},sf});
//# sourceMappingURL=scarletsframe.min.1570118067648.js.map
