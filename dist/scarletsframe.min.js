/*
  ScarletsFrame
  A frontend library for Scarlets Framework that support
  lazy page load and element binding that can help
  simplify your code

  https://github.com/ScarletsFiction/ScarletsFrame
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(e):e.sf=t(e)}("undefined"!=typeof window?window:this,function(window){"use strict";void 0===typeof document&&(document=window.document);var sf=function e(){if(arguments[0].constructor===Function)return e.loader.onFinish.apply(null,arguments)};function isEmptyObject(e){for(var t in e)return!1;return!0}function compareObject(e,t){if(!e||!t)return!1;for(var r in e)if("object"!=typeof e[r]&&e[r]!==t[r])return!1;return!0}sf.internal={},sf.regex={getQuotes:/((?<![\\])['"])((?:.(?!(?<![\\])\1))*.?)\1/gm,avoidQuotes:"(?=(?:[^\"']*(?:'|\")[^\"']*(?:'|\"))*[^\"']*$)",strictVar:"(?=\\b[^.]|^|\\n| +|\\t|\\W )"},sf.controller=new function(){var self=this;self.pending={},self.active={},self.for=function(e,t){self.pending[e]=t},self.modelScope=function(e,t){var r=sf.controller.modelName(e);if(!r)throw"model or controller was not found";var n=e.getAttribute("sf-bind-list");if(n)var o=e;else null!==(o=$.parent(e,"[sf-bind-list]"))&&(n=o.getAttribute("sf-bind-list"));if(!n)return t?t(sf.model.root[r],-1):sf.model.root[r];var i=0;return n&&(i=$.prevAll(o,"[sf-bind-list]").length),t?t(sf.model.root[r][n],i):sf.model.root[r][n][i]},self.modelName=function(e){var t=void 0;return void 0===(t=e.hasAttribute("sf-controller")?e.getAttribute("sf-controller"):$.parent(e,"[sf-controller]").getAttribute("sf-controller"))||self.active[t]||self.run(t),t};var listenSFClick=function listenSFClick(e){var element=e.target,script=element.getAttribute("sf-click");script||(element=$.parent(element,"[sf-click]"),script=element.getAttribute("sf-click"));var model=$.parent(element,"[sf-controller]").getAttribute("sf-controller");if(!sf.model.root[model])throw"Couldn't find model for "+model+" that was called from sf-click";var _modelScope=sf.model.root[model],modelKeys=sf.model.modelKeys(_modelScope),scopeMask=RegExp(sf.regex.strictVar+"("+modelKeys+")"+sf.regex.avoidQuotes+"\\b","g");script=script.replace(scopeMask,function(e,t){return"_modelScope."+t}),script=script.split("(");var method=script[0],method_=method;try{method=eval(method)}catch(e){method=!1}if(method){script.shift(),script=script.join("("),script=script.split(")"),script.pop(),script=script.join("("),0!==script.length&&(script=eval(("["+script+"]").replace(/,this|\[this/g,function(e){return e[0]+"element"}))),script||(script=[]);try{method.apply(element,script),e.preventDefault()}catch(e){console.error("Error on sf-click for model: "+model+"\n",element,"\n",e)}}else console.error("Error on sf-click for model: "+model+" [Cannot call `"+method_+"`]\n",element)},root_=function(e){return sf.model.root[e]||(sf.model.root[e]={}),sf.model.root[e]||sf.controller.run(e),sf.model.root[e]};self.run=function(e,t){if(!sf.loader.DOMWasLoaded)return sf(function(){self.run(e,t)});self.pending[e]&&(sf.model.root[e]||(sf.model.root[e]={}),self.pending[e](sf.model.root[e],root_),self.active[e]=!0,delete self.pending[e]),t&&t(sf.model.root[e],root_)},self.init=function(e){if(!sf.loader.DOMWasLoaded)return sf(function(){self.init(name)});for(var t=$("[sf-controller]",e||document.body),r=0;r<t.length;r++)self.run(t[r].getAttribute("sf-controller"))},document.addEventListener("DOMContentLoaded",function(){$.on(document.body,"click","[sf-click]",listenSFClick)},{capture:!0,once:!0})},sf.dom=function(e,t){return"<"===e[0]?sf.dom.parseElement(e):e.constructor!==String?e:t?t.querySelectorAll(e):document.querySelectorAll(e)};var $=sf.dom;!function(){var e=sf.dom;e.findOne=function(e,t){return void 0!==t?t.querySelector(e):document.querySelector(e)},e.parent=function(e,t){if(e.closest)return e.closest(t);var r="matches";e.matches||(r=e.msMatchesSelector?"msMatchesSelector":"webkitMatchesSelector");do{if(!0===e[r](t))return e;e=e.parentElement}while(null!==e);return null},e.prevAll=function(e,t,r){var n="matches",o=[];e.matches||(n=e.msMatchesSelector?"msMatchesSelector":"webkitMatchesSelector");do{!0===e[n](t)&&o.push(e),e=r?e.nextElementSibling:e.previousElementSibling}while(null!==e);return o},e.nextAll=function(t,r){return e.prevAll(t,r,!0)},e.on=function(t,r,n,o,i){if("string"==typeof t&&(t=document,o=n,n=r,r=t),"function"==typeof n&&(o=n,n=null),n){var l=o;o=function(t){null!==e.parent(t.target,n)&&l(t)}}o.selector=n,t.addEventListener(r,o,{capture:!0,once:!0===i})},e.once=function(t,r,n,o){e.on(t,r,n,o,!0)},e.off=function(t,r,n){if(void 0!==r)if(0===(l=r.split(" ")).length){var o=getEventListeners(t);if(void 0!==o&&void 0!==o[r])for(i=o[r].length-1;i>=0;i--)n&&o[r][i].selector!==n||t.removeEventListener(r,o[r].splice(i,1),!0)}else for(var i=0;i<l.length;i++)e.off(t,l[i]);else for(var l=getEventListeners(t),i=0;i<l.length;i++)e.off(t,l[i])},e.animateCSS=function(e,t,r,n){var o={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var i in o)if(void 0!==e.style[i]){o=o[i];break}n&&(e.style.webkitAnimationDuration=n+"s",e.style.animationDuration=n+"s");var l=("animated "+t).split(" ");e.classList.add.apply(e.classList,l),$.once(e,o,function(){e.classList.remove.apply(e.classList,l),n&&setTimeout(function(){e.style.webkitAnimationDuration=n+"s",e.style.animationDuration=n+"s"},1),"function"==typeof r&&r()})};var t={div:document.createElement("div"),ul:document.createElement("ul"),tbody:document.createElement("tbody"),tr:document.createElement("tr"),table:document.createElement("table"),select:document.createElement("select")};e.parseElement=function(e,r){var n=[],o=t.div;0===e.indexOf("<li")&&(o=t.ul),0===e.indexOf("<tr")&&(o=t.tbody),0!==e.indexOf("<td")&&0!==e.indexOf("<th")||(o=t.tr),0===e.indexOf("<tbody")&&(o=t.table),0===e.indexOf("<option")&&(o=t.select),o.textContent="",o.insertAdjacentHTML("afterBegin",e);for(var i=o[r?"childNodes":"children"],l=0;l<i.length;l++)n.push(i.item(l));return n},e.remove=function(e){if(void 0!==e.remove)return e.remove();for(var t=0;t<e.length;t++)e[t].remove()};var r=null;setTimeout(function(){sf.loader.domReady(function(){r=document.body.parentElement})},1),e.getSelector=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var o=[];!1===n&&(n=r);for(var i=t?"previousSibling":"previousElementSibling";null!==e.parentElement;){if(e.id){o.unshift("#"+e.id);break}if(e===n)!1===t?o.unshift(e.tagName):o.unshift(0);else{for(var l=e,a=t?0:1;l[i];)l=l[i],a++;t?o.unshift(a):o.unshift(":nth-child("+a+")")}e=e.parentElement}return t?o:o.join(" > ")},e.childIndexes=function(e,t){var n=t||r,o=1;if(e[0].constructor===String)n=n.querySelector(e[0]);else if(1===e.length)return n;for(o=o;o<e.length;o++)if(null===(n=n.childNodes.item(e[o])))return null;return n}}();var globals={},jsonpRequests=0;function Request(e){var t=Object.assign({},globals);"beforeCreate beforeOpen beforeSend error complete success statusCode".split(" ").forEach(function(e){delete t[e]});var r=Object.assign({url:window.location.toString(),method:"GET",data:!1,async:!0,cache:!0,user:"",password:"",headers:{},xhrFields:{},statusCode:{},processData:!0,dataType:"text",contentType:"application/x-www-form-urlencoded",timeout:0},t),n=Object.assign({},r,e);function o(e){for(var t,r,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return globals[e]&&(t=globals[e].apply(globals,o)),n[e]&&(r=n[e].apply(n,o)),"boolean"!=typeof t&&(t=!0),"boolean"!=typeof r&&(r=!0),t&&r}if(!1!==o("beforeCreate",n)){n.type&&(n.method=n.type);var i=n.url.indexOf("?")>=0?"&":"?",l=n.method.toUpperCase();if(("GET"===l||"HEAD"===l||"OPTIONS"===l||"DELETE"===l)&&n.data){var a=void 0;(a="string"==typeof n.data?n.data.indexOf("?")>=0?n.data.split("?")[1]:n.data:serializeQuery(n.data)).length&&(n.url+=i+a,"?"===i&&(i="&"))}if("json"===n.dataType&&n.url.indexOf("callback=")>=0){var s,f="jsonp_"+(Date.now()+(jsonpRequests+=1)),u=n.url.split("callback="),d=u[0]+"callback="+f;if(u[1].indexOf("&")>=0){var c=u[1].split("&").filter(function(e){return e.indexOf("=")>0}).join("&");c.length>0&&(d+="&"+c)}var p=document.createElement("script");return p.type="text/javascript",p.onerror=function(){clearTimeout(s),o("error",null,"scripterror"),o("complete",null,"scripterror")},p.src=d,window[f]=function(e){clearTimeout(s),o("success",e),p.parentNode.removeChild(p),p=null,delete window[f]},document.querySelector("head").appendChild(p),void(n.timeout>0&&(s=setTimeout(function(){p.parentNode.removeChild(p),p=null,o("error",null,"timeout")},n.timeout)))}"GET"!==l&&"HEAD"!==l&&"OPTIONS"!==l&&"DELETE"!==l||!1===n.cache&&(n.url+=i+"_nocache"+Date.now());var v=new XMLHttpRequest;if(v.requestUrl=n.url,v.requestParameters=n,!1===o("beforeOpen",v,n))return v;v.open(l,n.url,n.async,n.user,n.password);var m,h=null;if(("POST"===l||"PUT"===l||"PATCH"===l)&&n.data)if(n.processData)if([ArrayBuffer,Blob,Document,FormData].indexOf(n.data.constructor)>=0)h=n.data;else{var g="---------------------------"+Date.now().toString(16);"multipart/form-data"===n.contentType?v.setRequestHeader("Content-Type","multipart/form-data; boundary="+g):v.setRequestHeader("Content-Type",n.contentType),h="";var b=serializeQuery(n.data);if("multipart/form-data"===n.contentType){b=b.split("&");for(var y=[],E=0;E<b.length;E+=1)y.push('Content-Disposition: form-data; name="'+b[E].split("=")[0]+'"\r\n\r\n'+b[E].split("=")[1]+"\r\n");h="--"+g+"\r\n"+y.join("--"+g+"\r\n")+"--"+g+"--\r\n"}else h="application/json"===n.contentType?JSON.stringify(n.data):b}else h=n.data,v.setRequestHeader("Content-Type",n.contentType);return n.headers&&Object.keys(n.headers).forEach(function(e){v.setRequestHeader(e,n.headers[e])}),void 0===n.crossDomain&&(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!==window.location.host),n.crossDomain||v.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.xhrFields&&Object.assign(v,n.xhrFields),v.onload=function(){if(m&&clearTimeout(m),v.status>=200&&v.status<300||0===v.status){var e=void 0;if("json"===n.dataType){var t=void 0;try{e=JSON.parse(v.responseText)}catch(e){t=!0}t?o("error",v,"parseerror"):o("success",e,v.status,v)}else o("success",e="text"===v.responseType||""===v.responseType?v.responseText:v.response,v.status,v)}else o("error",v,v.status);n.statusCode&&(globals.statusCode&&globals.statusCode[v.status]&&globals.statusCode[v.status](v),n.statusCode[v.status]&&n.statusCode[v.status](v)),o("complete",v,v.status)},v.onerror=function(){m&&clearTimeout(m),o("error",v,v.status),o("complete",v,"error")},n.timeout>0&&(v.onabort=function(){m&&clearTimeout(m)},m=setTimeout(function(){v.abort(),o("error",v,"timeout"),o("complete",v,"timeout")},n.timeout)),!1===o("beforeSend",v,n)?v:(v.send(h),v)}}function RequestShortcut(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[],o=n[0],i=n[1],l=n[2],a=n[3],s=n[4];"function"==typeof t[1]?(o=t[0],l=t[1],a=t[2],s=t[3]):(o=t[0],i=t[1],l=t[2],a=t[3],s=t[4]),[l,a].forEach(function(e){"string"==typeof e&&(s=e,e===l?l=void 0:a=void 0)});var f={url:o,method:"post"===e||"postJSON"===e?"POST":"GET",data:i,success:l,error:a,dataType:s=s||("json"===e||"postJSON"===e?"json":void 0)};return"postJSON"===e&&Object.assign(f,{contentType:"application/json",processData:!1,crossDomain:!0,data:"string"==typeof i?i:JSON.stringify(i)}),Request(f)}function serializeQuery(e,t){for(var r=Object.keys(e),n=0;n<r.length;n++){var o=e[r[n]];e.constructor===Array?r[n]+=t+"[]":e.constructor===Object&&(r[n]=t?t+"["+r[n]+"]":r[n]),r[n]="object"==typeof o?serializeQuery(o,r[n]):r[n]+"="+encodeURIComponent(o)}return r.join("&")}return Object.assign(Request,{get:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["get"].concat(e))},post:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["post"].concat(e))},json:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["json"].concat(e))},getJSON:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["json"].concat(e))},postJSON:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["postJSON"].concat(e))}}),Request.setup=function(e){e.type&&!e.method&&Object.assign(e,{method:e.type}),Object.assign(globals,e)},$.ajax=sf.ajax=Request,sf.loader=new function(){var e=this;e.loadedContent=0,e.totalContent=0,e.DOMWasLoaded=!1,e.DOMReady=!1,e.turnedOff=!1;var t=[],r=[],n=[];e.off=function(){e.turnedOff=!0},e.onFinish=function(t){if(e.DOMWasLoaded)return t();-1===r.indexOf(t)&&r.push(t)},e.domReady=function(r){if(e.DOMReady)return r();-1===t.indexOf(r)&&t.push(r)},e.onProgress=function(t){if(e.DOMWasLoaded)return t(e.loadedContent,e.totalContent);-1===n.indexOf(t)&&n.push(t)},e.f=function(t){e.loadedContent++;for(var r=0;r<n.length;r++)n[r](e.loadedContent,e.totalContent);t&&t.removeAttribute&&t.removeAttribute("onload")},e.css=function(t){if(e.DOMWasLoaded){for(var r=t.length-1;r>=0;r--)0!==$('link[href*="'+t[r]+'"]').length&&t.splice(r,1);if(0===t.length)return}e.totalContent=e.totalContent+t.length;var n="";for(r=0;r<t.length;r++)n+='<link onload="sf.loader.f(this);" rel="stylesheet" href="'+t[r]+'">';e.domReady(function(){document.getElementsByTagName("body")[0].insertAdjacentHTML("beforeend",n)})},e.js=function(t){if(e.DOMWasLoaded){for(var r=t.length-1;r>=0;r--)0!==$('script[src*="'+t[r]+'"]').length&&t.splice(r,1);if(0===t.length)return}e.totalContent=e.totalContent+t.length;for(r=0;r<t.length;r++){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=t[r],n.addEventListener("load",sf.loader.f,{once:!0}),n.addEventListener("error",sf.loader.f,{once:!0}),document.head.appendChild(n)}},setTimeout(function(){0!==e.totalContent||e.turnedOff||(e.loadedContent=e.totalContent=1,console.warn("If you don't use content loader feature, please turn it off with `sf.loader.off()`"))},1e4);var o=setInterval(function(){if(/loaded|complete/.test(document.readyState)){if(!1===e.DOMReady){e.DOMReady=!0;for(var i=0;i<t.length;i++)try{t[i]()}catch(e){console.error(e)}}if((e.loadedContent<e.totalContent||0===e.loadedContent)&&!e.turnedOff)return;var l=sf.dom("script");for(i=0;i<l.length;i++)l[i].removeEventListener("error",sf.loader.f);clearInterval(o),e.DOMWasLoaded=!0;for(i=0;i<r.length;i++)try{r[i]()}catch(e){console.error(e)}n.splice(0),t.splice(0),r.splice(0),n=t=r=null,sf.controller.init(),sf.model.init(),sf.router.init()}},100)},sf.prototype.constructor=sf.loader.onFinish,sf.loader.domReady(function(){for(var e=$("img:not(onload)[src]"),t=0;t<e.length;t++)sf.loader.totalContent++,e[t].setAttribute("onload","sf.loader.f(this)")},0),sf.model=function(e){return sf.model.root[e]||(sf.model.root[e]={}),sf.controller.pending[e]&&sf.controller.run(e),sf.model.root[e]},function(){var self=sf.model,bindingEnabled=!1;self.root={};var processingElement=null;function trimIndentation(e){var t=e.split("\n",3);return 0===(t=(t=" "!==t[0][0]||"\t"!==t[0][0]?t[1]:t[0]).length-t.trim().length)?e:e.replace(RegExp("^([\\t ]{"+t+"})","gm"),"")}var bracketMatch=RegExp("([\\w.]*?[\\S\\s])\\("+sf.regex.avoidQuotes,"g"),chackValidFunctionCall=/[a-zA-Z0-9 \]\$\)]/,allowedFunction=[":","for","if","while","_content_.take","console.log"],localEval=function localEval(script,_model_,_modelScope,_content_){var tempScript=script;tempScript=tempScript.replace(sf.regex.getQuotes,'"Quotes"');for(var preventExecution=!1,check_=null;null!==(check_=bracketMatch.exec(tempScript));)if(check_[1]=check_[1].trim(),-1===allowedFunction.indexOf(check_[1])&&"_modelScope"!==check_[1].split(".")[0]&&chackValidFunctionCall.test(check_[1][check_[1].length-1])){preventExecution=check_[1];break}if(preventExecution)return console.error("Trying to executing unrecognized function ("+preventExecution+")"),console.log(trimIndentation(processingElement.outerHTML).trim()),"#DOMError";var _result_="";try{if(!0===/@return /.test(script)){var _evaled_=eval("(function(){"+script.split("@return ").join("return ")+"})()");return _result_+_evaled_}var _evaled_=eval(script)}catch(e){return console.error(e),console.log(trimIndentation(processingElement.outerHTML).trim()),"#DOMError"}return""!==_result_?_result_:_evaled_};function escapeEscapedQuote(e){return e.split('\\"').join("\\$%*").split("\\'").join("\\%$*")}function unescapeEscapedQuote(e){return e.split("\\$%*").join('\\"').split("\\%$*").join("\\'")}function elseIfHandle(e,t){for(var r=e.elseIf,n=0;n<r.length;n++)if(t[0]=r[n][0],localEval.apply(self.root,t))return t[0]=r[n][1],localEval.apply(self.root,t);return null===e.elseValue?"":(t[0]=e.elseValue,localEval.apply(self.root,t))}self.index=function(e){for(var t=-1,r=e.tagName,n=e;null!==e;)e.tagName===r&&t++,e=e.previousElementSibling;var o=n.getAttribute("sf-bind-list");if(!o)return t;var i=sf.model.root[sf.controller.modelName(n)][o];return i.$virtual?t+i.$virtual.DOMCursor-1:t},self.for=function(e,t){if(!sf.loader.DOMWasLoaded)return sf(function(){self.for(e,t)});t(self(e),self)},self.modelKeys=function(e){for(var t=Object.keys(e),r=t.length-1;r>=0;r--)-1!==t[r].indexOf("$")&&t.splice(r,1);return t.join("|")};var preparedParser_regex=/{{%=([0-9]+)/gm,REF_DIRECT=0,REF_IF=1,REF_EXEC=2,preparedParser=function(e,t){var r=e.html.cloneNode(!0),n=e.addresses,o=e.parse,i={};r.model=t;for(var l=0;l<o.length;l++){if((s=o[l]).data[1]=t,s.type===REF_DIRECT||s.type===REF_EXEC)i[l]={type:s.type,data:localEval.apply(self.root,s.data)};else if(s.type===REF_IF){var a=s.data;if(i[l]={type:s.type,data:""},a[0]=s.if[0],!localEval.apply(self.root,a)){i[l].data=elseIfHandle(s,a);continue}a[0]=s.if[1],i[l].data=localEval.apply(self.root,a)}}for(l=0;l<n.length;l++){var s=n[l],f=$.childIndexes(s.address,r);if(1!==s.nodeType){if(3===s.nodeType){v=f;if(!1!==s.direct){v.textContent=i[s.direct].data;continue}var u=f.parentNode;if(v.textContent=v.textContent.replace(preparedParser_regex,function(e,t){var r=i[t];return r.type===REF_DIRECT?r.data:e}),void 0!==s.innerHTML){var d=s.indexes;for(u=f.parentNode,m=0;m<d.length;m++){var c=i[d[m]],p=$.parseElement(c.data+s.innerHTML[m],!0);for(m=0;m<p.length;m++)u.insertBefore(p[m],f.nextSibling),f=p[m]}}}}else for(var v=s.attributes,m=0;m<v.length;m++){var h=v[m];!1===h.direct?(h=f.attributes[h.name]).value=h.value.replace(preparedParser_regex,function(e,t){return i[t].data}):f.setAttribute(h.name,i[h.direct].data)}}return r},dataParser=function(e,t,r,n,o,i){var l=self.root[n];o||(o="");for(var a=self.modelKeys(l),s=a.length-1;s>=0;s--)l[a[s]]instanceof Function&&a.splice(s,1);var f=RegExp(sf.regex.strictVar+"("+a+")"+sf.regex.avoidQuotes+"\\b","g");if(r)var u=RegExp(sf.regex.strictVar+r+"\\."+sf.regex.avoidQuotes+"\\b","g");if(bindingEnabled=!0,"#noEval"===o)var d=[],c=i.length;var p=e.replace(/{{([^@][\s\S]*?)}}/g,function(e,n){if(n=escapeEscapedQuote(n),r&&(n=n.replace(u,function(e){return"_model_."+e[0].slice(1)})),n=(n=unescapeEscapedQuote(n=n.replace(f,function(e,t){return"_modelScope."+t}))).split("&amp;").join("&").split("&lt;").join("<").split("&gt;").join(">"),"#noEval"===o){n=n.trim();var a=d.indexOf(n);return-1===a?(d.push(n),i.push({type:REF_DIRECT,data:[n,t,l]}),"{{%="+(d.length+c-1)):"{{%="+(a+c)}return(n=""+localEval.apply(self.root,[o+n,t,l])).replace(/(?!&#.*?;)[\u00A0-\u9999<>\&]/gm,function(e){return"&#"+e.charCodeAt(0)+";"})});return"#noEval"===o&&(d=a=l=t=r=n=o=f=u=e=null,setTimeout(function(){p=null},1)),p},uniqueDataParser=function(e,t,r,n,o){var i={length:0,take:function(e,o){if(null===e)return dataParser(this[o],t,r,n);var i='"use strict";var ',l=!0;for(var a in e)"string"==typeof e[a]?e[a]='"'+e[a].split('"').join('\\"')+'"':"object"==typeof e[a]&&(e[a]=JSON.stringify(e[a])),l||(i+=","),i+=a+" = "+e[a],l=!1;return!0===l&&(i=i.replace("var ","")),i=i.split("(").join("&#40;").split(")").join("&#41;"),dataParser(this[o],t,r,n,i+";")}};e=e.replace(/{\[([\s\S]*?)\]}/g,function(e,t){return!1===/{{.*?}}/.test(t)?"_result_ += '"+t.split("'").join("\\'")+"'":(i[i.length]=t,i.length++,"_result_ += _content_.take(&VarPass&, "+(i.length-1)+");")});var l=self.root[n],a=RegExp(sf.regex.strictVar+"("+self.modelKeys(l)+")"+sf.regex.avoidQuotes+"\\b","g");if(r)var s=RegExp(sf.regex.strictVar+r+"\\."+sf.regex.avoidQuotes+"\\b","g");if("#noEval"===o)var f=[];var u=e.replace(/{{(@[\s\S]*?)}}/g,function(e,n){n=escapeEscapedQuote(n),r&&(n=n.replace(s,function(e){return"_model_."+e[0].slice(1)})),n=(n=unescapeEscapedQuote(n=n.replace(a,function(e,t){return"_modelScope."+t}))).split("&amp;").join("&").split("&lt;").join("<").split("&gt;").join(">");for(var u=!1,d=/(var|let)([\w,\s]+)(?=\s(?==|in|of))/g,c=[],p=null;null!==(p=d.exec(n));)c.push(p[2]);if(null===t&&"#noEval"===o&&c.push("_model_"),0!==c.length){for(var v=[],m=0;m<c.length;m++)c[m].replace(/([\n\t\r]|  )+/g,"").split(",").forEach(function(e){v.push(e)});c=v;for(m=0;m<c.length;m++)c[m]+=":(typeof "+c[m]+'!=="undefined"?'+c[m]+":undefined)";c=0===c.length?"null":"{"+c.join(",")+"}",n=n.split("&VarPass&").join(c)}else n=n.split("&VarPass&").join("null");if(1!==(u=n.split("@if ")).length){u=u[1].split(":");var h=function(e){var t=null;2===(e=(e=e.join(":")).split("@else"+(-1!==e.indexOf(":")?":":" :"))).length?t=e.pop():e=e[0];for(var r={if:(e=e.split("@elseif ")).shift(),elseIf:[],elseValue:t},n=0;n<e.length;n++){var o=e[n].split(":");r.elseIf.push([o.shift(),o.join(":")])}return r};if("#noEval"===o){var g=u.shift(),b=h(u);b.type=REF_IF,b.data=[null,t,l,i],b.if=[g.trim(),b.if.trim()],null!==b.elseValue&&(b.elseValue=b.elseValue.trim());for(m=0;m<b.elseIf.length;m++)b.elseIf[m][0]=b.elseIf[m][0].trim(),b.elseIf[m][1]=b.elseIf[m][1].trim();return f.push(b),"{{%%="+(f.length-1)}var y=[u[0],t,l,i];return localEval.apply(self.root,y)?(u.shift(),y[0]=u.join(":"),localEval.apply(self.root,y)):(u.shift(),elseIfHandle(h(u),y))}if(1!==(u=n.split("@exec")).length){y=[u[1],t,l,i];return"#noEval"===o?(f.push({type:REF_EXEC,data:y}),"{{%%="+(f.length-1)):n=localEval.apply(self.root,y)}return""});return"#noEval"===o?(l=o=a=s=e=null,setTimeout(function(){u=null},1),[u,f]):u},bindArray=function(e,t,r,n,o,i,l,a){var s=["pop","push","splice","shift","unshift","swap","move","$replace","softRefresh","hardRefresh"],f=-1,u=function(r,i,a,s){if("clear"===i){if(t.$virtual)var u=[l.firstElementChild,l.lastElementChild];return l.textContent="",void(t.$virtual&&(l.appendChild(u[0]),l.appendChild(u[1])))}if("hardRefresh"!==i){var d=self.root[n]["on$"+o];if("swap"===i||"move"===i){var c=l.children;if(t.$virtual&&(r++,a++),"move"===i){var p=t.length-r-s;p<0&&(s+=p);var v=document.createElement("div");for(O=0;O<s;O++)v.appendChild(c[r]);var m=c[a]||null;for(O=0;O<s;O++)l.insertBefore(v.firstElementChild,m),void 0!==d&&d.update&&d.update(null!==m&&m.previousElementSibling||l.lastElementChild,"move");return}if(r>=a){var h=r;r=a,a=h}return c[r].insertAdjacentElement("afterEnd",c[a]),c[a].insertAdjacentElement("afterEnd",c[r]),void(void 0!==d&&d.update&&(d.update(c[a],"swap"),d.update(c[r],"swap")))}if(t.$virtual){var g=t.$virtual.elements();clearTimeout(f),f=setTimeout(function(){t.$virtual.refresh(!0)},100)}else g=l.children;if("remove"!==i){if("update"===i){a=a?a<0?t.length+a:r-a:r+1;for(O=r;O<a;O++){var b=g[O];if(void 0===b||void 0===t[O])break;h=preparedParser(e,t[O]);if(t.$virtual)return void b.parentNode.replaceChild(h,b);l.replaceChild(h,b),void 0!==d&&d.update&&d.update(h,"replace")}}if(void 0!==(x=t[r])){h=preparedParser(e,x);var y=g[r];if("insertAfter"===i){r=0!==r?r-1:g.length-1;if(!(y=g[r]))return void(t.$virtual&&0!==t.length||(l.insertAdjacentElement("afterBegin",h),void 0!==d&&d.create&&d.create(h)));y.insertAdjacentElement("afterEnd",h),void 0!==d&&d.create&&d.create(h),t.$virtual&&t.$virtual.refresh()}else if("append"===i){if(t.$virtual&&0!==t.length)return g[r-1].insertAdjacentElement("afterEnd",h),void 0!==d&&d.create&&d.create(h),void t.$virtual.refresh();l.appendChild(h),void 0!==d&&d.create&&d.create(h)}else"insertBefore"===i&&(g[0].insertAdjacentElement("beforeBegin",h),void 0!==d&&d.create&&d.create(h),t.$virtual&&t.$virtual.refresh())}}else if(g[r]){var E=!1,C=function(){E||(E=!0,g[r].remove(),t.$virtual&&t.$virtual.refresh())};void 0!==d&&d.remove?d.remove(g[r],C)||setTimeout(C,800):C()}}else{for(var x=t,O=r;O<x.length;O++)t.$virtual?l.insertBefore(preparedParser(e,x[O]),l.lastElementChild):l.appendChild(preparedParser(e,x[O]));t.$virtual&&t.$virtual.refresh()}},d=[0],c=[0,0],p=function(e,t){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,value:function(){var e=void 0,r=this.length;if("move"!==t){if("swap"===t){var n=arguments[0],o=arguments[1];if(n===o)return;u(n,"swap",o);e=this[n];return this[n]=this[o],void(this[o]=e)}if("$replace"===t){if(arguments[0].length>=r&&0!==r){var i=r,l=arguments[0];for(n=0;n<r&&l[n]===this[n];n++)i--;if(0===i){if(l.length===r)return;return Array.prototype.splice.apply(this,[r,0].concat(arguments[0].slice(r))),void u(r,"hardRefresh")}}return 0!==r&&(Array.prototype.splice.apply(this,d),u(0,"clear")),Array.prototype.splice.apply(this,c.concat(arguments[0])),u(0,"hardRefresh"),this}if("splice"===t&&0===arguments[0]&&void 0===arguments[1])return u(0,"clear"),Array.prototype.splice.apply(this,arguments);if(Array.prototype[t]&&(e=Array.prototype[t].apply(this,arguments)),"pop"===t)u(this.length,"remove");else if("push"===t)u(r,"append");else if("shift"===t)u(0,"remove");else if("splice"===t){if(0===arguments[0]&&void 0===arguments[1])return e;var a=arguments[0];a<0&&(a=r+a);var s=arguments[1];s||0===s||(s=this.length);for(n=s-1;n>=0;n--)u(a+n,"remove");if(arguments.length>=3){s=arguments.length-2;for(n=0;n<s;n++)u(a+n,"insertAfter")}}else"unshift"===t?u(0,"insertBefore"):"softRefresh"===t?u(arguments[0],"update",arguments[1]):"hardRefresh"===t&&u(0,"hardRefresh");return e}var f=arguments[0],p=arguments[1];if(f!==p){var v=arguments[2]||1;u(f,"move",p,v);var e=Array.prototype.splice.apply(this,[f,v]);Array.prototype.splice.apply(this,[p,0].concat(e))}}})};l&&l.classList.contains("sf-virtual-list")&&(delete t.$virtual,t.$virtual={},t.$virtual.dom=a,l.replaceChild(e.html,l.children[1]),sf.internal.virtual_scroll.handle(t,i,l),e.html.remove());for(var v=0;v<s.length;v++)p(t,s[v]);Object.defineProperty(t,"getElement",{enumerable:!1,configurable:!0,value:function(e){if(t.$virtual){if(e<t.$virtual.DOMCursor)return t.$virtual.dom.children[e];e-=t.$virtual.DOMCursor;var r=l.childElementCount-2;return e<=r?l.children[e+1]:t.$virtual.dom.children[e-r+t.$virtual.DOMCursor]}return l.children[e]}})},loopParser=function(e,t,r,n,o){var i=r.split(" in "),l=i[0];if(!self.root[e])return console.error("Can't parse element because model for '"+e+"' was not found",t);var a=self.root[e][i[1]];if(void 0!==a){if(t.setAttribute("sf-bind-list",i[1]),processingElement=t,t=self.extractPreprocess(t,l,e),2===i.length){var s=document.createElement("div"),f=self.root[e];for(var u in a)s.appendChild(preparedParser(t,a[u]));if(void 0===f.sf$bindedKey&&initBindingInformation(f),void 0===f.sf$bindedKey[i[1]]&&(f.sf$bindedKey[i[1]]=null),Object.defineProperty(f,i[1],{enumerable:!0,configurable:!0,get:function(){return a},set:function(e){return 0===e.length?a.splice(0):a.$replace(e)}}),bindArray(t,a,l,e,i[1],n,o,s),void 0===a.$virtual){var d=s.children;for(u=0;u<d.length;u++)o.appendChild(d[u]);s.remove(),s=null}}}else console.error("Can't bind array to `"+i[1]+"` because undefined property in model `"+e+"`")},inputBoundFunction=function(e){self.root[e.target["sf-model"]][e.target["sf-bounded"]]=e.target.value},bindInput=function(e){for(var t=$("input[sf-bound]",e),r=0;r<t.length;r++){var n=t[r],o=sf.controller.modelName(n);if(!o)return;var i=n.getAttribute("sf-bound");if(void 0===typeof self.root[o][i])return void console.error('Cannot get reference for self.root["'+o+'"]["'+i+'"]');n["sf-bounded"]=i,n["sf-model"]=o,n.setAttribute("sf-bounded",""),n.removeAttribute("sf-bound"),"INPUT"===n.tagName||"TEXTAREA"===n.tagName?$.on(n,"keyup",inputBoundFunction):$.on(n,"change",inputBoundFunction)}},alreadyInitialized=!1;function DOMNodeRemoved(e){for(var t=$("[sf-controller]",e),r=0;r<t.length;r++)removeModelBinding(t[r].getAttribute("sf-controller"));!1!==e.hasAttribute("sf-controller")&&removeModelBinding(e.getAttribute("sf-controller"))}self.init=function(e){if(!alreadyInitialized||e){alreadyInitialized=!0,setTimeout(function(){alreadyInitialized=!1},50),e||(e=document.body),self.parsePreprocess(self.queuePreprocess(e)),bindInput(e);for(var t=$("[sf-repeat-this]",e),r=0;r<t.length;r++){var n=t[r];n.parentElement;if(n.parentNode.classList.contains("sf-virtual-list")){var o=document.createElement(n.tagName);o.classList.add("virtual-spacer");var i=o.cloneNode(!0);o.classList.add("ceiling"),n.parentNode.insertAdjacentElement("afterBegin",o),i.classList.add("floor"),n.parentNode.insertAdjacentElement("beforeEnd",i);var l=window.getComputedStyle(n),a=parseFloat(l.marginTop)+parseFloat(l.marginBottom);l=null,a=Math.ceil(n.offsetHeight+a)}var s=n.nextElementSibling;null!==s&&n!==s||(s=!1);var f=n.previousElementSibling;null!==f&&n!==f||(f=!1);var u=n.getAttribute("sf-repeat-this");n.removeAttribute("sf-repeat-this");var d=sf.controller.modelName(n);if(/sf-bind-key|sf-bind-list/.test(n.outerHTML))throw"Can't parse element that already bound";loopParser(d,n,u,e,n.parentNode),n.remove()}}},sf(function(){var e=function(e){var t=e.nodeName;"TEXT"!==t&&"#text"!==t&&"#comment"!==t&&DOMNodeRemoved(e)};if("function"==typeof MutationObserver&&MutationObserver.prototype.observe){var t=function(t){t.removedNodes.forEach(e)};new MutationObserver(function(e){bindingEnabled&&e.forEach(t)}).observe(document.body,{childList:!0,subtree:!0})}else document.body.addEventListener("DOMNodeRemoved",function(t){bindingEnabled&&e(t.target)})});var removeModelBinding=function(e){var t=self.root[e];if(void 0!==t){var r=t.sf$bindedKey,n=null;for(var o in r)if(delete r[o],void 0!==t[o]&&null!==t[o]){if(t[o].constructor===String||t[o].constructor===Number||t[o].constructor===Boolean);else{if(t[o].constructor!==Array)continue;t[o].$virtual&&(t[o].$virtual.destroy(),delete t[o].$virtual),n=t[o].splice("obtain"),delete t[o],t[o]=n}if(void 0!==Object.getOwnPropertyDescriptor(t,o)){n=t[o];delete t[o],t[o]=n}}}},dcBracket=/{{[\s\S]*?}}/,bindObject=function(e,t,r,n){e instanceof Node||(e=e[0]),processingElement=e,e.setAttribute("sf-bind-key",r);var o=sf.controller.modelName(e);if("attr"===n||!n)for(var i={},l=0;l<e.attributes.length;l++){var a=e.attributes[l].name;!1!==dcBracket.test(e.getAttribute(a))&&(i[a]=e.getAttribute(a),e.removeAttribute(a))}if("html"===n||!n)var s=e.cloneNode(!0).innerHTML;var f=function(){if("attr"===n||!n)for(var l in i)if(-1!==i[l].indexOf(r)){var a=dataParser(i[l],t,!1,o);"value"===l?e.value=a:e.setAttribute(l,a);break}if("html"===n||!n){a=uniqueDataParser(s,t,!1,o);a=dataParser(a,t,!1,o),e.textContent="",e.insertAdjacentHTML("afterBegin",a)}};if(void 0===t[r])throw"Property '"+r+"' was not found on '"+o+"' model";if(void 0===t.sf$bindedKey&&initBindingInformation(t),void 0===t.sf$bindedKey[r]){var u=t[r];Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:function(){return u},set:function(e){u=e;for(var n=t.sf$bindedKey[r],o=0;o<n.length;o++)n[o]();return u}}),t.sf$bindedKey[r]=[f]}else t.sf$bindedKey[r].push(f)};self.bindElement=function(e,t){var r=sf.controller.modelName(e),n=self.root[r];if(!n)return console.error("Model for "+r+" was not found while binding:",e);var o=e.outerHTML;if(/sf-bind-key|sf-bind-list/.test(o))throw"Can't parse element that already bound";"attr"===t&&(o=o.replace(e.innerHTML,""));for(var i=/{{([\s\S]*?)}}/g,l=self.modelKeys(n),a=l.length-1;a>=0;a--)n[l[a]]instanceof Function&&l.splice(a,1);for(var s,f=RegExp(sf.regex.strictVar+"("+l+")"+sf.regex.avoidQuotes+"\\b","g"),u=null;null!==(s=i.exec(o));)for(;null!==(u=f.exec(s[1]));)bindObject(e,n,u[1],t)},self.extractPreprocess=function(e,t,r){var n=e.outerHTML;n=n.split("#"+t).join("_model_");var o=(n=uniqueDataParser(n,null,t,r,"#noEval"))[1];n=dataParser(n[0],null,t,r,"#noEval",o),n=$.parseElement(n)[0];var i=self.queuePreprocess(n,!0),l=[];function a(e){for(var t=e.attributes,r=[],n=0;n<t.length;n++){var o=t[n].value.split("{{%=");if(1!==o.length){var i={direct:!1,name:t[n].name};""===o[0]&&2===o.length&&(i.direct=Number(o[1])||!1),r.push(i)}}return r}var s=a(n);0!==s.length&&l.push({nodeType:1,address:[0],attributes:s});for(var f=0;f<i.length;f++){var u={nodeType:i[f].nodeType,address:$.getSelector(i[f],!0)};if(1===u.nodeType)u.attributes=a(i[f]);else if(3===u.nodeType){var d=i[f].textContent;if(u.direct=!1,u.indexes=d.match(/(?<={{%%=)[0-9]+/gm),null!==u.indexes){if(u.indexes=u.indexes.map(Number),"\n"===(d=d.split(/{{%%=[0-9]+/gm))[0][0])for(var c=0;c<d.length;c++)d[c]=trimIndentation(d[c]).trim();i[f].textContent=0===d[0].search(/{{%%=[0-9]+/)?"":d.shift(),u.innerHTML=d}else delete u.indexes,""===(d=i[f].parentNode.innerHTML.split("{{%="))[0]&&2===d.length&&(u.direct=Number(d[1])||!1)}l.push(u)}return{html:n,parse:o,addresses:l}};var excludes=["HTML","HEAD","STYLE","LINK","META","SCRIPT","OBJECT","IFRAME"];function initBindingInformation(e){void 0===e.sf$bindedKey&&Object.defineProperty(e,"sf$bindedKey",{configurable:!0,enumerable:!1,writable:!0,value:{}})}self.queuePreprocess=function(e,t){void 0===t&&(t=!1);for(var r=(e||document.body).childNodes,n=[],o=r.length-1;o>=0;o--){var i=r[o];if(!1!==t||-1===excludes.indexOf(i.nodeName))if(1===i.nodeType){var l=i.attributes;if(l["sf-bind-key"]||l["sf-repeat-this"]||l["sf-bind-list"])continue;for(var a=0;a<l.length;a++)-1!==l[a].value.indexOf("{{")&&(!1===t&&i.setAttribute("sf-preprocess","attronly"),n.push(i));n=n.concat(self.queuePreprocess(i,t))}else if(3===i.nodeType){if(i.textContent=i.textContent,0===i.textContent.length){i.remove();continue}if(-1!==i.nodeValue.indexOf("{{")){if(!1===t){i.parentNode.setAttribute("sf-preprocess","");for(a=0;a<n.length;a++)n[a].removeAttribute("sf-preprocess");n.push(i.parentNode);break}n.push(i)}}}return n},self.parsePreprocess=function(e){for(var t=0;t<e.length;t++){var r=sf.controller.modelName(e[t]);if(e[t].removeAttribute("sf-preprocess"),!self.root[r])return console.error("Can't parse element because model for '"+r+"' was not found",e[t]);self.root[r];if(processingElement=e[t],/sf-bind-key|sf-bind-list/.test(e[t].innerHTML))return console.error("Can't parse element that already bound"),void console.log(processingElement.cloneNode(!0));e[t].hasAttribute("sf-bind")&&self.bindElement(e[t],e[t].getAttribute("sf-bind"));var n=uniqueDataParser(e[t].innerHTML,self.root[r],!1,r);e[t].innerHTML=dataParser(n,self.root[r],!1,r);for(var o=e[t].attributes,i=0;i<o.length;i++)if(-1!==o[i].value.indexOf("{{")){var l=o[i];l.value=dataParser(l.value,self.root[r],!1,r)}}}}(),sf.router=new function(){var e=this;e.loading=!1,e.enabled=!1,e.pauseRenderOnTransition=!1,e.currentPage=[];var t=!1,r="";function n(t){d?d=!1:(u=!0,e.goto(window.location.pathname))}e.init=function(n){if(!sf.loader.DOMWasLoaded)return sf(function(){e.init()});for(var o=$("[sf-controller], [sf-page]",n),i=0;i<o.length;i++)if(o[i].getAttribute("sf-controller")&&sf.controller.run(o[i].getAttribute("sf-controller")),o[i].getAttribute("sf-page")){var l=o[i].getAttribute("sf-page");a(l)}t=!0,r=window.location.pathname},e.enable=function(t){void 0===t&&(t=!0),e.enabled!==t&&(e.enabled=t,!0===t?($.on(document.body,"click","a[href]",e.load),window.addEventListener("popstate",n,!1)):($.off(document.body,"click","a[href]",e.load),window.removeEventListener("popstate",n,!1)))};var o={};e.before=function(e,t,r){o[e]||(o[e]=[]),void 0===r?-1===o[e].indexOf(t)&&o[e].push(t):o[e][r]=t};var i={};e.after=function(e,t,r){i[e]||(i[e]=[]),void 0===r?-1===i[e].indexOf(t)&&i[e].push(t):i[e][r]=t};var l=function(e){return sf.model.root[e]||(sf.model.root[e]={}),sf.model.root[e]||sf.controller.run(e),sf.model.root[e]},a=function(t){if(-1===e.currentPage.indexOf(t)&&e.currentPage.push(t),o[t])for(var r=0;r<o[t].length;r++)o[t][r](l)},s={loading:[],loaded:[],special:[],error:[]};e.on=function(e,t){-1===s[e].indexOf(t)&&s[e].push(t)},e.lazyViewPoint={},e.load=function(t){if(!0===e.enabled){var r=t.target;if(r.href&&history.pushState&&!r.hasAttribute("sf-router-ignore")){var n=r.href.replace(window.location.origin,"");if(-1===n.indexOf("//"))return t.preventDefault(),!e.goto(n)}}};var f=!1,u=!1,d=!1;e.goto=function(n,o,c){c=c?c.toUpperCase():"GET",o||(o={});for(var p=0;p<s.loading.length;p++)if(s.loading[p](n))return;window.location.pathname;return t=!1,f&&f.abort(),f=$.ajax({url:window.location.origin+n,method:c,data:Object.assign(o,{_scarlets:".dynamic."}),success:function(o){if(!t){!0,f=!1;var u=RegExp("\x3c!-- SF-Special:(.*?)--\x3e"+sf.regex.avoidQuotes,"gm").exec(o);if(u&&1!==u.length&&(u=u[1].split("--|&>").join("--\x3e"),!isEmptyObject(u=JSON.parse(u))))for(var c=0;c<s.special.length;c++)if(s.special[c](u))return;var p=!1,v=function(t){p=$.findOne(t);var r=$.findOne("[sf-page]",p);!function(t){if(-1===e.currentPage.indexOf(t)&&e.currentPage.splice(e.currentPage.indexOf(t),1),i[t])for(var r=0;r<i[t].length;r++)i[t][r](l)}(r?r.getAttribute("sf-page"):"/"),u&&u.title&&($("head > title").innerHTML=u.title),m=!0},m=!1;for(var h in e.lazyViewPoint){if(-1!==r.indexOf(h))for(var g in e.lazyViewPoint[h])if(-1!==r.indexOf(h)){v(e.lazyViewPoint[h][g]);break}if(m)break}if(!m&&(sf.router.lazyViewPoint["@default"]&&v(sf.router.lazyViewPoint["@default"]),!m))for(c=0;c<s.error.length;c++)s.error[c]('sf.router.lazyViewPoint["'+h+'"]["'+g+'"] was not found');p||(p=document.body),e.pauseRenderOnTransition&&e.pauseRenderOnTransition.css("display","none"),p.innerHTML=o,sf.model.init(p);var b=$("[sf-page]",p);for(c=0;c<b.length;c++)a(b[c].getAttribute("sf-page"));e.pauseRenderOnTransition&&e.pauseRenderOnTransition.css("display",""),function(e,t,r){for(var n=0;n<s.loaded.length;n++)s.loaded[n](e,t,r)}(r,n,p),t=!0,!1,r=n,d=!1}},error:function(e,t){if(d=!0,!e.aborted){f=!1;for(var r=0;r<s.error.length;r++)s.error[r](e.status,t);window.history.back()}}}),u||window.history.pushState(null,"",n),u=!1,!0}},sf.internal.virtual_scroll=new function(){var e=this,t=!1,r=!1;function n(t,r,n,o){var i=Math.floor(e.prepareCount/2);if(t<e.prepareCount)return r.ceiling=-1,r.floor=o.children[2*e.prepareCount+1],void(void 0!==r.floor?r.floor=r.floor.offsetTop:r.floor=o.lastElementChild.offsetTop+1e3);void 0!==o.children[i+1]&&(r.ceiling=o.children[i+1].offsetTop),void 0!==n.$virtual.preparedLength&&t>=n.length-n.$virtual.preparedLength?r.floor=n.$virtual.dCursor.floor.offsetTop+2*n.$virtual.scrollHeight:(r.floor=o.children[e.prepareCount+3].offsetTop,o.hasAttribute("scroll-reduce-floor")&&(r.floor-=o.getAttribute("scroll-reduce-floor"),r.ceiling-=o.getAttribute("scroll-reduce-floor")))}function o(e,t,o,i,l,a){var s=t.$virtual,f=0;if(e>=t.length-s.preparedLength&&(f-=o,e=t.length-s.preparedLength),!(e-s.DOMCursor==0||e>=t.length)){if(r=!0,0===s.DOMCursor&&e<o+o/2||s.DOMCursor+o/2>e&&s.DOMCursor+o<e)l.scrollTop=i.children[e-s.DOMCursor+1].offsetTop;else{for(var u=null,d=s.dCursor.ceiling,c=s.dCursor.floor,p=s.vCursor,v=i.childElementCount-2,m=0;m<v;m++)u=d.nextElementSibling,null===p.floor?(s.dom.insertAdjacentElement("beforeEnd",u),m===v-1&&(p.floor=u)):p.floor.insertAdjacentElement("beforeBegin",u);e>=o?e<t.length-s.preparedLength&&(e-=o):(f=o-e,s.DOMCursor=e=0);var h=s.preparedLength<=t.length?s.preparedLength:t.length;for(m=0;m<h&&void 0!==(u=s.dom.children[e]);m++)c.insertAdjacentElement("beforeBegin",u);s.DOMCursor=e,p.floor=s.dom.children[e]||null,p.ceiling=p.floor?p.floor.previousElementSibling:null,a&&a(e),n(e,s.bounding,t,i),void 0!==(u=i.children[o-f+1])&&(l.scrollTop=u.offsetTop-l.offsetTop)}r=!1}}function i(e){e.style.overflow="hidden",setTimeout(function(){e.style.overflow=""},50)}function l(e){var t=window.getComputedStyle(e),r=parseInt(t.marginTop)+parseInt(t.marginBottom);return e.offsetHeight+r||0}function a(e,t,r,i,l,a,s){var f=t.$virtual.DOMCursor,u=0;if(e){var d=-1,c=t.$virtual.preparedLength;do{d++}while(d<c&&i.children[d].offsetTop<l.scrollTop);(f+=d)>0&&(f-=1),u=l.scrollTop-i.children[d].offsetTop}if(e||i.childElementCount-2>t.$virtual.preparedLength){t.$virtual.DOMCursor=t.length;var p=f;e||(p=f<=r?f:f+r),o(p,t,r,i,l,s),l.scrollTop+=u}s&&s(f),a&&a(),n(f,t.$virtual.bounding,t,i)}e.prepareCount=4,e.handle=function(u,d,c){t||(!function(){var e=document.getElementById("sf-styles");e||((e=document.createElement("style")).id="sf-styles",document.head.appendChild(e));e.sheet.insertRule(".sf-virtual-list .virtual-spacer{visibility: hidden;position: relative;height: 1px;transform-origin: 0 0;width: 1px;margin: 0;padding: 0;background: none;border: none;box-shadow: none;}")}(),t=!0),u.$virtual.elements=function(){return function(e,t){for(var r=[],n=void 0,o=e.$virtual.DOMCursor,i=0;i<o&&void 0!==(n=e.$virtual.dom.children[i]);i++)r.push(n);o=t.childElementCount-2;for(var i=1;i<=o&&void 0!==(n=t.children[i]);i++)r.push(n);o=e.length-o-e.$virtual.DOMCursor;for(var i=0;i<o&&void 0!==(n=e.$virtual.dom.children[e.$virtual.DOMCursor+i]);i++)r.push(n);return r}(u,c)},u.$virtual.dCursor={ceiling:c.querySelector(".virtual-spacer.ceiling"),floor:c.querySelector(".virtual-spacer.floor")},u.$virtual.bounding={ceiling:-1,floor:0},u.$virtual.vCursor={ceiling:null,floor:null},u.$virtual.targetNode=c,u.$virtual.DOMCursor=0,u.$virtual.scrollHeight=u.$virtual.dCursor.floor.offsetTop-u.$virtual.dCursor.ceiling.offsetTop;var p=null;u.$virtual.destroy=function(){$.off(p,"scroll"),$.off(c,"mousedown mouseup"),u.$virtual.dom.innerHTML="",function(e){for(var t=s.length-1;t>=0;t--)s[t].element===e&&s.splice(t,1)}(c),delete u.$virtual},u.$virtual.resetViewport=function(){u.$virtual.visibleLength=Math.floor(p.clientHeight/u.$virtual.scrollHeight),u.$virtual.preparedLength=u.$virtual.visibleLength+2*e.prepareCount},setTimeout(function(){p=c;for(var t=c.getAttribute("scroll-parent-index")||0,d=0;d<t;d++)p=p.parentElement;u.$virtual.resetViewport(),c.classList.contains("sf-list-dynamic")?function(t,i,u,d){var c=t.$virtual,p=c.dCursor.ceiling,v=c.dCursor.floor,m=c.vCursor;m.floor=c.dom.firstElementChild,c.scrollTo=function(r){o(r,t,e.prepareCount,u,d)},c.refresh=function(r){a(r,t,e.prepareCount,u,d)},E(),c.visibleLength=u.childElementCount-2,c.preparedLength=c.visibleLength+2*e.prepareCount;for(var h=0;h<e.prepareCount;h++){var g=m.floor;if(null===g)break;m.floor=g.nextElementSibling,v.insertAdjacentElement("beforeBegin",g)}c.DOMCursor=0;var b=0,y=0;function E(){for(var e=c.preparedLength-(u.childElementCount-2),t=0;t<e&&null!==(g=null===m.ceiling?c.dom.firstElementChild:m.ceiling.nextElementSibling);t++)m.floor=g.nextElementSibling,v.insertAdjacentElement("beforeBegin",g)}var C=c.bounding;n(0,C,t,u);var x=!1;$.on(d,"scroll",function(){if(x||r)return;x=!0,d.scrollTop<C.ceiling?(!function(){for(var r=null,n=!1,o=0;o<e.prepareCount&&null!==(r=null===m.floor?c.dom.lastElementChild:m.floor.previousElementSibling);o++)m.ceiling=r.previousElementSibling,c.DOMCursor--,p.insertAdjacentElement("afterEnd",r),b>0&&(b-=l(r)),c.DOMCursor<e.prepareCount&&!n&&(o=0,n=!0,r=null);(b<0||null===r)&&(b=0);for(var i=u.childElementCount-2-t.$virtual.preparedLength,o=0;o<i;o++)r=v.previousElementSibling,y+=l(r),null===m.floor?c.dom.insertAdjacentElement("beforeEnd",r):m.floor.insertAdjacentElement("beforeBegin",r),m.floor=r;null===m.floor?m.ceiling=c.dom.lastElementChild:m.ceiling=m.floor.previousElementSibling;p.style.height=b+"px",v.style.height=y+"px"}(),n(c.DOMCursor,C,t,u)):d.scrollTop>C.floor&&(!function(){var r=null;E(),null===m.ceiling&&(m.ceiling=m.floor.previousElementSibling);for(var n=0;n<e.prepareCount&&null!==(r=m.floor);n++)m.floor=r.nextElementSibling,v.insertAdjacentElement("beforeBegin",r),y>0&&(y-=l(r));(y<0||null===r)&&(y=0);for(var o=u.childElementCount-2-t.$virtual.preparedLength,n=0;n<o;n++)r=p.nextElementSibling,b+=l(r),c.DOMCursor++,null===m.ceiling?c.dom.insertAdjacentElement("afterBegin",r):m.ceiling.insertAdjacentElement("afterEnd",r),m.ceiling=r;null===m.ceiling?m.floor=c.dom.firstElementChild:m.floor=m.ceiling.nextElementSibling;p.style.height=b+"px",v.style.height=y+"px"}(),n(c.DOMCursor,C,t,u));x=!1}),function(e,t){-1===f&&(f=setInterval(function(){for(var e=null,t=s.length-1;t>=0;t--)(e=s[t]).element.scrollHeight!==e.height&&e.element.scrollWidth!==e.width&&(null!==e.element.parentElement?e.callback():s.splice(t,1));0===s.length&&(clearInterval(f),f=-1)},200));s.push({element:e,callback:t,height:e.scrollHeight,width:e.scrollWidth})}(u,function(){n(c.DOMCursor,C,t,u)})}(u,0,c,p):function(t,l,s,f){for(var u=t.$virtual,d=u.dCursor.ceiling,c=u.dCursor.floor,p=u.preparedLength<=t.length?u.preparedLength:t.length,v=0;v<p&&null!==u.dom.firstElementChild;v++)c.insertAdjacentElement("beforeBegin",u.dom.firstElementChild);function m(r){if(r>=e.prepareCount)d.style.height=(r-e.prepareCount)*u.scrollHeight+"px",c.style.height=(t.length-u.preparedLength-r)*u.scrollHeight+"px";else{d.style.height=r*u.scrollHeight+"px";var n=t.length-u.preparedLength;c.style.height=(n||0)*u.scrollHeight+"px"}}var h=u.bounding;m(0),n(e.prepareCount,h,t,s),h.ceiling=-1,u.offsetTo=function(e){return e*u.scrollHeight+d.offsetTop},u.vCursor.floor=u.dom.firstElementChild,u.scrollTo=function(r){o(r,t,e.prepareCount,s,f,m)},u.refresh=function(r){a(r,t,e.prepareCount,s,f,E,m)};var g=!1,b=!0,y=!1;function E(){if(g||r||f.scrollTop>=h.ceiling&&f.scrollTop<=h.floor)y&&(0!==f.scrollTop&&f.scrollTop!==f.scrollHeight-f.clientHeight||(i(f),y=!1));else{var o=Math.floor(f.scrollTop/u.scrollHeight);o+u.preparedLength>t.length&&(o=t.length-u.preparedLength),b&&(o<2*e.prepareCount&&(o-=e.prepareCount),y&&(i(f),y=!1),b=!1),o<e.prepareCount&&(o=0,b=!0),g=!0;var l=o-u.DOMCursor;o+l>=t.length&&(l=o+l-t.length),0!==l?(u.DOMCursor=o,function(e,t){var r=t.$virtual.dom,n=t.$virtual.vCursor,o=t.$virtual.dCursor;if(e>0){for(var i=0,l=0;l<e;l++)i=null===n.ceiling?r.firstElementChild:n.ceiling.nextElementSibling,o.floor.insertAdjacentElement("beforeBegin",i);for(var l=e;l>0;l--)null===n.ceiling?(n.ceiling=o.ceiling.nextElementSibling,r.insertAdjacentElement("afterBegin",n.ceiling)):(i=o.ceiling.nextElementSibling,n.ceiling.insertAdjacentElement("afterEnd",i),n.ceiling=i);n.floor=n.ceiling.nextElementSibling}else if(e<0){var i=0;e=-e;for(var l=0;l<e;l++)i=null===n.floor?r.lastElementChild:n.floor.previousElementSibling,o.ceiling.insertAdjacentElement("afterEnd",i);for(var l=0;l<e;l++)null===n.floor?(n.floor=o.floor.previousElementSibling,r.insertAdjacentElement("beforeEnd",n.floor)):(i=o.floor.previousElementSibling,n.floor.insertAdjacentElement("beforeBegin",i),n.floor=i);n.ceiling=n.floor.previousElementSibling}}(l,t),m(o),n(o,h,t,s),g=!1):g=!1}}$.on(f,"scroll",E),f===s&&-1!==navigator.userAgent.indexOf("Chrom")&&($.on(s,"mousedown",function(){y=!0}),$.on(s,"mouseup",function(){y=!1}))}(u,0,c,p)},500)};var s=[],f=-1},sf});
//# sourceMappingURL=scarletsframe.min.js.map
