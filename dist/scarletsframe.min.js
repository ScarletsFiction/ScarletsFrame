/*
  ScarletsFrame
  A frontend library for Scarlets Framework that support
  lazy page load and element binding that can help
  simplify your code

  https://github.com/ScarletsFiction/ScarletsFrame
*/
!function(global,factory){function routerEval(code){eval(code)}"object"==typeof exports&&"void 0"!=typeof module?module.exports=factory(global,routerEval):global.sf=factory(global,routerEval)}("void 0"!=typeof window?window:this,function(window,routerEval){"use strict";void 0===typeof document&&(document=window.document);var internal={},sf=function(e){return e.constructor===Function?sf.loader.onFinish.apply(null,arguments):void 0!==e.tagName?sf.model.root[sf.controller.modelName(e)]:void 0};sf.internal={},sf.regex={getQuotes:/(['"])(?:\1|[\s\S]*?[^\\]\1)/g,validFunctionCall:/[a-zA-Z0-9 \]\$\)]/,strictVar:"(?=\\b[^.]|^|\\n| +|\\t|\\W )",escapeHTML:/(?!&#.*?;)[\u00A0-\u9999<>\&]/gm,uniqueDataParser:/{{((@|#[\w])[\s\S]*?)}}/g,dataParser:/{{([^@%][\s\S]*?)}}/g,arrayItemsObserve:/\b_model_\.([a-zA-Z0-9.['\]]+)(?:$|[^'\]])/g};var allowedFunctionEval={for:!0,if:!0,while:!0,"_content_.take":!0,"console.log":!0};function avoidQuotes(e,t,r){var n=[],o="<%$@>";if(void 0===r){e=t(e=e.replace(sf.regex.getQuotes,function(e){return n.push(e),o+(n.length-1)+o}));for(var i=0;i<n.length;i++)e=e.replace(o+i+o,n[i]);return e}t(e.replace(sf.regex.getQuotes,"<%$@>"))}function isEmptyObject(e){for(var t in e)return!1;return!0}function compareObject(e,t){if(!e||!t)return!1;for(var r in e)if("object"!=typeof e[r]&&e[r]!==t[r])return!1;return!0}function hiddenProperty(e,t,r){Object.defineProperty(e,t,{enumerable:!1,configurable:!0,value:r})}function deepProperty(e,t){for(var r=0;r<t.length;r++)if(void 0===(e=e[t[r]]))return e;return e}function capitalizeLetters(e){for(var t=0;t<e.length;t++)e[t]=e[t][0].toUpperCase()+e[t].slice(1);return e.join("")}"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert void 0 or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var o=arguments[n];if(null!=o)for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(r[i]=o[i])}return r},writable:!0,configurable:!0}),void 0===console.group&&(console.group=console.groupCollapsed=console.groupEnd=function(){}),void 0!==Element.prototype.remove&&void 0!==CharacterData.prototype.remove&&void 0!==DocumentType.prototype.remove||[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})}),Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),r=t.length;--r>=0&&t.item(r)!==this;);return r>-1}),NodeList.prototype.forEach||(NodeList.prototype.forEach=function(e,t){t=t||window;for(var r=0;r<this.length;r++)e.call(t,this[r],r,this)}),window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),Object.values||(Object.values=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);return t}),void 0===Object.setPrototypeOf&&(Object.setPrototypeOf=function(e,t){return e.__proto__=t,e});var Reflect_Construct=null;Reflect_Construct="undefined"!=typeof Reflect?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(o,r.prototype),o},sf.dom=function(e,t){return"<"===e[0]?sf.dom.parseElement(e):e.constructor!==String?e:t?t.querySelectorAll(e):document.querySelectorAll(e)};var $=sf.dom;!function(){var e=sf.dom;e.findOne=function(e,t){return void 0!==t?t.querySelector(e):document.querySelector(e)},e.parent=function(e,t){if(e.closest)return e.closest(t);do{if(!0===e.matches(t))return e;e=e.parentElement}while(null!==e);return null},e.prevAll=function(e,t,r){var n=[],o=null===t||t.constructor!==String;for(e=r?e.nextSibling:e.previousSibling;null!==e;){if(!1===o&&!0===e.matches(t))n.push(e);else{if(e===t)break;n.push(e)}e=r?e.nextSibling:e.previousSibling}return n},e.nextAll=function(t,r){return e.prevAll(t,r,!0)},e.on=function(t,r,n,o,i){if("string"==typeof t&&(t=document,o=n,n=r,r=t),"function"==typeof n&&(o=n,n=null),n){var l=o;o=function(t){null!==e.parent(t.target,n)&&l(t)}}o.selector=n,o.once=i,t.addEventListener(r,o,{capture:!0,once:!0===i}),void 0===t.sf$eventListener&&(t.sf$eventListener={}),void 0===t.sf$eventListener[r]&&(t.sf$eventListener[r]=[]),t.sf$eventListener[r].push(o)},e.once=function(t,r,n,o){e.on(t,r,n,o,!0)},e.off=function(t,r,n){if(void 0!==r){if(1===(l=r.split(" ")).length){if(void 0!==t.sf$eventListener){var o=t.sf$eventListener;if(void 0!==o&&void 0!==o[r])for(i=o[r].length-1;i>=0;i--)n&&o[r][i].selector!==n||t.removeEventListener(r,o[r].splice(i,1),!0)}}else for(var i=0;i<l.length;i++)e.off(t,l[i])}else{if(void 0===t.sf$eventListener)return;for(var l=t.sf$eventListener[r],i=0;i<l.length;i++)e.off(t,l[i])}},e.animateCSS=function(e,t,r,n){var o={animation:"animationend",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var i in o)if(void 0!==e.style[i]){o=o[i];break}n&&(e.style.webkitAnimationDuration=n+"s",e.style.animationDuration=n+"s");var l=("animated "+t).split(" ");e.classList.add.apply(e.classList,l),$.once(e,o,function(){e.classList.remove.apply(e.classList,l),n&&setTimeout(function(){e.style.webkitAnimationDuration=n+"s",e.style.animationDuration=n+"s"},1),"function"==typeof r&&r()})};var t={div:document.createElement("div"),ul:document.createElement("ul"),tbody:document.createElement("tbody"),tr:document.createElement("tr"),table:document.createElement("table"),select:document.createElement("select")};e.parseElement=function(e,r){var n=[],o=t.div;0===e.indexOf("<li")&&(o=t.ul),0===e.indexOf("<tr")&&(o=t.tbody),0!==e.indexOf("<td")&&0!==e.indexOf("<th")||(o=t.tr),0===e.indexOf("<tbody")&&(o=t.table),0===e.indexOf("<option")&&(o=t.select),o.textContent="",o.insertAdjacentHTML("afterBegin",e);for(var i=o[r?"childNodes":"children"],l=0;l<i.length;l++)n.push(i.item(l));return n},e.escapeText=function(e){var r=t.div;return r.textContent=e,r.innerHTML},e.remove=function(e){if(void 0!==e.remove)return e.remove();for(var t=0;t<e.length;t++)e[t].remove()};var r=null;setTimeout(function(){sf.loader.domReady(function(){r=document.body.parentElement})},1);var n=/[~`!@#$%^&*()+={}|[\]\\:";'<>?,.\/ ]/;e.getSelector=function(e,t,o){var i=[];void 0===o&&(o=r);for(var l=t?"previousSibling":"previousElementSibling";null!==e.parentNode;){if(e.id&&!n.test(e.id)){i.unshift("#"+e.id);break}if(e===o)void 0===t?i.unshift(e.tagName):i.unshift(0);else{for(var a=e,s=t?0:1;a[l];)a=a[l],s++;t?i.unshift(s):i.unshift(":nth-child("+s+")")}if(null===(e=e.parentNode))break}return t?i:i.join(" > ")},e.childIndexes=function(e,t){var n=t||r,o=1;if(e[0].constructor===String&&n.id!==e[0].substr(1))n=n.querySelector(e[0]);else if(1===e.length)return n;for(o=o;o<e.length;o++)if(null===(n=n.childNodes.item(e[o])))return null;return n},internal.dom={},internal.dom.extends_Dom7={push:function(e){this[this.length]=e,this.length++},indexOf:function(e){for(var t=Object.keys(this),r=0;r<t.length;r++)if(this[t[r]]===e)return r;return-1},splice:function(e){for(var t=this.length-1;e<t;e++)delete this[e],this[e]=this[e+1];this.length--}}}(),sf.loader=new function(){var e=this;e.loadedContent=0,e.totalContent=0,e.DOMWasLoaded=!1,e.DOMReady=!1,e.turnedOff=!0;var t=[],r=[],n=[];e.off=function(){e.turnedOff=!0},e.onFinish=function(t){if(e.DOMWasLoaded)return t();-1===r.indexOf(t)&&r.push(t)},e.domReady=function(r){if(e.DOMReady)return r();-1===t.indexOf(r)&&t.push(r)},e.onProgress=function(t){if(e.DOMWasLoaded)return t(e.loadedContent,e.totalContent);-1===n.indexOf(t)&&n.push(t)},e.f=function(t){e.loadedContent++;for(var r=0;r<n.length;r++)n[r](e.loadedContent,e.totalContent)},e.css=function(t){if(e.DOMWasLoaded){for(var r=t.length-1;r>=0;r--)0!==$('link[href*="'+t[r]+'"]').length&&t.splice(r,1);if(0===t.length)return}e.turnedOff=!1,e.totalContent=e.totalContent+t.length;for(r=0;r<t.length;r++){var n=document.createElement("link");n.rel="stylesheet",n.href=t[r],n.addEventListener("load",sf.loader.f,{once:!0}),n.addEventListener("error",sf.loader.f,{once:!0}),document.head.appendChild(n)}},e.js=function(t){if(e.DOMWasLoaded){for(var r=t.length-1;r>=0;r--)0!==$('script[src*="'+t[r]+'"]').length&&t.splice(r,1);if(0===t.length)return}e.turnedOff=!1,e.totalContent=e.totalContent+t.length;for(r=0;r<t.length;r++){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=t[r],n.addEventListener("load",sf.loader.f,{once:!0}),n.addEventListener("error",sf.loader.f,{once:!0}),document.head.appendChild(n)}},setTimeout(function(){0!==e.totalContent||e.turnedOff||(e.loadedContent=e.totalContent=1,console.warn("If you don't use content loader feature, please turn it off with `sf.loader.off()`"))},1e4);var o=!1;document.addEventListener("load",function e(t){!1===o&&document.body&&(document.removeEventListener("load",e,!0),0===(o=sf.model.queuePreprocess(document.body)).length&&(o=!1))},!0),document.addEventListener("readystatechange",function r(){if("interactive"===document.readyState||"complete"===document.readyState){if(!1===e.DOMReady){e.DOMReady=!0;for(var n=0;n<t.length;n++)try{t[n]()}catch(e){console.error(e)}}!1===o&&(o=sf.model.queuePreprocess(document.body)),i=setInterval(l,100),document.removeEventListener("readystatechange",r,!0)}},!0);var i=-1;function l(){if(!(!1===e.turnedOff&&e.loadedContent<e.totalContent)){clearInterval(i);for(var l=sf.dom("script, link, img"),a=0;a<l.length;a++)l[a].removeEventListener("error",sf.loader.f),l[a].removeEventListener("load",sf.loader.f);e.DOMWasLoaded=!0;var s=Object.keys(internal.modelPending);for(a=0;a<s.length;a++){var u=internal.modelPending[s[a]];if(void 0===sf.model.root[s[a]])var f=sf.model.root[s[a]]={};else f=sf.model.root[s[a]];for(var d=0;d<u.length;d++)u[d](f,root_);delete internal.modelPending[s[a]]}for(a=internal.controller.pending.length-1;a>=0;a--){void 0!==(f=sf.controller.pending[internal.controller.pending[a]])&&(f(root_(internal.controller.pending[a]),root_),internal.controller.pending.splice(a,1))}for(a=0;a<r.length;a++)try{r[a]()}catch(e){console.error(e)}n.splice(0),t.splice(0),r.splice(0),t=r=null,sf.controller.init(),sf.model.init(document.body,o),o=null}}},sf.prototype.constructor=sf.loader.onFinish,sf.component=new function(){var self=this,scope=internal.component={};self.registered={},self.available={};var bases={},events={};self.for=function(e,t,r){if(!sf.loader.DOMWasLoaded)return sf(function(){self.for(e,t)});void 0===self.registered[e]&&(self.registered[e]=[t,sf.controller.pending[e],0,!1,r]),self.registered[e][0]=t,delete sf.controller.pending[e],defineComponent(e)},self.event=function(e,t){events[e]=t},self.base=function(e,t){bases[e]=t},self.html=function(e,t){if(!sf.loader.DOMWasLoaded)return sf(function(){self.html(e,t)});void 0===self.registered[e]&&(self.registered[e]=[!1,!1,0,!1]);var r=$.parseElement(t);if(1!==r.length){var n=document.createElement("div");n.tempDOM=!0;for(var o=0;o<r.length;o++)n.appendChild(r[o]);self.registered[e][3]=n}else self.registered[e][3]=r[0]},scope.triggerEvent=function(e,t,r){void 0!==events[e]&&void 0!==events[e][t]&&events[e][t](r,t)};var tempDOM=document.createElement("div");function componentInit(e,t,r){e.setAttribute("sf-controller",""),e.sf$component=t,e.sf$componentFrom=r}self.new=function(e,t,r,n,o){if(!0===n){if(!1===sf.loader.DOMWasLoaded)return sf(function(){self.new(e,t,r,n,!1)});if(0===t.childElementCount&&!1===self.registered[e][3])return setTimeout(function(){self.new(e,t,r,n,!0)},0);if(!0===t.hasAttribute("sf-component-ignore"))return;for(var i=/(^|:)(class|style)/,l=t.attributes,a=0;a<l.length;a++)i.test(l[a].nodeName)||(r[l[a].nodeName]=l[a].value)}var s=void 0===t;if(void 0===t){if(!1===self.registered[e][3])return void console.error("HTML content for '"+e+"' was not defined");t=self.registered[e][3].cloneNode(!0)}var u=e+"@"+self.registered[e][2]++;void 0===self.available[e]&&(self.available[e]=[]),self.available[e].push(u);var f=sf.model.root[u]={};self.registered[e][0](f,sf.model,r,t);var d=self.registered[e][4];if(void 0!==d)if(d.constructor===Array)for(a=0;a<d.length;a++){if(void 0===bases[d[a]])return console.error("'"+d[a]+"' base is not found");bases[d[a]](f,sf.model,r,t)}else{if(void 0===bases[d])return console.error("'"+d+"' base is not found");bases[d](f,sf.model,r,t)}if(self.registered[e][1]&&self.registered[e][1](f,sf.model,r,t),scope.triggerEvent(e,"created",f),!0!==s&&!0!==n)return componentInit(t,u,e),t.model=sf.model.root[u],u;if(0===t.childElementCount){var c=self.registered[e][3];if(!0===c.tempDOM){a=0;for(var p=(c=c.cloneNode(!0).childNodes).length;a<p;a++)t.appendChild(c[0])}else t.appendChild(c.cloneNode(!0))}return null===t.parentNode?(tempDOM.appendChild(t),componentInit(t,u,e),sf.model.init(t),(t=tempDOM.firstElementChild).remove()):!0===n&&(componentInit(t,u,e),sf.model.init(t)),t.model=sf.model.root[u],t.destroy=function(){null===this.parentElement?internal.model.DOMNodeRemoved(this):this.remove()},t};var HTMLElement=window.HTMLElement,customElements=window.customElements,HTMLElement_wrap=function(e){function t(){return Reflect_Construct(e,arguments,Object.getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(t,e)}(HTMLElement);function defineComponent(name){if(!customElements.get(name)){name=name.replace(/[^\w-]+/g,"");var tagName=name;if(name=name.split("-"),1===name.length)return console.error("Please use '-' when defining component tags");name=capitalizeLetters(name);var func=eval("function "+name+"($item){var he = HTMLElement_wrap.call(this);self.new(tagName, he, $item, true, false);return he}"+name);func.prototype=Object.create(HTMLElement.prototype),func.prototype.constructor=func,func.__proto__=HTMLElement,func.prototype.connectedCallback=function(){scope.triggerEvent(name,"connected",this)};try{customElements.define(tagName,func)}catch(e){console.error(e)}window["$"+name]=func}}},sf.model=function(e){if(void 0!==sf.component.registered[e])return root_(e);sf.model.root[e]||(sf.model.root[e]={},internal.controller.pending.push(e));var t=internal.modelPending[e];if(t){for(var r=sf.model.root[e],n=0;n<t.length;n++)t[n](r,sf.model);t=internal.modelPending[e]=!1}for(n=internal.controller.pending.length-1;n>=0;n--){void 0!==(e=sf.controller.pending[internal.controller.pending[n]])&&(e(root_(internal.controller.pending[n]),root_),internal.controller.pending.splice(n,1))}return sf.controller.pending[e]&&sf.controller.run(e),sf.model.root[e]},function(){var self=sf.model,scope=internal.model={},bindingEnabled=!1;self.root={},internal.modelPending={};var processingElement=null;function trimIndentation(e){var t=e.split("\n",3);return void 0===(t=" "!==t[0][0]||"\t"!==t[0][0]?t[1]:t[0])?e:0===(t=t.length-t.trim().length)?e:e.replace(RegExp("^([\\t ]{"+t+"})","gm"),"")}var bracketMatch=/([\w.]*?[\S\s])\(/g,chackValidFunctionCall=sf.regex.validFunctionCall,localEval=function(script,_model_,_modelScope,_content_){var preventExecution=!1;if(avoidQuotes(script,function(e){for(var t=null;null!==(t=bracketMatch.exec(e));)if(t[1]=t[1].trim(),!allowedFunctionEval[t[1]]&&"_modelScope"!==t[1].split(".")[0]&&-1===e.indexOf("var "+t[1])&&-1===e.indexOf("let "+t[1])){bracketMatch.lastIndex=0,preventExecution=t[1];break}},!0),preventExecution)return console.groupCollapsed("%c<-- Expand the template error","color: yellow"),console.log(trimIndentation(processingElement.outerHTML).trim()),console.log("%c"+trimIndentation(script).trim(),"color: yellow"),console.groupEnd(),console.error("Trying to executing unrecognized function ("+preventExecution+")"),"#TemplateError";var _result_="";try{if(!0===/@return /.test(script)){var _evaled_=eval("(function(){"+script.split("@return ").join("return ")+"})()");return void 0===_evaled_?_result_+"undefined":null===_evaled_?_result_+"null":void 0!==_evaled_.onclick?_evaled_:_result_+_evaled_}var _evaled_=eval(script)}catch(e){return console.groupCollapsed("%c<-- Expand the template error","color: yellow"),console.log(trimIndentation(processingElement.outerHTML).trim()),console.log("%c"+trimIndentation(script).trim(),"color: yellow"),console.groupEnd(),console.error(e),"#TemplateError"}return""!==_result_?_result_:_evaled_};function escapeEscapedQuote(e){return e.split('\\"').join("\\$%*").split("\\'").join("\\%$*")}function unescapeEscapedQuote(e){return e.split("\\$%*").join('\\"').split("\\%$*").join("\\'")}function elseIfHandle(e,t){for(var r=e.elseIf,n=0;n<r.length;n++)if(t[0]=r[n][0],localEval.apply(self.root,t))return t[0]=r[n][1],localEval.apply(self.root,t);return null===e.elseValue?"":(t[0]=e.elseValue,localEval.apply(self.root,t))}self.index=function(e){!1===e.hasAttribute("sf-bind-list")&&(e=sf.dom.parent(e,"[sf-bind-list]"));for(var t=-1,r=e.tagName,n=e;null!==e;)e.tagName===r&&t++,e=e.previousElementSibling;var o=n.getAttribute("sf-bind-list");if(!o)return t;var i=self.root[sf.controller.modelName(n)][o];return i.$virtual?t+i.$virtual.DOMCursor-1:t},self.for=function(e,t){if(!sf.loader.DOMWasLoaded)return void 0===internal.modelPending[e]&&(internal.modelPending[e]=[]),!1===internal.modelPending[e]?t(self(e),self):internal.modelPending[e].push(t);t(self(e),self)},self.modelKeys=function(e){for(var t=Object.keys(e),r=t.length-1;r>=0;r--)-1!==t[r].indexOf("$")&&t.splice(r,1);return t};var templateParser_regex=/{{%=([0-9]+)/gm,REF_DIRECT=0,REF_IF=1,REF_EXEC=2,templateExec=function(e,t,r){for(var n={},o=null,i=0;i<e.length;i++)if(void 0===r||-1!==r.indexOf(i)){var l=e[i];if(l.data[1]=t,l.type!==REF_DIRECT)if(l.type!==REF_EXEC){if(l.type===REF_IF){var a=l.data;if(n[i]={type:l.type,data:""},a[0]=l.if[0],!localEval.apply(self.root,a)){n[i].data=elseIfHandle(l,a);continue}a[0]=l.if[1],n[i].data=localEval.apply(self.root,a)}}else n[i]={type:l.type,data:localEval.apply(self.root,l.data)};else void 0===(o=localEval.apply(self.root,l.data))?console.error("`"+l.data[0]+"` was not defined"):(o.constructor===Object&&(o=JSON.stringify(o)),o.constructor!==String&&(o=String(o))),n[i]={type:l.type,data:o}}return n},templateParser=function(e,t,r){if(void 0!==e.component)return(n=new e.component(t)).setAttribute("sf-bind-list",e.list),n;processingElement=e.html;var n=!0===r?e.html:e.html.cloneNode(!0),o=e.addresses,i=templateExec(e.parse,t);n.model=t;for(var l=[],a=[],s=0;s<o.length;s++){var u=o[s],f=$.childIndexes(u.address,n);if(1!==u.nodeType){if(3===u.nodeType){c=f;if(l.push({textContent:c,ref:u}),void 0!==u.direct){c.textContent=i[u.direct].data;continue}c.textContent=c.textContent.replace(templateParser_regex,function(e,t){return i[t].data})}if(-1===u.nodeType){var d={dynamicFlag:f,direct:u.parse_index,parentNode:f.parentNode,startFlag:u.startFlag&&$.childIndexes(u.startFlag,n)};l.push(d),a.push(d)}}else for(var c=u.attributes,p=0;p<c.length;p++){var v=c[p],h="value"===v.name&&("TEXTAREA"===f.tagName||"INPUT"===f.tagName&&!1===/checkbox|radio|hidden/.test(f.type));if(l.push({attribute:!0===h?f:f.attributes[v.name],ref:v}),void 0===v.direct)if("value"===v.name&&!0===h){var m=f.value;f.removeAttribute("value"),f.value=m,f.value=f.value.replace(templateParser_regex,function(e,t){return i[t].data})}else f.setAttribute(v.name,(v.value||f.value).replace(templateParser_regex,function(e,t){return i[t].data}));else{if("value"===v.name&&!0===h){f.value=i[v.direct].data,f.removeAttribute("value");continue}f.setAttribute(v.name,i[v.direct].data)}}}n.sf$elementReferences=l;for(s=0;s<a.length;s++){u=a[s];var g=i[u.direct].data;if(void 0===g.onclick){g=$.parseElement(i[u.direct].data,!0);for(p=0;p<g.length;p++)u.parentNode.insertBefore(g[p],u.dynamicFlag)}else u.parentNode.insertBefore(g,u.dynamicFlag)}return n};function syntheticCache(e,t,r){void 0===e.sf$cache&&(e.sf$cache={});for(var n=e.sf$cache,o=t.modelRef_array,i=0;i<o.length;i++){var l=o[i];n[l[0]]=deepProperty(r,l[1])}}function syntheticTemplate(e,t,r,n){var o=e.sf$cache,i=t.modelRef_array;if(void 0!==r){if(void 0===(s=t.modelReference[r])||0===s.length)return console.log(e,t,r,n),console.error("Failed to run syntheticTemplate because property '"+r+"' is not observed"),!1;if(o)for(var l=0;l<i.length;l++){if((u=i[l])[0]===r){var a=deepProperty(n,u[1]);o[u[0]]!==a&&(o[u[0]]=a)}}}else{var s=[];for(l=0;l<i.length;l++){var u=i[l];if(void 0!==o){a=deepProperty(n,u[1]);o[u[0]]!==a&&(Array.prototype.push.apply(s,t.modelReference[u[0]]),o[u[0]]=a)}else Array.prototype.push.apply(s,t.modelReference[u[0]])}if(0===s.length)return!1}var f=templateExec(t.parse,n,s);function d(e){for(var r=!1,o=0;o<e.length;o++)if(-1!==s.indexOf(e[o])){r=!0;break}if(!1===r)return!1;var i=[];for(o=0;o<e.length;o++)void 0===f[e[o]]&&i.push(e[o]);return Object.assign(f,templateExec(t.parse,n,i)),!0}var c=e.sf$elementReferences,p=!1;for(l=0;l<c.length;l++){var v=c[l];if(void 0===v.dynamicFlag)if(void 0===v.textContent){if(void 0!==v.attribute){if(void 0!==v.ref.parse_index){if(!0===d(v.ref.parse_index)){h=v.ref.value.replace(templateParser_regex,function(e,t){return f[t].data});if(v.attribute.value===h)continue;v.attribute.value=h,p=!0}continue}if(f[v.ref.direct]){m=f[v.ref.direct].data;if(v.attribute.value==m)continue;v.attribute.value=m,p=!0}}}else{if(void 0!==v.ref.parse_index){if(!0===d(v.ref.parse_index)){var h=v.ref.value.replace(templateParser_regex,function(e,t){return f[t].data});if(v.textContent.textContent===h)continue;v.textContent.textContent=h,p=!0}continue}if(f[v.ref.direct]){var m=f[v.ref.direct].data;if(v.textContent.textContent===m)continue;var g=v.textContent;if(!0===g.sf$haveChilds)for(;g.previousSibling&&g.previousSibling.sf$childRoot===g;)g.previousSibling.remove();g.textContent=m}}else if(void 0!==f[v.direct]){for(var b=$.parseElement(f[v.direct].data,!0).reverse(),y=$.prevAll(v.dynamicFlag,v.startFlag),E=!1,C=0;C<b.length;C++){if(void 0===y[C]){E=!0;break}!1===y[C].isEqualNode(b[C])&&v.parentNode.replaceChild(b[C],y[C])}if(E)for(C=b.length-1;C>=0;C--)v.parentNode.insertBefore(b[C],v.dynamicFlag);else for(C=b.length;C<y.length;C++)y[C].remove();p=!0}}return p}var dataParser=function(e,t,r,n,o,i){var l=self.root[n];o||(o="");var a=RegExp(sf.regex.strictVar+"("+self.modelKeys(l).join("|")+")\\b","g");if(r)var s=RegExp(sf.regex.strictVar+r+"\\.\\b","g");if(bindingEnabled=!0,"#noEval"===o)var u=[],f=i.length;var d=e.replace(sf.regex.dataParser,function(e,n){if(n=avoidQuotes(n,function(e){return e=e.split("&amp;").join("&").split("&lt;").join("<").split("&gt;").join(">"),r&&(e=e.replace(s,function(e){return"_model_."+e[0].slice(1)})),e.replace(a,function(e,t){return"_modelScope."+t})}).split("_model_._modelScope.").join("_model_.").split("._modelScope.").join("."),"#noEval"===o){n=n.trim();var d=u.indexOf(n);return-1===d?(u.push(n),i.push({type:REF_DIRECT,data:[n,t,l]}),"{{%="+(u.length+f-1)):"{{%="+(d+f)}return(n=""+localEval.apply(self.root,[o+n,t,l])).replace(sf.regex.escapeHTML,function(e){return"&#"+e.charCodeAt(0)+";"})});return"#noEval"===o&&(u=l=t=r=n=o=a=s=e=null,setTimeout(function(){d=null},1)),d},uniqueDataParser=function(e,t,r,n,o){var i={length:0,take:function(e,o){if(null===e)return dataParser(this[o],t,r,n);var i='"use strict";var ',l=!0;for(var a in e){if("string"==typeof e[a])e[a]='"'+e[a].split('"').join('\\"')+'"';else{if("_model_"===a){t=e[a];continue}"object"==typeof e[a]&&(e[a]=JSON.stringify(e[a]))}l||(i+=","),i+=a+" = "+e[a],l=!1}return!0===l&&(i=i.replace("var ","")),i=i.split("(").join("&#40;").split(")").join("&#41;"),dataParser(this[o],t,r,n,i+";")}};e=e.replace(/{\[([\s\S]*?)\]}/g,function(e,t){return!1===/{{.*?}}/.test(t)?"_result_ += '"+t.split("'").join("\\'")+"'":(i[i.length]=t,i.length++,"_result_ += _content_.take(&VarPass&, "+(i.length-1)+");")});var l=self.root[n],a=RegExp(sf.regex.strictVar+"("+self.modelKeys(l).join("|")+")\\b","g");if(r)var s=RegExp(sf.regex.strictVar+r+"\\.\\b","g");if("#noEval"===o)var u=[];var f=e.replace(sf.regex.uniqueDataParser,function(e,n){n=avoidQuotes(n,function(e){return e=e.split("&amp;").join("&").split("&lt;").join("<").split("&gt;").join(">"),r&&(e=e.replace(s,function(e){return"_model_."+e[0].slice(1)})),e.replace(a,function(e,t){return"_modelScope."+t})}).split("_model_._modelScope.").join("_model_.");for(var f=!1,d=/(var|let)([\w,\s]+)(?=\s(?==|in|of))/g,c=[],p=null;null!==(p=d.exec(n));)c.push(p[2]);if(null===t&&"#noEval"===o&&c.push("_model_"),0!==c.length){for(var v=[],h=0;h<c.length;h++)c[h].replace(/([\n\t\r]|  )+/g,"").split(",").forEach(function(e){v.push(e)});c=v;for(h=0;h<c.length;h++)c[h]+=":typeof "+c[h]+'!=="undefined"?'+c[h]+":void 0";c=0===c.length?"null":"{"+c.join(",")+"}",n=n.split("&VarPass&").join(c)}else n=n.split("&VarPass&").join("null");if(1!==(f=n.split("@if ")).length){f=f[1].split(":");var m=function(e){var t=null;2===(t=(e=(e=e.join(":")).split("@elseif "))[e.length-1].split("@else")).length?(e[e.length-1]=t[0],t=(t=t.pop()).substr(t.indexOf(":")+1)):t=null;for(var r={if:e.shift(),elseIf:[],elseValue:t},n=0;n<e.length;n++){var o=e[n].split(":");r.elseIf.push([o.shift(),o.join(":")])}return r};if("#noEval"===o){var g=f.shift(),b=m(f);b.type=REF_IF,b.data=[null,t,l,i],b.if=[g.trim(),b.if.trim()],null!==b.elseValue&&(b.elseValue=b.elseValue.trim());for(h=0;h<b.elseIf.length;h++)b.elseIf[h][0]=b.elseIf[h][0].trim(),b.elseIf[h][1]=b.elseIf[h][1].trim();return u.push(b),"{{%%="+(u.length-1)}var y=[f[0],t,l,i];return localEval.apply(self.root,y)?(f.shift(),y[0]=f.join(":"),localEval.apply(self.root,y)):(f.shift(),elseIfHandle(m(f),y))}if(1!==(f=n.split("@exec")).length){y=[f[1],t,l,i];return"#noEval"===o?(u.push({type:REF_EXEC,data:y}),"{{%%="+(u.length-1)):n=localEval.apply(self.root,y)}return""});return"#noEval"===o?(l=o=a=s=e=null,setTimeout(function(){f=null},1),[f,u,i]):f},bindArray=function(e,t,r,n,o,i,l,a){var s=["pop","push","splice","shift","unshift","swap","move","replace","softRefresh","hardRefresh"],u=-1,f=l.children,d=l.classList.contains("sf-keyed-list"),c=self.root[n],p="on$"+o,v=c[p],h=function(r,n,o,i){if(t.$virtual)var a=t.$virtual.DOMCursor+t.$virtual.preparedLength;if("clear"===n){if(t.$virtual)var s=[l.firstElementChild,l.lastElementChild];return l.textContent="",void(t.$virtual&&(l.appendChild(s[0]),l.appendChild(s[1]),t.$virtual.dom.textContent="",s[1].style.height=s[0].style.height=0,t.$virtual.reset(!0)))}if(t.$virtual){var h=t.$virtual.elements();clearTimeout(u),u=setTimeout(function(){t.$virtual&&t.$virtual.reinitScroll()},100)}else h=f;if("hardRefresh"!==n){if(void 0===v&&(v=c[p]),"swap"===n||"move"===n){if("move"===n){(O=t.length-r-i)<0&&(i+=O);var m=document.createElement("div");for(_=0;_<i;_++)m.appendChild(h[r+_]);var g=h[o]||null,b=g&&g.parentNode;!1===b&&(b=t.$virtual&&t.length>=a?t.$virtual.dom:l);for(_=0;_<i;_++)b.insertBefore(m.firstElementChild,g),void 0!==v&&v.update&&v.update(h[r+_],"move");return}if(r>o){var y=h[o];o=h[r],r=y}else r=h[r],o=h[o];var E=o.nextSibling,C=o.parentNode;return r.parentNode.insertBefore(o,r.nextSibling),C.insertBefore(r,E),void(void 0!==v&&v.update&&(v.update(h[o],"swap"),v.update(h[r],"swap")))}if("removeRange"!==n){if("remove"!==n){if("update"===n){var O;void 0===r?(r=0,o=t.length):void 0===o?o=r+1:o<0?o=t.length+o:o+=r,(O=t.length-o)<0&&(o+=O);for(_=r;_<o;_++){var $=h[_];if(void 0===$||void 0===t[_])break;L=templateParser(e,t[_]);!1===d&&syntheticCache(L,e,t[_]),t.$virtual?$.parentNode.replaceChild(L,$):(l.replaceChild(L,$),void 0!==v&&v.update&&v.update(L,"replace"))}}var x=t[r];if(void 0!==x){L=templateParser(e,x);if(!1===d&&syntheticCache(L,e,x),"insertAfter"===n){if(0===h.length)l.insertBefore(L,l.lastElementChild);else(w=h[r-1]).parentNode.insertBefore(L,w.nextSibling);void 0!==v&&v.create&&v.create(L)}else if("prepend"===n){var w;void 0!==(w=h[0])?(w.parentNode.insertBefore(L,w),void 0!==v&&v.create&&v.create(L)):n="append"}if("append"===n){if(t.$virtual)return 0===r?l.insertBefore(L,l.lastElementChild):r>=a?(null===t.$virtual.vCursor.floor&&(t.$virtual.vCursor.floor=L),t.$virtual.dom.appendChild(L)):h[r-1].insertAdjacentElement("afterEnd",L),void(void 0!==v&&v.create&&v.create(L));l.appendChild(L),void 0!==v&&v.create&&v.create(L)}}}else if(h[r]){var S=h[r];if(void 0!==v&&v.remove){var T=!1,M=function(){T||(T=!0,S.remove())};v.remove(h[r],M)||M()}else S.remove()}}else for(_=r;_<o;_++)h[_].remove()}else{for(var _=r;_<h.length;_++)h[_].remove();if(t.$virtual)var D=t.$virtual.vCursor;for(var _=r;_<t.length;_++){var L=templateParser(e,t[_]);t.$virtual?null===D.floor&&_<a?l.insertBefore(L,l.lastElementChild):t.$virtual.dom.appendChild(L):l.appendChild(L),!1===d&&syntheticCache(L,e,t[_])}t.$virtual&&t.$virtual.refreshVirtualSpacer&&t.$virtual.refreshVirtualSpacer(t.$virtual.DOMCursor)}},m=function(e,r){Object.defineProperty(e,r,{enumerable:!1,configurable:!0,value:function(){var e=void 0,n=this.length;if("move"===r){var o=arguments[0],i=arguments[1];if(o===i)return;var l=arguments[2]||1;return h(o,"move",i,l),(e=Array.prototype.splice.apply(this,[o,l])).unshift(i,0),Array.prototype.splice.apply(this,e),void(t.$virtual&&t.$virtual.reinitCursor())}if("swap"===r){var a=arguments[0],s=arguments[1];if(a===s)return;h(a,"swap",s);e=this[a];return this[a]=this[s],void(this[s]=e)}if("replace"===r){if(t.$virtual&&t.$virtual.resetViewport(),arguments[0].length>=n&&0!==n){var u=n,f=arguments[0];for(a=0;a<n&&f[a]===this[a];a++)u--;if(0===u){if(f.length===n)return;return(e=arguments[0].slice(n)).unshift(n,0),void this.splice.apply(this,e)}if(u!==n){if(!0===arguments[1])(e=arguments[0].slice(a)).unshift(a,n-a),Array.prototype.splice.apply(this,e),t.refresh(a,n);return}}if(0===n)return Array.prototype.push.apply(this,arguments[0]),void h(0,"hardRefresh");e=[0,n];return Array.prototype.push.apply(e,arguments[0]),Array.prototype.splice.apply(this,e),!0!==arguments[1]||d?(h(0,"clear"),h(0,"hardRefresh")):(this.length<n&&h(this.length,"removeRange",n),t.refresh(0,this.length),t.$virtual&&t.$virtual.refreshVirtualSpacer&&t.$virtual.refreshVirtualSpacer(t.$virtual.DOMCursor)),t.$virtual&&t.$virtual.reset(),this}if("splice"===r&&0===arguments[0]&&void 0===arguments[1])return h(0,"clear"),Array.prototype.splice.apply(this,arguments);if(Array.prototype[r]&&(e=Array.prototype[r].apply(this,arguments)),"pop"===r)h(this.length,"remove");else if("push"===r)if(1===arguments.length)h(n,"append");else for(a=0;a<arguments.length;a++)h(n+a,"append");else if("shift"===r)h(0,"remove"),t.$virtual&&t.$virtual.DOMCursor>0&&(t.$virtual.DOMCursor--,t.$virtual.reinitCursor());else if("splice"===r){if(0===arguments[0]&&void 0===arguments[1])return e;var c=arguments[0];c<0&&(c=n+c);var p=arguments[1];p||0===p||(p=this.length);for(a=p-1;a>=0;a--)h(c+a,"remove");if(t.$virtual&&t.$virtual.DOMCursor>=c&&(t.$virtual.DOMCursor=c-p),arguments.length>=3){p=arguments.length-2,c>=this.length&&(c=this.length-1);for(a=0;a<p;a++)h(c+a,"insertAfter");t.$virtual&&t.$virtual.DOMCursor>=c&&(t.$virtual.DOMCursor+=p)}}else if("unshift"===r){if(1===arguments.length)h(0,"prepend");else for(a=arguments.length-1;a>=0;a--)h(a,"prepend");t.$virtual&&0!==t.$virtual.DOMCursor&&(t.$virtual.DOMCursor+=arguments.length,t.$virtual.reinitCursor())}else"softRefresh"===r?(h(arguments[0],"update",arguments[1]),t.$virtual&&t.$virtual.DOMCursor&&t.$virtual.reinitCursor()):"hardRefresh"===r&&(h(arguments[0]||0,"hardRefresh"),t.$virtual&&(t.$virtual.DOMCursor=arguments[0]||0));return e}})};l&&l.classList.contains("sf-virtual-list")?(delete t.$virtual,t.$virtual={},t.$virtual.dom=a,void 0!==v?t.$virtual.callback=v:t.$virtual.callback_={ref:c,var:p},l.replaceChild(e.html,f[1]),sf.internal.virtual_scroll.handle(t,i,l),e.html.remove()):setTimeout(function(){var e=internal.findScrollerElement(l);null!==e&&(e.classList.add("sf-scroll-element"),internal.addScrollerStyle())},500);for(var g=0;g<s.length;g++)m(t,s[g]);hiddenProperty(t,"$replace",function(r,n,o,i){var l=t.getElement(r).sf$elementReferences,a=e.modelReference[n];if(void 0!==a){for(var s=0;s<l.length;s++)if(void 0!==l[s].textContent&&void 0!==l[s].ref.direct&&-1!==a.indexOf(l[s].ref.direct)){var u=l[s].textContent,f=$.escapeText(t[r][n]).replace(o,i);if(t[r][n]===f)continue;for(u.textContent="",u.sf$haveChilds=!0,f=$.parseElement(f,!0);u.previousSibling&&u.previousSibling.sf$childRoot===u;)u.previousSibling.remove();var d=u.parentNode;for(s=0;s<f.length;s++)f[s].sf$childRoot=u,d.insertBefore(f[s],u)}}else console.error("Can't found binding for '"+n+"'")}),hiddenProperty(t,"refresh",function(r,n,o){void 0===r||r.constructor===String?(o=r,r=0,n=t.length):void 0===n?n=r+1:n.constructor===String?(o=n,n=r+1):n<0?n=t.length+n:n+=r;var i=t.length-n;i<0&&(n+=i);for(var l=r;l<n;l++){var a=t.getElement(l);if(void 0===a){t.hardRefresh(l);break}if(!0===d)t.softRefresh(l);else if(!1===syntheticTemplate(a,e,o,t[l]))continue;void 0!==v&&v.update&&v.update(a,"replace")}});var b=null;t.$virtual&&(b=t.$virtual.dom.children),hiddenProperty(t,"getElement",function(e){if(null!==b){if(e<t.$virtual.DOMCursor)return b[e];e-=t.$virtual.DOMCursor;var r=l.childElementCount-2;return e<r?f[e+1]:b[e-r+t.$virtual.DOMCursor]}return f[e]})},loopParser=function(e,t,r,n,o){var i=r.split(" in "),l=i[0],a=root_(e)[i[1]];if(void 0===a&&(a=root_(e)[i[1]]=[]),t.setAttribute("sf-bind-list",i[1]),processingElement=t,t=self.extractPreprocess(t,l,e),2===i.length){for(var s=o.classList.contains("sf-keyed-list"),u=document.createElement("div"),f=self.root[e],d=0;d<a.length;d++){var c=templateParser(t,a[d]);u.appendChild(c),!1===s&&syntheticCache(c,t,a[d])}if(void 0===f.sf$bindedKey&&initBindingInformation(f),void 0===f.sf$bindedKey[i[1]]&&(f.sf$bindedKey[i[1]]=null),Object.defineProperty(f,i[1],{enumerable:!0,configurable:!0,get:function(){return a},set:function(e){return 0===e.length?a.splice(0):a.replace(e,!0)}}),bindArray(t,a,l,e,i[1],n,o,u),void 0===a.$virtual){for(var p=u.children,v=(d=0,p.length);d<v;d++)o.appendChild(p[0]);u.remove(),u=null}}},callInputListener=function(e,t,r){var n=e["on$"+t],o=e["v2m$"+t],i=void 0,l=void 0;if(void 0!==n||void 0!==o){var a=e[t];null!=a&&a.constructor===Array&&(a=a.slice(0));try{void 0!==o&&(i=o(a,r)),void 0!==n&&(l=n(a,r))}catch(e){console.error(e)}}return void 0!==l?l:i},inputBoundRunning=!1,inputTextBound=function(e){if(!0!==e.fromSFFramework){inputBoundRunning=!0;var t=e.target;t.viewInputted=!0;var r=t.typeData===Number?Number(t.value):t.value,n=callInputListener(t.sfModel,t.sfBounded,r);t.sfModel[t.sfBounded]=void 0!==n?n:r}},inputFilesBound=function(e){if(!0!==e.fromSFFramework){var t=e.target;callInputListener(t.sfModel,t.sfBounded,t.files),t.sfModel[t.sfBounded]=t.files}},inputCheckBoxBound=function(e){if(!0!==e.fromSFFramework){inputBoundRunning=!0;var t=e.target;t.viewInputted=!0;var r=t.typeData===Number?Number(t.value):t.value,n=callInputListener(t.sfModel,t.sfBounded,r);void 0!==n&&(r=n);var o=t.sfModel,i=o[t.sfBounded].constructor;if(i===Array){var l=o[t.sfBounded].indexOf(r);-1===l&&!0===t.checked?o[t.sfBounded].push(r):-1!==l&&!1===t.checked&&o[t.sfBounded].splice(l,1)}else i===Boolean||t.typeData===Boolean?o[t.sfBounded]=t.checked:o[t.sfBounded]=r}},inputSelectBound=function(e){if(!0!==e.fromSFFramework){inputBoundRunning=!0;var t=e.target;t.viewInputted=!0;var r=t.typeData;if(!0===t.multiple)for(var n=t.selectedOptions,o=[],i=0;i<n.length;i++)o.push(r===Number?Number(n[i].value):n[i].value);else o=r===Number?Number(t.selectedOptions[0].value):t.selectedOptions[0].value;var l=callInputListener(t.sfModel,t.sfBounded,o);t.sfModel[t.sfBounded]=void 0!==l?l:o}},assignElementData={select:function(e,t,r){for(var n=r.options,o=r.typeData,i=e[t].constructor===Array&&e[t],l=0,a=n.length;l<a;l++)!1===i?o===String?n[l].selected=n[l].value===e[t]:n[l].selected=n[l].value==e[t]:n[l].selected=-1!==i.indexOf(o===Number?Number(n[l].value):n[l].value)},checkbox:function(e,t,r){e[t].constructor===Array?r.checked=-1!==e[t].indexOf(r.typeData===Number?Number(r.value):r.value):e[t].constructor===Boolean?r.checked=Boolean(e[t]):r.typeData===String?r.checked=r.value===e[t]:r.checked=r.value==e[t]}},inputBoundRun=function(e,t,r){if(!0!==inputBoundRunning)for(var n=0;n<r.length;n++){var o=new Event("change");o.fromSFFramework=!0,1===r.type?r[n].value=e[t]:2===r.type?assignElementData.select(e,t,r[n]):3===r.type?r[n].checked=e[t]==r[n].value:4===r.type&&assignElementData.checkbox(e,t,r[n]),r[n].dispatchEvent(o)}},triggerInputEvent=function(e){!0!==e.fromSFFramework&&(!0!==e.target.viewInputted?e.target.dispatchEvent(new Event("input")):e.target.viewInputted=!1)},elementBoundChanges=function(e,t,r,n){void 0===e.sf$bindedKey&&initBindingInformation(e);var o=0,i=null;if(null!==e[t]&&void 0!==e[t]&&(i=e[t].constructor),"number"===(r.getAttribute("typedata")||"").toLowerCase()&&(i=Number),r.typeData=i,$.on(r,"change",triggerInputEvent),"TEXTAREA"===r.tagName)$.on(r,"input",inputTextBound),r.value=e[t],o=1;else if(void 0!==r.selectedOptions)$.on(r,"input",inputSelectBound),o=2,assignElementData.select(e,t,r);else{if("radio"===(o=r.type.toLowerCase()))$.on(r,"input",inputTextBound),o=3,r.checked=e[t]==r.value;else if("checkbox"===o)$.on(r,"input",inputCheckBoxBound),o=4,assignElementData.checkbox(e,t,r);else{if("file"===o)return void $.on(r,"input",inputFilesBound);$.on(r,"input",inputTextBound),r.value=e[t],o=1}}!0!==n&&modelToViewBinding(e,t,inputBoundRun,r,o)},bindInput=function(e){for(var t=$("input[sf-bound], textarea[sf-bound], select[sf-bound], input[sf-bind], textarea[sf-bind], select[sf-bind]",e),r=0;r<t.length;r++){var n=t[r],o=sf.controller.modelName(n);if(!o)return;var i=self.root[o],l=!1,a=n.getAttribute("sf-bound");if(null===a&&(a=n.getAttribute("sf-bind"),l=!0),""===a&&(a=n.getAttribute("name")),null!==a){if(void 0===i[a])return void console.error("Can't get property \""+a+'" on model "'+o+'"');n.sfBounded=a,n.sfModel=i,!1===l?(n.setAttribute("sf-bounded",""),n.removeAttribute("sf-bound")):(n.setAttribute("sf-binded",""),n.removeAttribute("sf-bind")),elementBoundChanges(i,a,n,l)}else console.error("Property key to be bound wasn't be found",n)}},alreadyInitialized=!1;function repeatedListBinding(e,t,r,n){for(var o=0;o<e.length;o++){var i=e[o],l=i.parentElement;if(void 0!==r&&i.classList.remove("sf-dom-queued"),l.classList.contains("sf-virtual-list")){var a=document.createElement(i.tagName);a.classList.add("virtual-spacer");var s=a.cloneNode(!0);a.classList.add("ceiling"),l.insertBefore(a,l.firstElementChild),s.classList.add("floor"),l.appendChild(s)}var u=i.nextElementSibling;null!==u&&i!==u||(u=!1);var f=i.previousElementSibling;null!==f&&i!==f||(f=!1);var d=i.getAttribute("sf-repeat-this");if(i.removeAttribute("sf-repeat-this"),/sf-bind-key|sf-bind-list/.test(i.outerHTML))throw"Can't parse element that already bound";if(void 0!==n)var c=n;else if(void 0===(c=sf.controller.modelName(i)))continue;loopParser(c,i,d,t,l),i.remove()}}self.init=function(e,t){if(!alreadyInitialized||e){if(alreadyInitialized=!0,setTimeout(function(){alreadyInitialized=!1},50),e||(e=document.body),!0===internal.router.enabled){for(var r=$("[sf-controller]",e),n=[],o=0;o<r.length;o++){var i=r[o].getAttribute("sf-controller"),l=sf.model.root[i];void 0===l.$page&&(l.$page=window.$([]),void 0===l.$page.push&&Object.assign(l.$page.__proto__,internal.dom.extends_Dom7)),l.$page.push(r[o]),void 0!==sf.controller.pending[i]&&sf.controller.run(i),void 0!==l.init&&l.init(r[o])}internal.afterModelBinding=function(){for(var e=0;e<n.length;e++)internal.routerLocalEvent("when",r[e]);internal.afterModelBinding=void 0}}self.parsePreprocess(t||self.queuePreprocess(e),t),bindInput(e),repeatedListBinding($("[sf-repeat-this]",e),e,t),void 0!==internal.afterModelBinding&&internal.afterModelBinding()}};var DOMNodeRemoved=scope.DOMNodeRemoved=function(e,t){if(void 0===t)for(var r=e.querySelectorAll("[sf-controller]"),n=0;n<r.length;n++)DOMNodeRemoved(r[n],!0);if(!1===e.hasAttribute("sf-controller"));else{var o=void 0===e.sf$component?e.getAttribute("sf-controller"):e.sf$component,i=sf.model.root[o];if(i.$page&&-1!==(n=i.$page.indexOf(e))&&i.$page.splice(n),i.destroy&&i.destroy(e),removeModelBinding(o),void 0!==e.sf$component){var l=e.sf$componentFrom,a=sf.component.available[l];a.splice(a.indexOf(o),1),internal.component.triggerEvent(l,"removed",self.root[o]),delete self.root[o]}}};sf(function(){var e=function(e){1===e.nodeType&&null!==e.firstElementChild&&void 0===e.sf$elementReferences&&DOMNodeRemoved(e)};if("function"==typeof MutationObserver&&MutationObserver.prototype.observe){var t=function(t){t.removedNodes.forEach(e)};new MutationObserver(function(e){bindingEnabled&&e.forEach(t)}).observe(document.body,{childList:!0,subtree:!0})}else document.body.addEventListener("DOMNodeRemoved",function(t){bindingEnabled&&e(t.target)})});var removeModelBinding=self.reset=function(e){var t=self.root[e];if(void 0!==t){var r=t.sf$bindedKey,n=null;for(var o in r)if(delete r[o],void 0!==t[o]&&null!==t[o]){if(t[o].constructor===String||t[o].constructor===Number||t[o].constructor===Boolean);else{if(t[o].constructor!==Array)continue;t[o].$virtual&&(t[o].$virtual.destroy(),delete t[o].$virtual),n=t[o].splice("obtain"),delete t[o],t[o]=n}if(void 0!==Object.getOwnPropertyDescriptor(t,o)){n=t[o];delete t[o],t[o]=n}}}};function modelToViewBinding(e,t,r,n,o){var i;if(void 0===e.sf$bindedKey&&initBindingInformation(e),void 0!==e.sf$bindedKey[t])return-1===(i=e.sf$bindedKey[t]).indexOf(r)&&i.push(r),void(void 0!==n&&(void 0===i.input?(i.input=[n],i.input.type=o):i.input.push(n)));(e.sf$bindedKey[t]=[r],void 0!==n)&&((i=e.sf$bindedKey[t]).input=[n],i.input.type=o);if(void 0===Object.getOwnPropertyDescriptor(e,t).set){var l=e[t];Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(e){return l},set:function(r){if(l!==r){var n=e["m2v$"+t],o=!1===inputBoundRunning?e["out$"+t]:void 0,i=!1===inputBoundRunning?e["on$"+t]:void 0;if(void 0!==i||void 0!==n||void 0!==o){var a=void 0,s=void 0,u=void 0;try{void 0!==n&&(a=n(l,r)),void 0!==o&&(s=o(l,r)),void 0!==i&&(u=i(l,r))}catch(e){console.error(e)}l=void 0!==u?u:void 0!==s?s:void 0!==a?a:r}else l=r;for(var f=e.sf$bindedKey[t],d=0;d<f.length;d++)inputBoundRun!==f[d]?f[d]():!0!==inputBoundRunning&&f[d](e,t,f.input)}return inputBoundRunning=!1,l}})}}var dcBracket=/{{[^#][\s\S]*?}}/;self.bindElement=function(e){var t=sf.controller.modelName(e),r=self.root[t];if(!r)return console.error("Model for "+t+" was not found while binding:",e);var n=self.extractPreprocess(e,null,t);templateParser(n,r,!0),delete n.addresses,e.parentNode.replaceChild(n.html,e),e=n.html;for(var o=function(){syntheticTemplate(e,n,void 0,r)},i=n.modelRef_array,l=0;l<i.length;l++){var a=i[l][0];void 0===r[a]&&(r[a]=""),modelToViewBinding(r,a,o)}},self.extractPreprocess=function(e,t,r){var n=e.tagName.toLowerCase();if(void 0!==sf.component.registered[n])return e.parentNode.classList.add("sf-keyed-list"),e.textContent="",e.remove(),e.setAttribute("sf-component-ignore",""),{component:window["$"+capitalizeLetters(n.split("-"))],list:e.getAttribute("sf-bind-list")};for(var o=e.querySelectorAll("[sf-repeat-this]"),i=0;i<o.length;i++){(f=o[i]).insertAdjacentHTML("afterEnd",'<sfrepeat-this id="'+i+'"></sfrepeat-this>'),f.remove()}var l=e.outerHTML;null!==t?l=l.split("#"+t).join("_model_"):l.replace(/sf-repeat-this="(?:\W+|)(\w+)/g,function(e,t){l=(l=l.split("#"+t).join("_model_")).replace(RegExp(sf.regex.strictVar+"("+t+")\\b","g"),"_model_")});var a=(l=uniqueDataParser(l,null,t,r,"#noEval"))[1],s=l[2];l=dataParser(l[0],null,t,r,"#noEval",a);var u=(l=$.parseElement(l)[0]).querySelectorAll("sfrepeat-this");for(i=0;i<u.length;i++){var f;(f=u[i]).parentNode.replaceChild(o[f.id],f)}var d=self.queuePreprocess(l,!0).reverse(),c=[];function p(e){for(var t=e.attributes,r=[],n=0,o=0;o<t.length;o++){var i=t[o].value.split("{{%=");if(1!==i.length){if(":"===t[o].name[0]){var l={name:t[o].name.slice(1),value:t[o].value};e.removeAttribute(t[o].name),e.setAttribute(l.name,"")}else l={name:t[o].name,value:t[o].value};n=[],""===(i=l.value.replace(/{{%=([0-9]+)/g,function(e,t){return n.push(Number(t)),""}))&&1===n.length?l.direct=n[0]:l.parse_index=n,r.push(l)}}return r}var v=p(l);0!==v.length&&c.push({nodeType:1,address:[0],attributes:v});for(i=0;i<d.length;i++){var h={nodeType:d[i].nodeType};if(1===h.nodeType)h.attributes=p(d[i]),h.address=$.getSelector(d[i],!0);else if(3===h.nodeType){var m=d[i].textContent,g=[];if(m.replace(/{{%%=([0-9]+)/gm,function(e,t){g.push(Number(t))}),0!==g.length){m=m.split(/{{%%=[0-9]+/gm);for(var b=0;b<m.length;b++)m[b]=trimIndentation(m[b]).trim();d[i].textContent=m.shift();var y=d[i].parentNode,E=d[i].nextSibling,C=null;0!==g.length&&0!==d[i].textContent.length?C=$.getSelector(d[i],!0):null!==d[i].previousSibling&&(C=$.getSelector(d[i].previousSibling,!0));var O=[];for(b=0;b<g.length;b++){var x=document.createComment("");if(y.insertBefore(x,E),O.push({nodeType:-1,parse_index:g[b],startFlag:C,address:$.getSelector(x,!0)}),m[b]){var w=document.createTextNode(m[b]);y.insertBefore(w,E),b+1<g.length&&(C=$.getSelector(w,!0))}}if(Array.prototype.push.apply(c,O),""===d[i].textContent){d[i].remove();for(b=0;b<O.length;b++){var S=O[b].address;S[S.length-1]--}continue}if(-1===d[i].textContent.search(/{{%=[0-9]+/))continue}g=[],""===(m=d[i].textContent.replace(/{{%=([0-9]+)/gm,function(e,t){return g.push(Number(t)),""}))&&1===g.length?h.direct=g[0]:(h.value=d[i].textContent,h.parse_index=g),h.address=$.getSelector(d[i],!0)}c.push(h)}var T=function(){if(null===t)var e=RegExp("(?:{{.*?\\b|_modelScope\\.)("+self.modelKeys(self.root[r]).sort(function(e,t){return t.length-e.length}).join("|")+")(\\b.*?}}|)","g");else e=sf.regex.arrayItemsObserve;for(var n={},o=0;o<a.length;o++){var i=a[o];if(0!==i.type){if(1===i.type){var l=i.if.join(";");null!==i.elseValue&&(l+=";"+i.elseValue);for(var u=0;u<i.elseIf.length;u++)l+=i.elseIf[u].join(";")}else 2===i.type&&(l=i.data[0]);(l=l.replace(/_result_ \+= _content_\.take\(.*?, ([0-9]+)\);/g,function(e,t){return s[t]})).split('"').join("'").replace(e,function(e,t){t=t.replace(/\['(.*?)'\]/g,function(e,t){return"."+t}),void 0===n[t]?n[t]=[o]:-1===n[t].indexOf(o)&&n[t].push(o)})}else i.data[0].split('"').join("'").replace(e,function(e,t){t=t.replace(/\['(.*?)'\]/g,function(e,t){return"."+t}),void 0===n[t]?n[t]=[o]:-1===n[t].indexOf(o)&&n[t].push(o)})}return n}(),M=Object.keys(T),_=[];for(i=0;i<M.length;i++)_.push([M[i],M[i].split(".")]);return{html:l,parse:a,addresses:c,modelReference:T,modelRef_array:_}};var enclosedHTMLParse=!1,excludes=["HTML","HEAD","STYLE","LINK","META","SCRIPT","OBJECT","IFRAME"];function initBindingInformation(e){void 0===e.sf$bindedKey&&Object.defineProperty(e,"sf$bindedKey",{configurable:!0,enumerable:!1,writable:!0,value:{}})}self.queuePreprocess=function(e,t){for(var r=(e||document.body).childNodes,n=[],o=r.length-1;o>=0;o--){var i=r[o];if(void 0!==t||-1===excludes.indexOf(i.nodeName))if(1===i.nodeType){if(!0===enclosedHTMLParse)continue;var l=i.attributes;if(l["sf-bind-key"]||l["sf-repeat-this"]||l["sf-bind-list"]||void 0!==i.sf$elementReferences)continue;for(var a=0;a<l.length;a++)if(-1!==l[a].value.indexOf("{{")){n.push(i);break}Array.prototype.push.apply(n,self.queuePreprocess(i,t))}else if(3===i.nodeType){if(0===i.textContent.length){i.remove();continue}var s=i.textContent.indexOf("{[");if(-1!==s)enclosedHTMLParse=!1;else if(!0===enclosedHTMLParse)continue;var u=i.textContent.indexOf("]}");if(-1!==u&&(-1===s||s>u)){enclosedHTMLParse=!0;continue}if(-1!==i.nodeValue.indexOf("{{")){if(void 0===t){n.push(i.parentNode);break}n.push(i)}}}return n},self.parsePreprocess=function(e,t){for(var r=0;r<e.length;r++){var n=processingElement=e[r],o=sf.controller.modelElement(n);if(null!==o){var i=void 0===o.sf$component?o.getAttribute("sf-controller"):o.sf$component;void 0!==t&&n.classList.remove("sf-dom-queued"),(internal.modelPending[i]||void 0===self.root[i])&&self(i);var l=self.root[i];if(/sf-bind-key|sf-bind-list/.test(n.innerHTML))return console.error("Can't parse element that already bound"),void console.log(processingElement.cloneNode(!0));if(!1===n.hasAttribute("sf-bind-ignore"))self.bindElement(n);else{var a=uniqueDataParser(n.innerHTML,l,!1,i);n.innerHTML=dataParser(a,l,!1,i);for(var s=n.attributes,u=0;u<s.length;u++)if(-1!==s[u].value.indexOf("{{")){var f=s[u];f.value=dataParser(f.value,l,!1,i)}}}}}}(),sf.API=function(e,t,r,n,o,i,l){"object"!=typeof r&&(r={});var a={url:t,dataType:"json",method:"POST",success:function(e){!sf.API.onSuccess(e)&&n&&n(e,t),o&&o(200)},error:function(e,t){try{e=JSON.parse(e.response)}catch(e){}sf.API.onError(t,e),o&&o(t,e)}};return r.constructor!==FormData&&(a.contentType="application/json"),r._method=e.toUpperCase(),i?a.beforeSend=function(e){e.setRequestHeader("X-Authorization","Bearer "+i),l&&l(e)}:void 0!==l&&(a.beforeSend=l),a.data=r,sf.ajax(a)},sf.API.onError=function(e,t){},sf.API.onSuccess=function(e){};var extendsAPI={get:function(e,t,r,n){return sf.API("get",this.url+e,t,r,n,this.accessToken)},post:function(e,t,r,n){return sf.API("post",this.url+e,t,r,n,this.accessToken)},delete:function(e,t,r,n){return sf.API("delete",this.url+e,t,r,n,this.accessToken)},put:function(e,t,r,n){return sf.API("put",this.url+e,t,r,n,this.accessToken)},upload:function(e,t,r,n,o){if(t.constructor!==FormData)return console.error("Parameter 2 must be a FormData");var i=void 0;return void 0!==o&&(i=function(e){e.upload.onprogress=function(e){e.lengthComputable&&o(e.loaded,e.total)}}),sf.API("post",this.url+e,t,r,n,this.accessToken,i)}};sf.API.instance=function(e){this.url=e,this.accessToken=!1,Object.assign(this,extendsAPI)},sf.controller=new function(){var self=this;self.pending={},self.active={},internal.controller={pending:[]},self.for=function(e,t){if(!sf.component.registered[e])return self.active[e]?t():void(self.pending[e]=t);sf.component.registered[e][1]=t},self.modelScope=function(e,t){var r=sf.controller.modelName(e);if(!r)throw"model or controller was not found";var n=e.getAttribute("sf-bind-list");if(n)var o=e;else null!==(o=$.parent(e,"[sf-bind-list]"))&&(n=o.getAttribute("sf-bind-list"));if(!n)return t?t(sf.model.root[r],-1):sf.model.root[r];var i=0;return n&&(i=$.prevAll(o,"[sf-bind-list]").length),t?t(sf.model.root[r][n],i):sf.model.root[r][n][i]},self.modelElement=function(e){return 1===e.nodeType&&!0===e.hasAttribute("sf-controller")?e:$.parent(e,"[sf-controller]")},self.modelName=function(e){var t=self.modelElement(e);if(null!==t)return void 0===(t=void 0===t.sf$component?t.getAttribute("sf-controller"):t.sf$component)||self.active[t]||self.run(t),t;console.error("Can't find any controller for",e)};var listenSFClick=function(e){var element=e.target,script=element.getAttribute("sf-click");script||(element=$.parent(element,"[sf-click]"),script=element.getAttribute("sf-click"));var model=$.parent(element,"[sf-controller]");model=void 0===model.sf$component?model.getAttribute("sf-controller"):model.sf$component;var _modelScope=sf.model.root[model];if(void 0===_modelScope)throw"Couldn't find model for "+model+" that was called from sf-click";var modelKeys=sf.model.modelKeys(_modelScope).join("|");script=avoidQuotes(script,function(e){return e.replace(RegExp(sf.regex.strictVar+"("+modelKeys+")\\b","g"),function(e,t){return"_modelScope."+t})}),script=script.split("(");var method=script.shift(),method_=method;try{method=eval(method)}catch(e){return void console.error("Error on sf-click for model: "+model+" [Cannot call `"+method_+"`]\n",element,e)}script=script.join("("),script=script.split(")"),script.pop(),script=script.join("("),script=0!==script.length?eval(("["+script+"]").replace(/,this|\[this/g,function(e){return e[0]+"element"})):[e];try{method.apply(element,script),e.preventDefault()}catch(e){console.error("Error on sf-click for model: "+model+"\n",element,"\n",e)}};self.run=function(e,t){if(sf.component.registered[e])return console.error("'"+e+"' is registered as a component");if(self.pending[e]){sf.model.root[e]||(sf.model.root[e]={}),self.pending[e](sf.model.root[e],root_),self.active[e]=!0,delete self.pending[e];var r=internal.controller.pending.indexOf(e);-1!==r&&internal.controller.pending.splice(r,1)}void 0===sf.model.root[e]&&(sf.model.root[e]={}),t&&t(sf.model.root[e],root_)},self.init=function(e){if(!sf.loader.DOMWasLoaded)return sf(function(){self.init(e)});for(var t=$("[sf-controller]",e||document.body),r=0;r<t.length;r++)self.run(void 0===t[r].sf$component?t[r].getAttribute("sf-controller"):t[r].sf$component)},document.addEventListener("DOMContentLoaded",function(){$.on(document.body,"click","[sf-click]",listenSFClick),self.init()},{capture:!0,once:!0})};var root_=function(e){if(sf.component.registered[e]){var t=[],r=sf.component.available[e];if(void 0!==r)for(var n=0;n<r.length;n++)t.push(sf.model.root[r[n]]);return t}if(!sf.model.root[e]){var o=sf.model.root[e]={};if(void 0!==internal.modelPending[e]){for(var i=internal.modelPending[e],l=0;l<i.length;l++)i[l](o,root_);delete internal.modelPending[e]}}return sf.model.root[e]},globals={},jsonpRequests=0,self,hashes;function Request(e){var t=Object.assign({},globals);"beforeCreate beforeOpen beforeSend error complete success statusCode".split(" ").forEach(function(e){delete t[e]});var r=Object.assign({url:window.location.toString(),method:"GET",data:!1,async:!0,cache:!0,user:"",password:"",headers:{},xhrFields:{},statusCode:{},processData:!0,dataType:"text",contentType:"application/x-www-form-urlencoded",timeout:0},t),n=Object.assign({},r,e);function o(e){for(var t,r,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];return globals[e]&&(t=globals[e].apply(globals,o)),n[e]&&(r=n[e].apply(n,o)),"boolean"!=typeof t&&(t=!0),"boolean"!=typeof r&&(r=!0),t&&r}if(!1!==o("beforeCreate",n)){n.type&&(n.method=n.type);var i=n.url.indexOf("?")>=0?"&":"?",l=n.method.toUpperCase();if(("GET"===l||"HEAD"===l||"OPTIONS"===l||"DELETE"===l)&&n.data){var a=void 0;(a="string"==typeof n.data?n.data.indexOf("?")>=0?n.data.split("?")[1]:n.data:serializeQuery(n.data)).length&&(n.url+=i+a,"?"===i&&(i="&"))}if("json"===n.dataType&&n.url.indexOf("callback=")>=0){var s,u="jsonp_"+(Date.now()+(jsonpRequests+=1)),f=n.url.split("callback="),d=f[0]+"callback="+u;if(f[1].indexOf("&")>=0){var c=f[1].split("&").filter(function(e){return e.indexOf("=")>0}).join("&");c.length>0&&(d+="&"+c)}var p=document.createElement("script");return p.type="text/javascript",p.onerror=function(){clearTimeout(s),o("error",null,"scripterror"),o("complete",null,"scripterror")},p.src=d,window[u]=function(e){clearTimeout(s),o("success",e),p.parentNode.removeChild(p),p=null,delete window[u]},document.querySelector("head").appendChild(p),void(n.timeout>0&&(s=setTimeout(function(){p.parentNode.removeChild(p),p=null,o("error",null,"timeout")},n.timeout)))}"GET"!==l&&"HEAD"!==l&&"OPTIONS"!==l&&"DELETE"!==l||!1===n.cache&&(n.url+=i+"_nocache"+Date.now());var v=new XMLHttpRequest;if(v.requestUrl=n.url,v.requestParameters=n,!1===o("beforeOpen",v,n))return v;v.open(l,n.url,n.async,n.user,n.password);var h,m=null;if(("POST"===l||"PUT"===l||"PATCH"===l)&&n.data)if(n.processData)if([ArrayBuffer,Blob,Document,FormData].indexOf(n.data.constructor)>=0)m=n.data;else{var g="---------------------------"+Date.now().toString(16);"multipart/form-data"===n.contentType?v.setRequestHeader("Content-Type","multipart/form-data; boundary="+g):v.setRequestHeader("Content-Type",n.contentType),m="";var b=serializeQuery(n.data);if("multipart/form-data"===n.contentType){b=b.split("&");for(var y=[],E=0;E<b.length;E+=1)y.push('Content-Disposition: form-data; name="'+b[E].split("=")[0]+'"\r\n\r\n'+b[E].split("=")[1]+"\r\n");m="--"+g+"\r\n"+y.join("--"+g+"\r\n")+"--"+g+"--\r\n"}else m="application/json"===n.contentType?JSON.stringify(n.data):b}else m=n.data,v.setRequestHeader("Content-Type",n.contentType);return n.headers&&Object.keys(n.headers).forEach(function(e){v.setRequestHeader(e,n.headers[e])}),"void 0"==typeof n.crossDomain&&(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!==window.location.host),n.crossDomain||v.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.xhrFields&&Object.assign(v,n.xhrFields),v.onload=function(){if(h&&clearTimeout(h),v.status>=200&&v.status<300||0===v.status){var e=void 0;if("json"===n.dataType){var t=void 0;try{e=JSON.parse(v.responseText)}catch(e){t=!0}t?o("error",v,"parseerror"):o("success",e,v.status,v)}else o("success",e="text"===v.responseType||""===v.responseType?v.responseText:v.response,v.status,v)}else o("error",v,v.status);n.statusCode&&(globals.statusCode&&globals.statusCode[v.status]&&globals.statusCode[v.status](v),n.statusCode[v.status]&&n.statusCode[v.status](v)),o("complete",v,v.status)},v.onerror=function(){h&&clearTimeout(h),o("error",v,v.status),o("complete",v,"error")},n.timeout>0&&(v.onabort=function(){h&&clearTimeout(h)},h=setTimeout(function(){v.abort(),o("error",v,"timeout"),o("complete",v,"timeout")},n.timeout)),!1===o("beforeSend",v,n)?v:(v.send(m),v)}}function RequestShortcut(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[],o=n[0],i=n[1],l=n[2],a=n[3],s=n[4];"function"==typeof t[1]?(o=t[0],l=t[1],a=t[2],s=t[3]):(o=t[0],i=t[1],l=t[2],a=t[3],s=t[4]),[l,a].forEach(function(e){"string"==typeof e&&(s=e,e===l?l=void 0:a=void 0)});var u={url:o,method:"post"===e||"postJSON"===e?"POST":"GET",data:i,success:l,error:a,dataType:s=s||("json"===e||"postJSON"===e?"json":void 0)};return"postJSON"===e&&Object.assign(u,{contentType:"application/json",processData:!1,crossDomain:!0,data:"string"==typeof i?i:JSON.stringify(i)}),Request(u)}function serializeQuery(e,t){for(var r=Object.keys(e),n=0;n<r.length;n++){var o=e[r[n]];e.constructor===Array?r[n]+=t+"[]":e.constructor===Object&&(r[n]=t?t+"["+r[n]+"]":r[n]),r[n]="object"==typeof o?serializeQuery(o,r[n]):r[n]+"="+encodeURIComponent(o)}return r.join("&")}return Object.assign(Request,{get:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["get"].concat(e))},post:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["post"].concat(e))},json:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["json"].concat(e))},getJSON:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["json"].concat(e))},postJSON:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return RequestShortcut.apply(void 0,["postJSON"].concat(e))}}),Request.setup=function(e){e.type&&!e.method&&Object.assign(e,{method:e.type}),Object.assign(globals,e)},$.ajax=sf.ajax=Request,sf.events=function(){var e={},t={};function r(n,o){if(n.constructor!==Array){if(void 0===r[n]){var i=void 0;if(void 0!==o&&o.constructor===Boolean&&(i=o),void 0!==i)Object.defineProperty(r,n,{enumerable:!1,configurable:!0,get:function(){return i},set:function(e){if(i!==e){var o=t[n];if(void 0!==o){for(var l=0;l<o.length;l++)try{o[l].apply(null,arguments)}catch(e){console.error(e)}delete t[n]}Object.defineProperty(r,n,{enumerable:!1,configurable:!0,writable:!0,value:e})}}});else{r[n]=function(){for(var e=0;e<l.length;e++)try{l[e].apply(null,arguments),!0===l[e].once&&l[e].splice(e--,1)}catch(e){console.error(e)}},void 0===e[n]&&(e[n]=[]);var l=e[n]}}o&&o.constructor===Function&&(o(r[n]),o=null)}else for(var a=0;a<n.length;a++)r(n[a],o)}return r.when=function(e,n){if(!0===r[e])return n();void 0===t[e]&&(t[e]=[]),t[e].push(n)},r.once=function(t,r){r.once=!0,e[t].push(r)},r.on=function(t,r){void 0===e[t]&&(e[t]=[]),e[t].length>=10&&console.warn("Events have more than 10 callback, there may possible memory leak."),e[t].push(r)},r.off=function(t,r){if(void 0===e[t])return e[t].length=0;var n=e[t].indexOf(r);-1!==n&&e[t].splice(n,1)},r}(),self=sf.url=function(){var e="";for(var t in hashes)e+="#"+t+hashes[t];var r="|"+self.data.join("|");return self.paths+e+(1!==r.length?r:"")},hashes=self.hashes={},self.data={},self.paths="/",self.push=function(){window.history.pushState((window.history.state||0)+1,"",self())},self.replace=function(){window.history.replaceState(window.history.state,"",self())},self.parse=function(){self.data=window.location.hash.slice(1).split("|");for(var e=self.data.shift().split("#"),t=1;t<e.length;t++){var r=e[t].split("/");hashes[r.shift()]="/"+r.join("/")}self.paths=window.location.pathname},self.parse(),function(){var e=routerEval;routerEval=void 0;var t=sf.url.hashes,r="/",n=!1,o=1,i=window.history.state||1,l=!1;window.addEventListener("popstate",function(e){if(n)return n=!1,void(i-=o);l=!0,sf.url.parse();var s=a.list;o=window.history.state>=i?1:-1,i+=o,s[r].goto(sf.url.paths);for(var u=Object.keys(t),f=0;f<u.length;f++){var d=s[u[f]];void 0!==d&&d.goto(t[u[f]])}l=!1},!1),internal.router={},internal.router.parseRoutes=function(e,t){var r=[],n=/\/:[^\/]+/,o=/path|url|on|routes/;return function e(i,l,a,s){!1!==a&&(a+=" ");for(var u=0;u<i.length;u++){var f=i[u],d=l+f.path;if(void 0===f.routes){var c=RegExp("^"+d.replace(n,"/([^/]+)")+"$");c.url=f.url,!1!==a&&(c.selector=t.indexOf(a),-1===c.selector&&(c.selector=t.length,t.push(a))),void 0!==s&&(c.parent=s),void 0!==f.on&&(c.on=f.on);for(var p=Object.keys(f),v=0;v<p.length;v++)if(!o.test(p[v])){e(f[p[v]],d,a+p[v],c);break}r.push(c)}else e(f.routes,d,a,s)}}(e,"",!1),r},internal.router.findRoute=function(e){for(var t=0;t<this.length;t++){var r=e.match(this[t]);if(null!==r)return this[t].data=r,this[t]}return!1};var a=sf.views=function(i,a){void 0===a&&(a=r);var s=sf.views.list[a]=this;s.currentPath="/",s.lastPath="/",s.currentDOM=null,s.lastDOM=null,s.maxCache=2;var u={};s.selector=function(e){if(u=document.querySelector(e||i)){e&&(i=e);var t=document.createElement("sf-page-view");u.insertBefore(t,u.firstChild);for(var r=1;r<=u.childNodes.length;r++)t.appendChild(u.childNodes[1]);return t.routeCached={},t.routePath=s.currentPath,s.currentDOM=t,$.on(u,"click","a[href]",p),!0}return!1},s.selector();var f=[i],d=[];d.findRoute=internal.router.findRoute,internal.router.enabled=!0;var c={routeStart:[],routeFinish:[],routeCached:[],routeError:[]};function p(e){var t=e.target,n=t.getAttribute("href");if("@"!==n[0]){if("#"===n[0]){e.preventDefault();for(var o=n.slice(1).split("#"),i=0;i<o.length;i++){var l=o[i].split(r),a=sf.views.list[l.shift()];void 0!==a&&(l=l.join(r),a.currentPath!==l&&a.goto(l))}}var u=t.href.replace(window.location.origin,"");-1===u.indexOf("//")&&(e.preventDefault(),s.goto(u)||console.error("Couldn't navigate to",u,"because path not found"))}else{var f=t.getAttribute("target");f?window.open(n.slice(1),f):window.location=n.slice(1)}}s.on=function(e,t){if(void 0===c[e])return console.error("Event '"+e+"' was not exist");-1===c[e].indexOf(t)&&c[e].push(t)},s.addRoute=function(e){d.push(...internal.router.parseRoutes(e,f))};var v=!1;function h(e,t){if(!e.aborted){n=!0,v=!1;for(var r=0;r<c.routeError.length;r++)c.routeError[r](e.status,t);window.history.go(-1*o)}}return s.goto=function(o,p,m){if(s.currentPath!==o){var g=d.findRoute(o);if(g){if(a===r?sf.url.paths=o:t[a]=o,l||sf.url.push(),!u.isConnected)return void 0!==u.nodeType&&(u={}),s.selector(),console.error(a,"can't route to",o,"because element with selector '"+i+"' was not found");if(v&&v.abort(),function(e){var t=!1;function r(r){if(null===r)return!1;for(var n=r.children,o=0;o<n.length;o++)if(n[o].routePath===e)return t=n[o],!0;return!1}if(!1===r(u))for(var n=0;n<f.length&&!r(u.querySelector(f[n]));n++);if(!1===t)return!1;void 0!==s.currentDOM.routeCached.on&&s.currentDOM.routeCached.on.leaving&&s.currentDOM.routeCached.on.leaving();s.currentDOM.classList.add("page-hidden"),s.currentDOM.classList.remove("page-current"),t.classList.remove("page-hidden"),t.classList.add("page-current"),s.currentDOM=t,void 0!==s.currentDOM.routeCached.on&&s.currentDOM.routeCached.on.coming&&s.currentDOM.routeCached.on.coming();for(var n=0;n<c.routeCached.length;n++)if(c.routeCached[n](s.currentPath,s.lastPath))return;for(var o=s.currentDOM.querySelectorAll("sf-controller"),i=sf.model.root,n=0;n<o.length;n++)i[o[n]].reinit&&i[o[n]].reinit();return s.lastPath=s.currentPath,s.currentPath=s.currentDOM.routePath,!0}(o))return!0;for(var b=0;b<c.routeStart.length;b++)if(c.routeStart[b](s.currentPath,o))return;return v=sf.ajax({url:window.location.origin+(g.url||o),method:m||"GET",data:Object.assign(p||{},{_sf_view:void 0===g.selector?i:f[g.selector].split(" ").pop()}),success:function(t){var r=document.createElement("sf-page-view");if(r.innerHTML=t,r.classList.add("page-prepare"),r.style.display="none",void 0===g.selector)var i=u;else i=u.querySelector(f[g.selector]);i.insertAdjacentElement("beforeend",r);try{if(!1!==s.dynamicScript)for(var l=r.getElementsByTagName("script"),a=0;a<l.length;a++)e(l[a].text);sf.model.init(r);for(a=0;a<c.routeFinish.length;a++)if(c.routeFinish[a](s.currentPath,o,g.data))return}catch(e){return console.error(e),r.remove(),h({status:0})}r.style.display="",null!==s.currentDOM&&(s.currentDOM.classList.add("page-hidden"),s.currentDOM.classList.remove("page-current"),s.lastPath=s.currentPath,void 0!==s.currentDOM.routeCached.on&&s.currentDOM.routeCached.on.leaving&&s.currentDOM.routeCached.on.leaving(),null!==s.lastDOM&&s.lastDOM.remove(),s.lastDOM=s.currentDOM),s.currentPath=o,r.routeCached=g,r.routePath=o,void 0!==g.on&&g.on.coming&&g.on.coming(g.data),r.classList.remove("page-prepare"),r.classList.add("page-current"),s.currentDOM=r,n=!1;var d=s.currentDOM.parentNode;for(a=d.childElementCount-s.maxCache-1;a>=0;a--)d.firstElementChild.remove()},error:h}),!0}}},s};sf.views.list={}}(),sf.internal.virtual_scroll=new function(){var e=this,t=!1;function r(t,r,n,o){var i=Math.floor(e.prepareCount/2);if(t<e.prepareCount)return r.ceiling=-1,r.floor=o.children[2*e.prepareCount+1],void 0!==r.floor?r.floor=r.floor.offsetTop:r.floor=o.lastElementChild.offsetTop+1e3,void(r.floor-=r.initial);void 0!==o.children[i+1]&&(r.ceiling=o.children[i+1].offsetTop),void 0!==n.$virtual.preparedLength&&t>=n.length-n.$virtual.preparedLength?r.floor=n.$virtual.dCursor.floor.offsetTop+2*n.$virtual.scrollHeight:(r.floor=o.children[e.prepareCount+3].offsetTop,o.hasAttribute("scroll-reduce-floor")&&(r.floor-=o.getAttribute("scroll-reduce-floor"),r.ceiling-=o.getAttribute("scroll-reduce-floor"))),r.ceiling-=r.initial,r.floor-=r.initial}function n(e,n,o,i,l){var a=n.$virtual,s=0,u=e;if(e>=n.length-a.preparedLength&&(s-=o,e=n.length-a.preparedLength),!(e-a.DOMCursor==0||e>=n.length)){if(t=!0,0===a.DOMCursor&&e<o+o/2||a.DOMCursor+o/2>e&&a.DOMCursor+o<e)l.scrollTop=n.getElement(u).offsetTop;else{for(var f=null,d=a.dCursor.ceiling,c=a.dCursor.floor,p=a.vCursor,v=i.childElementCount-2,h=0;h<v;h++)f=d.nextElementSibling,null===p.floor?(a.dom.insertAdjacentElement("beforeEnd",f),h===v-1&&(p.floor=f)):p.floor.insertAdjacentElement("beforeBegin",f);e>=o?e<n.length-a.preparedLength&&(e-=o):(s=o-e,a.DOMCursor=e=0);var m=a.preparedLength<=n.length?a.preparedLength:n.length;for(h=0;h<m&&void 0!==(f=a.dom.children[e]);h++)c.insertAdjacentElement("beforeBegin",f);a.DOMCursor=e,p.floor=a.dom.children[e]||null,p.ceiling=p.floor?p.floor.previousElementSibling:null,n.$virtual.refreshVirtualSpacer&&n.$virtual.refreshVirtualSpacer(e),r(e,a.bounding,n,i),void 0!==(f=i.children[o-s+1])&&(l.scrollTop=f.offsetTop-l.offsetTop)}t=!1}}function o(e){e.style.overflow="hidden",setTimeout(function(){e.style.overflow=""},50)}function i(e){var t=window.getComputedStyle(e),r=parseInt(t.marginTop)+parseInt(t.marginBottom);return e.offsetHeight+r||0}function l(e,t,o,i,l,a,s){var u=t.$virtual.DOMCursor,f=0;if(e){var d=-1,c=t.$virtual.preparedLength;do{d++}while(d<c&&i.children[d].offsetTop<l.scrollTop);(u+=d)>0&&(u-=1),f=l.scrollTop-i.children[d].offsetTop}if(e||i.childElementCount-2>t.$virtual.preparedLength){t.$virtual.DOMCursor=t.length;var p=u;e||(p=u<=o?u:u+o),n(p,t,o,i,l),l.scrollTop+=f}s&&s(u),a&&a(),r(u,t.$virtual.bounding,t,i)}e.prepareCount=4,e.handle=function(u,f,d){var c=u.$virtual;c.reset=function(e){c.DOMCursor=0,c.bounding.ceiling=-1,c.bounding.floor=0,c.vCursor.ceiling=null,c.vCursor.floor=c.dom.firstElementChild,c.bounding.initial=c.dCursor.ceiling.offsetTop,r(0,c.bounding,u,d)},c.reinitCursor=function(){c.vCursor.ceiling=c.dom.children[c.DOMCursor-1]||null,c.vCursor.floor=c.dom.children[c.DOMCursor]||null},c.reinitScroll=function(){r(c.DOMCursor,c.bounding,u,d)},c.elements=function(){return function(e,t){for(var r=[],n=void 0,o=e.$virtual.DOMCursor,i=0;i<o&&void 0!==(n=e.$virtual.dom.children[i]);i++)r.push(n);o=t.childElementCount-2;for(var i=1;i<=o&&void 0!==(n=t.children[i]);i++)r.push(n);var l=e.$virtual.dom.childElementCount+o;o=l-o-e.$virtual.DOMCursor;for(var i=0;i<o&&void 0!==(n=e.$virtual.dom.children[e.$virtual.DOMCursor+i]);i++)r.push(n);return r}(u,d)},c.dCursor={ceiling:d.querySelector(".virtual-spacer.ceiling"),floor:d.querySelector(".virtual-spacer.floor")},c.bounding={},c.vCursor={},c.reset(),c.targetNode=d,c.scrollHeight=c.dCursor.ceiling.nextElementSibling.offsetHeight;var p=d;c.destroy=function(){$.off(p,"scroll"),$.off(d,"mousedown mouseup"),c.dom.innerHTML="",function(e){for(var t=a.length-1;t>=0;t--)a[t].element===e&&a.splice(t,1)}(d),delete u.$virtual},c.resetViewport=function(){c.visibleLength=Math.floor(p.clientHeight/c.scrollHeight),c.preparedLength=c.visibleLength+2*e.prepareCount,c.preparedLength<18&&(c.preparedLength=18)};var v=internal.afterModelBinding;internal.afterModelBinding=void 0,setTimeout(function(){void 0!==u.$virtual&&((p=internal.findScrollerElement(d)).classList.add("sf-scroll-element"),internal.addScrollerStyle(),c.resetViewport(),d.classList.contains("sf-list-dynamic")?(!0,function(o,u,f,d){var c=o.$virtual,p=c.dCursor.ceiling,v=c.dCursor.floor,h=c.vCursor;h.floor=c.dom.firstElementChild,c.scrollTo=function(t){n(t,o,e.prepareCount,f,d),b=0,y=0,p.style.height=b+"px",v.style.height=y+"px"},c.refresh=function(t){l(t,o,e.prepareCount,f,d),E()},E(),c.visibleLength=f.childElementCount-2,c.preparedLength=c.visibleLength+2*e.prepareCount,c.preparedLength<18&&(c.preparedLength=18);for(var m=0;m<e.prepareCount;m++){var g=h.floor;if(null===g)break;h.floor=g.nextElementSibling,v.insertAdjacentElement("beforeBegin",g)}c.DOMCursor=0;var b=0,y=0;function E(){for(var e=c.preparedLength-(f.childElementCount-2),t=0;t<e&&null!==(g=null===h.ceiling?c.dom.firstElementChild:h.ceiling.nextElementSibling);t++)h.floor=g.nextElementSibling,v.insertAdjacentElement("beforeBegin",g)}var C=c.bounding;if(r(0,C,o,f),void 0!==c.callback_){var O=c.callback_;delete c.callback_}var x=!1;$.on(d,"scroll",function(){if(x||t)return;x=!0,d.scrollTop<C.ceiling?(!function(){for(var t=null,r=!1,n=0;n<e.prepareCount&&null!==(t=null===h.floor?c.dom.lastElementChild:h.floor.previousElementSibling);n++)h.ceiling=t.previousElementSibling,c.DOMCursor--,p.insertAdjacentElement("afterEnd",t),b>0&&(b-=i(t)),c.DOMCursor<e.prepareCount&&!r&&(n=0,r=!0,t=null);(b<0||null===t)&&(b=0);for(var l=f.childElementCount-2-o.$virtual.preparedLength,n=0;n<l;n++)t=v.previousElementSibling,y+=i(t),null===h.floor?c.dom.insertAdjacentElement("beforeEnd",t):h.floor.insertAdjacentElement("beforeBegin",t),h.floor=t;null===h.floor?h.ceiling=c.dom.lastElementChild:h.ceiling=h.floor.previousElementSibling;p.style.height=b+"px",v.style.height=y+"px"}(),r(c.DOMCursor,C,o,f)):d.scrollTop>C.floor&&(!function(){var t=null;if(E(),null!==h.floor){null===h.ceiling&&(h.ceiling=h.floor.previousElementSibling);for(var r=0;r<e.prepareCount&&null!==(t=h.floor);r++)h.floor=t.nextElementSibling,v.insertAdjacentElement("beforeBegin",t),y>0&&(y-=i(t))}(y<0||null===t)&&(y=0);for(var n=f.childElementCount-2-o.$virtual.preparedLength,r=0;r<n;r++)t=p.nextElementSibling,b+=i(t),c.DOMCursor++,null===h.ceiling?c.dom.insertAdjacentElement("afterBegin",t):h.ceiling.insertAdjacentElement("afterEnd",t),h.ceiling=t;null===h.ceiling?h.floor=c.dom.firstElementChild:h.floor=h.ceiling.nextElementSibling;p.style.height=b+"px",v.style.height=y+"px"}(),r(c.DOMCursor,C,o,f));void 0!==c.callback&&0!==o.length?c.callback.hitFloor&&null===c.vCursor.floor&&d.scrollTop+d.clientHeight===d.scrollHeight?c.callback.hitFloor(c.DOMCursor):c.callback.hitCeiling&&null===c.vCursor.ceiling&&0===d.scrollTop&&c.callback.hitCeiling(c.DOMCursor):O&&O.ref[O.var]&&(c.callback=O.ref[O.var],O=null);x=!1,0===d.scrollTop&&p.offsetHeight>10&&c.scrollTo(0)}),function(e,t){-1===s&&(s=setInterval(function(){for(var e=null,t=a.length-1;t>=0;t--)(e=a[t]).element.scrollHeight!==e.height&&e.element.scrollWidth!==e.width&&(null!==e.element.parentElement?e.callback():a.splice(t,1));0===a.length&&(clearInterval(s),s=-1)},1e3));a.push({element:e,callback:t,height:e.scrollHeight,width:e.scrollWidth})}(f,function(){r(c.DOMCursor,C,o,f)})}(u,0,d,p)):function(i,a,s,u){for(var f=i.$virtual,d=f.dCursor.ceiling,c=f.dCursor.floor,p=f.preparedLength<=i.length?f.preparedLength:i.length,v=0;v<p&&null!==f.dom.firstElementChild;v++)c.insertAdjacentElement("beforeBegin",f.dom.firstElementChild);function h(t){if(t>=e.prepareCount)d.style.height=(t-e.prepareCount)*f.scrollHeight+"px",c.style.height=(i.length-f.preparedLength-t)*f.scrollHeight+"px";else{d.style.height=t*f.scrollHeight+"px";var r=i.length-f.preparedLength;c.style.height=(r||0)*f.scrollHeight+"px"}}f.refreshVirtualSpacer=h;var m=f.bounding;if(h(0),r(e.prepareCount,m,i,s),m.ceiling=-1,f.offsetTo=function(e){return e*f.scrollHeight+d.offsetTop},f.vCursor.floor=f.dom.firstElementChild,f.scrollTo=function(t){n(t,i,e.prepareCount,s,u)},f.refresh=function(t){l(t,i,e.prepareCount,s,u,C,h)},void 0!==f.callback_){var g=f.callback_;delete f.callback_}var b=!1,y=!0,E=!1;function C(){if(b||t||u.scrollTop>=m.ceiling&&u.scrollTop<=m.floor)E&&(0!==u.scrollTop&&u.scrollTop!==u.scrollHeight-u.clientHeight||(o(u),E=!1));else{var n=Math.floor(u.scrollTop/f.scrollHeight);n+f.preparedLength>i.length&&(n=i.length-f.preparedLength),y&&(n<2*e.prepareCount&&(n-=e.prepareCount),E&&(o(u),E=!1),y=!1),n<e.prepareCount&&(n=0,y=!0),b=!0;var l=n-f.DOMCursor;n+l>=i.length&&(l=n+l-i.length),0!==l?(f.DOMCursor=n,function(e,t){var r=t.$virtual.dom,n=t.$virtual.vCursor,o=t.$virtual.dCursor;if(e>0){for(var i=0,l=0;l<e&&null!==(i=null===n.ceiling?r.firstElementChild:n.ceiling.nextElementSibling);l++)o.floor.insertAdjacentElement("beforeBegin",i);for(var l=e;l>0;l--)null===n.ceiling?(n.ceiling=o.ceiling.nextElementSibling,r.insertAdjacentElement("afterBegin",n.ceiling)):(i=o.ceiling.nextElementSibling,n.ceiling.insertAdjacentElement("afterEnd",i),n.ceiling=i);n.floor=n.ceiling.nextElementSibling}else if(e<0){var i=0;e=-e;for(var l=0;l<e&&null!==(i=null===n.floor?r.lastElementChild:n.floor.previousElementSibling);l++)o.ceiling.insertAdjacentElement("afterEnd",i);for(var l=0;l<e;l++)null===n.floor?(n.floor=o.floor.previousElementSibling,r.insertAdjacentElement("beforeEnd",n.floor)):(i=o.floor.previousElementSibling,n.floor.insertAdjacentElement("beforeBegin",i),n.floor=i);n.ceiling=n.floor.previousElementSibling}}(l,i),h(n),r(n,m,i,s),void 0!==f.callback&&0!==i.length?f.callback.hitFloor&&null===f.vCursor.floor?f.callback.hitFloor(n):f.callback.hitCeiling&&null===f.vCursor.ceiling&&f.callback.hitCeiling(n):g&&g.ref[g.var]&&(f.callback=g.ref[g.var],g=null),b=!1):b=!1}}$.on(u,"scroll",C),u===s&&-1!==navigator.userAgent.indexOf("Chrom")&&($.on(s,"mousedown",function(){E=!0}),$.on(s,"mouseup",function(){E=!1}))}(u,0,d,p),void 0!==v&&(v(),v=void 0))},500)};var a=[],s=-1;var u=!1;internal.addScrollerStyle=function(){if(!u){var e=document.getElementById("sf-styles");e||((e=document.createElement("style")).id="sf-styles",document.head.appendChild(e)),e.sheet.insertRule(".sf-virtual-list .virtual-spacer{visibility: hidden !important;position: relative !important;transform-origin: 0 0 !important;width: 0 !important;margin: 0 !important;padding: 0 !important;background: none !important;border: none !important;box-shadow: none !important;transition: none !important;}",e.sheet.cssRules.length),e.sheet.insertRule(".sf-scroll-element {backface-visibility: hidden;}",e.sheet.cssRules.length),u=!0}};var f=/auto|scroll|overlay|hidden/;internal.findScrollerElement=function(e){for(;null!==e&&!1===f.test(getComputedStyle(e).overflow);)if((e=e.parentElement)===document.body)return null;return e}},sf});
//# sourceMappingURL=scarletsframe.min.js.map
